<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta charset="utf-8" />
    <meta name="generator" content="quarto-1.5.56" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <meta name="author" content="Teng Kok Wai (Walter)" />
    <meta name="dcterms.date" content="2024-09-10" />
    <title>
      5A: Global Measures of Spatial Autocorrelation – Walter Teng’s Coursework
      for SMU ISSS626: Geospatial Analytics and Applications
    </title>
    <style>
      code {
        white-space: pre-wrap;
      }
      span.smallcaps {
        font-variant: small-caps;
      }
      div.columns {
        display: flex;
        gap: min(4vw, 1.5em);
      }
      div.column {
        flex: auto;
        overflow-x: auto;
      }
      div.hanging-indent {
        margin-left: 1.5em;
        text-indent: -1.5em;
      }
      ul.task-list {
        list-style: none;
      }
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */
        vertical-align: middle;
      }
      /* CSS for syntax highlighting */
      pre > code.sourceCode {
        white-space: pre;
        position: relative;
      }
      pre > code.sourceCode > span {
        line-height: 1.25;
      }
      pre > code.sourceCode > span:empty {
        height: 1.2em;
      }
      .sourceCode {
        overflow: visible;
      }
      code.sourceCode > span {
        color: inherit;
        text-decoration: inherit;
      }
      div.sourceCode {
        margin: 1em 0;
      }
      pre.sourceCode {
        margin: 0;
      }
      @media screen {
        div.sourceCode {
          overflow: auto;
        }
      }
      @media print {
        pre > code.sourceCode {
          white-space: pre-wrap;
        }
        pre > code.sourceCode > span {
          display: inline-block;
          text-indent: -5em;
          padding-left: 5em;
        }
      }
      pre.numberSource code {
        counter-reset: source-line 0;
      }
      pre.numberSource code > span {
        position: relative;
        left: -4em;
        counter-increment: source-line;
      }
      pre.numberSource code > span > a:first-child::before {
        content: counter(source-line);
        position: relative;
        left: -1em;
        text-align: right;
        vertical-align: baseline;
        border: none;
        display: inline-block;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        padding: 0 4px;
        width: 4em;
      }
      pre.numberSource {
        margin-left: 3em;
        padding-left: 4px;
      }
      div.sourceCode {
      }
      @media screen {
        pre > code.sourceCode > span > a:first-child::before {
          text-decoration: underline;
        }
      }
    </style>

    <script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
    <script src="../../site_libs/quarto-nav/headroom.min.js"></script>
    <script src="../../site_libs/clipboard/clipboard.min.js"></script>
    <script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
    <script src="../../site_libs/quarto-search/fuse.min.js"></script>
    <script src="../../site_libs/quarto-search/quarto-search.js"></script>
    <meta name="quarto:offset" content="../../" />
    <link href="../../favicon.ico" rel="icon" />
    <script src="../../site_libs/quarto-html/quarto.js"></script>
    <script src="../../site_libs/quarto-html/popper.min.js"></script>
    <script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
    <script src="../../site_libs/quarto-html/anchor.min.js"></script>
    <link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet" />
    <link
      href="../../site_libs/quarto-html/quarto-syntax-highlighting.css"
      rel="stylesheet"
      class="quarto-color-scheme"
      id="quarto-text-highlighting-styles"
    />
    <link
      href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css"
      rel="stylesheet"
      class="quarto-color-scheme quarto-color-alternate"
      id="quarto-text-highlighting-styles"
    />
    <script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
    <link
      href="../../site_libs/bootstrap/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link
      href="../../site_libs/bootstrap/bootstrap.min.css"
      rel="stylesheet"
      class="quarto-color-scheme"
      id="quarto-bootstrap"
      data-mode="light"
    />
    <link
      href="../../site_libs/bootstrap/bootstrap-dark.min.css"
      rel="stylesheet"
      class="quarto-color-scheme quarto-color-alternate"
      id="quarto-bootstrap"
      data-mode="dark"
    />
    <link
      href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css"
      rel="stylesheet"
    />
    <link
      href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css"
      rel="stylesheet"
    />
    <script id="quarto-search-options" type="application/json">
      {
        "location": "navbar",
        "copy-button": false,
        "collapse-after": 3,
        "panel-placement": "end",
        "type": "overlay",
        "limit": 50,
        "keyboard-shortcut": ["f", "/", "s"],
        "show-item-context": false,
        "language": {
          "search-no-results-text": "No results",
          "search-matching-documents-text": "matching documents",
          "search-copy-link-title": "Copy link to search",
          "search-hide-matches-text": "Hide additional matches",
          "search-more-match-text": "more match in this document",
          "search-more-matches-text": "more matches in this document",
          "search-clear-button-title": "Clear",
          "search-text-placeholder": "",
          "search-detached-cancel-button-title": "Cancel",
          "search-submit-button-title": "Submit",
          "search-label": "Search"
        }
      }
    </script>
    <script
      async=""
      src="https://www.googletagmanager.com/gtag/js?id=G-4MGB7PXBSL"
    ></script>
    <script type="text/javascript">
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "G-4MGB7PXBSL", { anonymize_ip: true });
    </script>
    <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
      type="text/javascript"
    ></script>
    <script type="text/javascript">
      const typesetMath = (el) => {
        if (window.MathJax) {
          // MathJax Typeset
          window.MathJax.typeset([el]);
        } else if (window.katex) {
          // KaTeX Render
          var mathElements = el.getElementsByClassName("math");
          var macros = [];
          for (var i = 0; i < mathElements.length; i++) {
            var texText = mathElements[i].firstChild;
            if (mathElements[i].tagName == "SPAN") {
              window.katex.render(texText.data, mathElements[i], {
                displayMode: mathElements[i].classList.contains("display"),
                throwOnError: false,
                macros: macros,
                fleqn: false,
              });
            }
          }
        }
      };
      window.Quarto = {
        typesetMath,
      };
    </script>
    <link rel="stylesheet" href="../../styles.css" />
    <meta
      property="og:title"
      content="5A: Global Measures of Spatial Autocorrelation – Walter Teng’s Coursework for SMU ISSS626: Geospatial Analytics and Applications"
    />
    <meta
      property="og:description"
      content="In this exercise, we will learn to compute Global Measures of Spatial Autocorrelation using the spdep package, including Moran’s I and Geary’s C tests, spatial correlograms, and their statistical interpretation."
    />
    <meta
      property="og:image"
      content="https://isss626-gaa.netlify.app/Hands-on_Ex/Hands-on_Ex05/og-img.png"
    />
    <meta
      property="og:site_name"
      content="Walter Teng's Coursework for SMU ISSS626: Geospatial Analytics and Applications"
    />
    <meta
      name="twitter:title"
      content="5A: Global Measures of Spatial Autocorrelation – Walter Teng’s Coursework for SMU ISSS626: Geospatial Analytics and Applications"
    />
    <meta
      name="twitter:description"
      content="In this exercise, we will learn to compute Global Measures of Spatial Autocorrelation using the spdep package, including Moran’s I and Geary’s C tests, spatial correlograms, and their statistical interpretation."
    />
    <meta
      name="twitter:image"
      content="https://isss626-gaa.netlify.app/Hands-on_Ex/Hands-on_Ex05/og-img.png"
    />
    <meta name="twitter:creator" content="@davzoku" />
    <meta name="twitter:site" content="@davzoku" />
    <meta name="twitter:card" content="summary_large_image" />
  </head>
  <body class="nav-fixed">
    <div id="quarto-search-results"></div>
    <header id="quarto-header" class="headroom fixed-top">
      <nav class="navbar navbar-expand-lg" data-bs-theme="dark">
        <div class="navbar-container container-fluid">
          <div class="navbar-brand-container mx-auto">
            <a class="navbar-brand" href="../../index.html">
              <span class="navbar-title"
                >ISSS626 Geospatial Analytics and Applications</span
              >
            </a>
          </div>
          <div id="quarto-search" class="" title="Search"></div>
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarCollapse"
            aria-controls="navbarCollapse"
            role="menu"
            aria-expanded="false"
            aria-label="Toggle navigation"
            onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
              <li class="nav-item dropdown">
                <a
                  class="nav-link dropdown-toggle"
                  href="#"
                  id="nav-menu-hands-on-exercises"
                  role="link"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                >
                  <span class="menu-text">Hands-on Exercises</span>
                </a>
                <ul
                  class="dropdown-menu"
                  aria-labelledby="nav-menu-hands-on-exercises"
                >
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01a.html"
                    >
                      <span class="dropdown-text"
                        >1A: Geospatial Data Wrangling with R</span
                      ></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01b.html"
                    >
                      <span class="dropdown-text"
                        >1B: Choropleth Mapping with R</span
                      ></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02a.html"
                    >
                      <span class="dropdown-text"
                        >2A: 1st Order Spatial Point Patterns Analysis</span
                      ></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02b.html"
                    >
                      <span class="dropdown-text"
                        >2B: 2nd Order Spatial Point Patterns Analysis</span
                      ></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03a.html"
                    >
                      <span class="dropdown-text"
                        >3A: Network Constrained Spatial Point Patterns
                        Analysis</span
                      ></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04a.html"
                    >
                      <span class="dropdown-text"
                        >4A: Spatial Weights and Applications</span
                      ></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05a.html"
                    >
                      <span class="dropdown-text"
                        >5A: Global Measures of Spatial Autocorrelation</span
                      ></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05b.html"
                    >
                      <span class="dropdown-text"
                        >5B: Local Measures of Spatial Autocorrelation</span
                      ></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06a.html"
                    >
                      <span class="dropdown-text"
                        >6A: Geographical Segmentation with Spatially
                        Constrained Clustering Techniques</span
                      ></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07a.html"
                    >
                      <span class="dropdown-text"
                        >7A: Calibrating Hedonic Pricing Model for Private
                        Highrise Property with GWR Method</span
                      ></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08a.html"
                    >
                      <span class="dropdown-text"
                        >8A: Geographically Weighted Predictive Models</span
                      ></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09a.html"
                    >
                      <span class="dropdown-text"
                        >9A: Modelling Geographical Accessibility</span
                      ></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10a.html"
                    >
                      <span class="dropdown-text"
                        >10A: Processing and Visualising Flow Data</span
                      ></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10b.html"
                    >
                      <span class="dropdown-text"
                        >10B: Calibrating Spatial Interaction Models with
                        R</span
                      ></a
                    >
                  </li>
                </ul>
              </li>
              <li class="nav-item dropdown">
                <a
                  class="nav-link dropdown-toggle"
                  href="#"
                  id="nav-menu-in-class-exercises"
                  role="link"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                >
                  <span class="menu-text">In-class Exercises</span>
                </a>
                <ul
                  class="dropdown-menu"
                  aria-labelledby="nav-menu-in-class-exercises"
                >
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html"
                    >
                      <span class="dropdown-text">In-class Exercise 01</span></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html"
                    >
                      <span class="dropdown-text">In-class Exercise 02</span></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html"
                    >
                      <span class="dropdown-text">In-class Exercise 03</span></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html"
                    >
                      <span class="dropdown-text">In-class Exercise 04</span></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html"
                    >
                      <span class="dropdown-text">In-class Exercise 05</span></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html"
                    >
                      <span class="dropdown-text">In-class Exercise 06</span></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../In-class_Ex/In-class_Ex07/In-class_Ex07.html"
                    >
                      <span class="dropdown-text">In-class Exercise 07</span></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../In-class_Ex/In-class_Ex08/In-class_Ex08.html"
                    >
                      <span class="dropdown-text">In-class Exercise 08</span></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../In-class_Ex/In-class_Ex09/In-class_Ex09.html"
                    >
                      <span class="dropdown-text">In-class Exercise 09</span></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../In-class_Ex/In-class_Ex10/In-class_Ex10.html"
                    >
                      <span class="dropdown-text">In-class Exercise 10</span></a
                    >
                  </li>
                </ul>
              </li>
              <li class="nav-item dropdown">
                <a
                  class="nav-link dropdown-toggle"
                  href="#"
                  id="nav-menu-take-home-exercises"
                  role="link"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                >
                  <span class="menu-text">Take-home Exercises</span>
                </a>
                <ul
                  class="dropdown-menu"
                  aria-labelledby="nav-menu-take-home-exercises"
                >
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html"
                    >
                      <span class="dropdown-text"
                        >Take-home Exercise 01</span
                      ></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html"
                    >
                      <span class="dropdown-text"
                        >Take-home Exercise 02</span
                      ></a
                    >
                  </li>
                  <li>
                    <a
                      class="dropdown-item"
                      href="../../Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html"
                    >
                      <span class="dropdown-text"
                        >Take-home Exercise 03</span
                      ></a
                    >
                  </li>
                </ul>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="../../Exploration/index.html">
                  <span class="menu-text">Exploration</span></a
                >
              </li>
            </ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
              <li class="nav-item">
                <a class="nav-link" href="../../index.html">
                  <span class="menu-text"
                    ><i
                      class="fa-solid fa-house fa-md"
                      aria-label="house"
                    ></i></span
                ></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="https://www.walterteng.com">
                  <span class="menu-text"
                    ><i
                      class="fa-solid fa-user fa-md"
                      aria-label="user"
                    ></i></span
                ></a>
              </li>
              <li class="nav-item compact">
                <a
                  class="nav-link"
                  href="https://www.linkedin.com/in/tengkokwai/"
                >
                  <i class="bi bi-linkedin" role="img"> </i>
                  <span class="menu-text"></span
                ></a>
              </li>
              <li class="nav-item compact">
                <a
                  class="nav-link"
                  href="https://github.com/davzoku/isss626-gaa"
                >
                  <i class="bi bi-github" role="img"> </i>
                  <span class="menu-text"></span
                ></a>
              </li>
            </ul>
          </div>
          <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
            <a
              href=""
              class="quarto-color-scheme-toggle quarto-navigation-tool px-1"
              onclick="window.quartoToggleColorScheme(); return false;"
              title="Toggle dark mode"
              ><i class="bi"></i
            ></a>
          </div>
        </div>
        <!-- /container-fluid -->
      </nav>
    </header>
    <!-- content -->
    <div
      id="quarto-content"
      class="quarto-container page-columns page-rows-contents page-layout-article page-navbar"
    >
      <!-- sidebar -->
      <!-- margin-sidebar -->
      <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
          <h2 id="toc-title">On this page</h2>

          <ul>
            <li>
              <a
                href="#exercise-5a-reference"
                id="toc-exercise-5a-reference"
                class="nav-link active"
                data-scroll-target="#exercise-5a-reference"
                ><span class="header-section-number">1</span> Exercise 5A
                Reference</a
              >
            </li>
            <li>
              <a
                href="#overview"
                id="toc-overview"
                class="nav-link"
                data-scroll-target="#overview"
                ><span class="header-section-number">2</span> Overview</a
              >
            </li>
            <li>
              <a
                href="#learning-outcome"
                id="toc-learning-outcome"
                class="nav-link"
                data-scroll-target="#learning-outcome"
                ><span class="header-section-number">3</span> Learning
                Outcome</a
              >
            </li>
            <li>
              <a
                href="#the-analytical-question"
                id="toc-the-analytical-question"
                class="nav-link"
                data-scroll-target="#the-analytical-question"
                ><span class="header-section-number">4</span> The Analytical
                Question</a
              >
            </li>
            <li>
              <a
                href="#the-data"
                id="toc-the-data"
                class="nav-link"
                data-scroll-target="#the-data"
                ><span class="header-section-number">5</span> The Data</a
              >
            </li>
            <li>
              <a
                href="#installing-and-launching-the-r-packages"
                id="toc-installing-and-launching-the-r-packages"
                class="nav-link"
                data-scroll-target="#installing-and-launching-the-r-packages"
                ><span class="header-section-number">6</span> Installing and
                Launching the R Packages</a
              >
            </li>
            <li>
              <a
                href="#import-data-and-preparation"
                id="toc-import-data-and-preparation"
                class="nav-link"
                data-scroll-target="#import-data-and-preparation"
                ><span class="header-section-number">7</span> Import Data and
                Preparation</a
              >
              <ul class="collapse">
                <li>
                  <a
                    href="#import-geospatial-shapefile"
                    id="toc-import-geospatial-shapefile"
                    class="nav-link"
                    data-scroll-target="#import-geospatial-shapefile"
                    ><span class="header-section-number">7.1</span> Import
                    Geospatial Shapefile</a
                  >
                </li>
                <li>
                  <a
                    href="#import-aspatial-csv-file"
                    id="toc-import-aspatial-csv-file"
                    class="nav-link"
                    data-scroll-target="#import-aspatial-csv-file"
                    ><span class="header-section-number">7.2</span> Import
                    Aspatial csv File</a
                  >
                </li>
                <li>
                  <a
                    href="#perform-relational-join"
                    id="toc-perform-relational-join"
                    class="nav-link"
                    data-scroll-target="#perform-relational-join"
                    ><span class="header-section-number">7.3</span> Perform
                    Relational Join</a
                  >
                </li>
                <li>
                  <a
                    href="#visualizing-regional-development-indicator"
                    id="toc-visualizing-regional-development-indicator"
                    class="nav-link"
                    data-scroll-target="#visualizing-regional-development-indicator"
                    ><span class="header-section-number">7.4</span> Visualizing
                    Regional Development Indicator</a
                  >
                </li>
              </ul>
            </li>
            <li>
              <a
                href="#global-measures-of-spatial-autocorrelation"
                id="toc-global-measures-of-spatial-autocorrelation"
                class="nav-link"
                data-scroll-target="#global-measures-of-spatial-autocorrelation"
                ><span class="header-section-number">8</span> Global Measures of
                Spatial Autocorrelation</a
              >
              <ul class="collapse">
                <li>
                  <a
                    href="#computing-contiguity-spatial-weights"
                    id="toc-computing-contiguity-spatial-weights"
                    class="nav-link"
                    data-scroll-target="#computing-contiguity-spatial-weights"
                    ><span class="header-section-number">8.1</span> Computing
                    Contiguity Spatial Weights</a
                  >
                </li>
                <li>
                  <a
                    href="#row-standardised-weights-matrix"
                    id="toc-row-standardised-weights-matrix"
                    class="nav-link"
                    data-scroll-target="#row-standardised-weights-matrix"
                    ><span class="header-section-number">8.2</span>
                    Row-standardised Weights Matrix</a
                  >
                </li>
              </ul>
            </li>
            <li>
              <a
                href="#global-measures-of-spatial-autocorrelation-morans-i"
                id="toc-global-measures-of-spatial-autocorrelation-morans-i"
                class="nav-link"
                data-scroll-target="#global-measures-of-spatial-autocorrelation-morans-i"
                ><span class="header-section-number">9</span> Global Measures of
                Spatial Autocorrelation: Moran’s I</a
              >
              <ul class="collapse">
                <li>
                  <a
                    href="#morans-i-test"
                    id="toc-morans-i-test"
                    class="nav-link"
                    data-scroll-target="#morans-i-test"
                    ><span class="header-section-number">9.1</span> Moran’s I
                    test</a
                  >
                </li>
                <li>
                  <a
                    href="#computing-monte-carlo-morans-i"
                    id="toc-computing-monte-carlo-morans-i"
                    class="nav-link"
                    data-scroll-target="#computing-monte-carlo-morans-i"
                    ><span class="header-section-number">9.2</span> Computing
                    Monte Carlo Moran’s I</a
                  >
                </li>
                <li>
                  <a
                    href="#visualising-monte-carlo-morans-i"
                    id="toc-visualising-monte-carlo-morans-i"
                    class="nav-link"
                    data-scroll-target="#visualising-monte-carlo-morans-i"
                    ><span class="header-section-number">9.3</span> Visualising
                    Monte Carlo Moran’s I</a
                  >
                </li>
              </ul>
            </li>
            <li>
              <a
                href="#global-measures-of-spatial-autocorrelation-gearys-c"
                id="toc-global-measures-of-spatial-autocorrelation-gearys-c"
                class="nav-link"
                data-scroll-target="#global-measures-of-spatial-autocorrelation-gearys-c"
                ><span class="header-section-number">10</span> Global Measures
                of Spatial Autocorrelation: Geary’s C</a
              >
              <ul class="collapse">
                <li>
                  <a
                    href="#gearys-c-test"
                    id="toc-gearys-c-test"
                    class="nav-link"
                    data-scroll-target="#gearys-c-test"
                    ><span class="header-section-number">10.1</span> Geary’s C
                    test</a
                  >
                </li>
                <li>
                  <a
                    href="#computing-monte-carlo-gearys-c"
                    id="toc-computing-monte-carlo-gearys-c"
                    class="nav-link"
                    data-scroll-target="#computing-monte-carlo-gearys-c"
                    ><span class="header-section-number">10.2</span> Computing
                    Monte Carlo Geary’s C</a
                  >
                </li>
                <li>
                  <a
                    href="#visualising-the-monte-carlo-gearys-c"
                    id="toc-visualising-the-monte-carlo-gearys-c"
                    class="nav-link"
                    data-scroll-target="#visualising-the-monte-carlo-gearys-c"
                    ><span class="header-section-number">10.3</span> Visualising
                    the Monte Carlo Geary’s C</a
                  >
                </li>
              </ul>
            </li>
            <li>
              <a
                href="#spatial-correlogram"
                id="toc-spatial-correlogram"
                class="nav-link"
                data-scroll-target="#spatial-correlogram"
                ><span class="header-section-number">11</span> Spatial
                Correlogram</a
              >
              <ul class="collapse">
                <li>
                  <a
                    href="#compute-morans-i-correlogram"
                    id="toc-compute-morans-i-correlogram"
                    class="nav-link"
                    data-scroll-target="#compute-morans-i-correlogram"
                    ><span class="header-section-number">11.1</span> Compute
                    Moran’s I Correlogram</a
                  >
                </li>
                <li>
                  <a
                    href="#compute-gearys-c-correlogram-and-plot"
                    id="toc-compute-gearys-c-correlogram-and-plot"
                    class="nav-link"
                    data-scroll-target="#compute-gearys-c-correlogram-and-plot"
                    ><span class="header-section-number">11.2</span> Compute
                    Geary’s C Correlogram and Plot</a
                  >
                </li>
              </ul>
            </li>
          </ul>
        </nav>
      </div>
      <!-- main -->
      <main class="content" id="quarto-document-content">
        <header id="title-block-header" class="quarto-title-block default">
          <div class="quarto-title">
            <h1 class="title">
              5A: Global Measures of Spatial Autocorrelation
            </h1>
            <p class="subtitle lead">
              In this exercise, we will learn to compute Global Measures of
              Spatial Autocorrelation using the <strong>spdep</strong> package,
              including Moran’s I and Geary’s C tests, spatial correlograms, and
              their statistical interpretation.
            </p>
          </div>

          <div class="quarto-title-meta">
            <div>
              <div class="quarto-title-meta-heading">Author</div>
              <div class="quarto-title-meta-contents">
                <p>Teng Kok Wai (Walter)</p>
              </div>
            </div>

            <div>
              <div class="quarto-title-meta-heading">Published</div>
              <div class="quarto-title-meta-contents">
                <p class="date">September 10, 2024</p>
              </div>
            </div>

            <div>
              <div class="quarto-title-meta-heading">Modified</div>
              <div class="quarto-title-meta-contents">
                <p class="date-modified">September 27, 2024</p>
              </div>
            </div>
          </div>
        </header>
        <section id="exercise-5a-reference" class="level2" data-number="1">
          <h2
            data-number="1"
            class="anchored"
            data-anchor-id="exercise-5a-reference"
          >
            <span class="header-section-number">1</span> Exercise 5A Reference
          </h2>
          <p>
            <a href="https://r4gdsa.netlify.app/chap09.html"
              >R for Geospatial Data Science and Analytics - 9&nbsp; Global
              Measures of Spatial Autocorrelation</a
            >
          </p>
        </section>
        <section id="overview" class="level2" data-number="2">
          <h2 data-number="2" class="anchored" data-anchor-id="overview">
            <span class="header-section-number">2</span> Overview
          </h2>
          <p>
            In this exercise, we will learn to compute Global Measures of
            Spatial Autocorrelation using the <strong>spdep</strong> package,
            including Moran’s I and Geary’s C tests, spatial correlograms, and
            their statistical interpretation.
          </p>
        </section>
        <section id="learning-outcome" class="level2" data-number="3">
          <h2
            data-number="3"
            class="anchored"
            data-anchor-id="learning-outcome"
          >
            <span class="header-section-number">3</span> Learning Outcome
          </h2>
          <ul>
            <li>
              Import geospatial data using the <strong>sf</strong> package
            </li>
            <li>Import CSV data using the <strong>readr</strong> package</li>
            <li>
              Perform relational joins using the <strong>dplyr</strong> package
            </li>
            <li>
              Compute Global Spatial Autocorrelation (GSA) statistics using the
              <strong>spdep</strong> package
              <ul>
                <li>Moran’s I test and Monte Carlo simulation</li>
                <li>Geary’s C test and Monte Carlo simulation</li>
              </ul>
            </li>
            <li>Plot Moran scatterplot and spatial correlograms</li>
            <li>Interpret GSA statistics correctly</li>
          </ul>
        </section>
        <section id="the-analytical-question" class="level2" data-number="4">
          <h2
            data-number="4"
            class="anchored"
            data-anchor-id="the-analytical-question"
          >
            <span class="header-section-number">4</span> The Analytical Question
          </h2>
          <p>
            In spatial policy planning, one of the main development objective of
            the local government and planners is to ensure equal distribution of
            development in the province. In this study, we will apply spatial
            statistical methods to examine the distribution of development in
            Hunan Province, China, using a selected indicator (e.g., GDP per
            capita).
          </p>
          <blockquote class="blockquote">
            <p>Our key questions are:</p>
            <ol type="1">
              <li>Is development evenly distributed geographically?</li>
              <li>If not, is there evidence of spatial clustering?</li>
              <li>If clustering exists, where are these clusters located?</li>
            </ol>
          </blockquote>
        </section>
        <section id="the-data" class="level2" data-number="5">
          <h2 data-number="5" class="anchored" data-anchor-id="the-data">
            <span class="header-section-number">5</span> The Data
          </h2>
          <p>The following 2 datasets will be used in this exercise.</p>
          <table class="caption-top table">
            <colgroup>
              <col style="width: 23%" />
              <col style="width: 54%" />
              <col style="width: 22%" />
            </colgroup>
            <thead>
              <tr class="header">
                <th><strong>Data Set</strong></th>
                <th><strong>Description</strong></th>
                <th><strong>Format</strong></th>
              </tr>
            </thead>
            <tbody>
              <tr class="odd">
                <td>Hunan county boundary layer</td>
                <td>
                  Geospatial data set representing the county boundaries of
                  Hunan
                </td>
                <td>ESRI Shapefile</td>
              </tr>
              <tr class="even">
                <td>Hunan_2012.csv</td>
                <td>
                  Contains selected local development indicators for Hunan in
                  2012
                </td>
                <td>CSV</td>
              </tr>
            </tbody>
          </table>
        </section>
        <section
          id="installing-and-launching-the-r-packages"
          class="level2"
          data-number="6"
        >
          <h2
            data-number="6"
            class="anchored"
            data-anchor-id="installing-and-launching-the-r-packages"
          >
            <span class="header-section-number">6</span> Installing and
            Launching the R Packages
          </h2>
          <p>The following R packages will be used in this exercise:</p>
          <table class="caption-top table">
            <colgroup>
              <col style="width: 19%" />
              <col style="width: 40%" />
              <col style="width: 40%" />
            </colgroup>
            <thead>
              <tr class="header">
                <th><strong>Package</strong></th>
                <th><strong>Purpose</strong></th>
                <th><strong>Use Case in Exercise</strong></th>
              </tr>
            </thead>
            <tbody>
              <tr class="odd">
                <td><strong>sf</strong></td>
                <td>
                  Imports, manages, and processes vector-based geospatial data.
                </td>
                <td>
                  Handling vector geospatial data such as the Hunan county
                  boundary layer in shapefile format.
                </td>
              </tr>
              <tr class="even">
                <td><strong>spdep</strong></td>
                <td>
                  Provides functions for spatial dependence analysis, including
                  spatial weights and spatial autocorrelation.
                </td>
                <td>
                  Computing spatial weights and creating spatially lagged
                  variables.
                </td>
              </tr>
              <tr class="odd">
                <td><strong>tmap</strong></td>
                <td>
                  Creates static and interactive thematic maps using
                  cartographic quality elements.
                </td>
                <td>
                  Visualizing regional development indicators and plotting maps
                  showing spatial relationships and patterns.
                </td>
              </tr>
              <tr class="even">
                <td><strong>tidyverse</strong></td>
                <td>
                  A collection of packages for data science tasks such as data
                  manipulation, visualization, and modeling.
                </td>
                <td>
                  Importing CSV files, wrangling data, and performing relational
                  joins.
                </td>
              </tr>
            </tbody>
          </table>
          <p>To install and load these packages, use the following code:</p>
          <div class="cell">
            <div class="sourceCode" id="cb1">
              <pre
                class="downlit sourceCode r code-with-copy"
              ><code class="sourceCode R"><span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">sf</span>, <span class="va">spdep</span>, <span class="va">tmap</span>, <span class="va">tidyverse</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
            </div>
          </div>
        </section>
        <section
          id="import-data-and-preparation"
          class="level2"
          data-number="7"
        >
          <h2
            data-number="7"
            class="anchored"
            data-anchor-id="import-data-and-preparation"
          >
            <span class="header-section-number">7</span> Import Data and
            Preparation
          </h2>
          <p>
            In this section, we will perform 3 necessary steps to prepare the
            data for analysis.
          </p>
          <div
            class="callout callout-style-default callout-note callout-titled"
          >
            <div class="callout-header d-flex align-content-center">
              <div class="callout-icon-container">
                <i class="callout-icon"></i>
              </div>
              <div class="callout-title-container flex-fill">Note</div>
            </div>
            <div class="callout-body-container callout-body">
              <p>
                The data preparation is the same as previous exercise such as
                <a href="../../hands-on_ex/hands-on_ex04/hands-on_ex04a"
                  >Exercise 4A</a
                >.
              </p>
            </div>
          </div>
          <section
            id="import-geospatial-shapefile"
            class="level3"
            data-number="7.1"
          >
            <h3
              data-number="7.1"
              class="anchored"
              data-anchor-id="import-geospatial-shapefile"
            >
              <span class="header-section-number">7.1</span> Import Geospatial
              Shapefile
            </h3>
            <p>
              Firstly, we will use
              <a href="https://r-spatial.github.io/sf/reference/st_read.html"
                ><code>st_read()</code></a
              >
              of <strong>sf</strong> package to import Hunan shapefile into R.
              The imported shapefile will be
              <strong>simple features</strong> Object of <strong>sf</strong>.
            </p>
            <div class="cell">
              <div class="sourceCode" id="cb2">
                <pre
                  class="downlit sourceCode r code-with-copy"
                ><code class="sourceCode R"><span><span class="va">hunan</span> <span class="op">&lt;-</span> <span class="fu">st_read</span><span class="op">(</span>dsn <span class="op">=</span> <span class="st">"data/geospatial"</span>, </span>
<span>                 layer <span class="op">=</span> <span class="st">"Hunan"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
              </div>
              <div class="cell-output cell-output-stdout">
                <pre><code>Reading layer `Hunan' from data source
  `/Users/walter/code/isss626/isss626-gaa/Hands-on_Ex/Hands-on_Ex05/data/geospatial'
  using driver `ESRI Shapefile'
Simple feature collection with 88 features and 7 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812
Geodetic CRS:  WGS 84</code></pre>
              </div>
            </div>
          </section>
          <section
            id="import-aspatial-csv-file"
            class="level3"
            data-number="7.2"
          >
            <h3
              data-number="7.2"
              class="anchored"
              data-anchor-id="import-aspatial-csv-file"
            >
              <span class="header-section-number">7.2</span> Import Aspatial csv
              File
            </h3>
            <p>
              Next, we will import <em>Hunan_2012.csv</em> into R by using
              <code>read_csv()</code> of <strong>readr</strong> package. The
              output is R dataframe class.
            </p>
            <div class="cell">
              <div class="sourceCode" id="cb4">
                <pre
                  class="downlit sourceCode r code-with-copy"
                ><code class="sourceCode R"><span><span class="va">hunan2012</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/aspatial/Hunan_2012.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
              </div>
            </div>
          </section>
          <section
            id="perform-relational-join"
            class="level3"
            data-number="7.3"
          >
            <h3
              data-number="7.3"
              class="anchored"
              data-anchor-id="perform-relational-join"
            >
              <span class="header-section-number">7.3</span> Perform Relational
              Join
            </h3>
            <p>
              Then, we will perform a <code>left_join()</code> to update the
              attribute table of hunan’s SpatialPolygonsDataFrame with the
              attribute fields of hunan2012 dataframe.
            </p>
            <div class="cell">
              <div class="sourceCode" id="cb5">
                <pre
                  class="downlit sourceCode r code-with-copy"
                ><code class="sourceCode R"><span><span class="va">hunan</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">hunan</span>,<span class="va">hunan2012</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">7</span>, <span class="fl">15</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
              </div>
            </div>
          </section>
          <section
            id="visualizing-regional-development-indicator"
            class="level3"
            data-number="7.4"
          >
            <h3
              data-number="7.4"
              class="anchored"
              data-anchor-id="visualizing-regional-development-indicator"
            >
              <span class="header-section-number">7.4</span> Visualizing
              Regional Development Indicator
            </h3>
            <p>
              To visualize the regional development indicator, we can prepare a
              base map and a choropleth map to show the distribution of GDPPC
              2012 (GDP per capita) by using <code>qtm()</code> of
              <strong>tmap</strong> package.
            </p>
            <div class="cell">
              <div class="sourceCode" id="cb6">
                <pre
                  class="downlit sourceCode r code-with-copy"
                ><code class="sourceCode R"><span><span class="va">equal</span> <span class="op">&lt;-</span> <span class="fu">tm_shape</span><span class="op">(</span><span class="va">hunan</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_fill</span><span class="op">(</span><span class="st">"GDPPC"</span>,</span>
<span>          n <span class="op">=</span> <span class="fl">5</span>,</span>
<span>          style <span class="op">=</span> <span class="st">"equal"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_borders</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_layout</span><span class="op">(</span>main.title <span class="op">=</span> <span class="st">"Equal Interval Classification"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">quantile</span> <span class="op">&lt;-</span> <span class="fu">tm_shape</span><span class="op">(</span><span class="va">hunan</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_fill</span><span class="op">(</span><span class="st">"GDPPC"</span>,</span>
<span>          n <span class="op">=</span> <span class="fl">5</span>,</span>
<span>          style <span class="op">=</span> <span class="st">"quantile"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_borders</span><span class="op">(</span>col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_layout</span><span class="op">(</span>main.title <span class="op">=</span> <span class="st">"Equal Quantile Classification"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tmap_arrange</span><span class="op">(</span><span class="va">equal</span>, </span>
<span>             <span class="va">quantile</span>, </span>
<span>             asp<span class="op">=</span><span class="fl">1</span>, </span>
<span>             ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
              </div>
              <div class="cell-output-display">
                <div>
                  <figure class="figure">
                    <p>
                      <img
                        src="Hands-on_Ex05a_files/figure-html/unnamed-chunk-5-1.png"
                        class="img-fluid figure-img"
                        width="1536"
                      />
                    </p>
                  </figure>
                </div>
              </div>
            </div>
            <div
              class="callout callout-style-default callout-note callout-titled"
            >
              <div class="callout-header d-flex align-content-center">
                <div class="callout-icon-container">
                  <i class="callout-icon"></i>
                </div>
                <div class="callout-title-container flex-fill">Note</div>
              </div>
              <div class="callout-body-container callout-body">
                <p><strong>Observations</strong></p>
                <p>
                  On the left plot, we perform
                  <strong>equal interval classification</strong> which divides
                  the range of GDPPC into five equal-sized intervals. This
                  method ensures that the difference between the maximum and
                  minimum value within each class is the same.
                </p>
                <p>
                  <strong
                    >The equal interval classification method is best used for
                    continuous datasets such as precipitation or
                    temperature.</strong
                  >
                </p>
                <p>
                  The advantage of the equal interval classification method is
                  that it creates a legend that is easy to interpret and present
                  to a nontechnical audience. The primary disadvantage is that
                  certain datasets will end up with most of the data values
                  falling into only one or two classes, while few to no values
                  will occupy the other classes.
                </p>
                <hr />
                <p>
                  On the right plot, we perform
                  <strong>equal quantile classification</strong> which divides
                  the regions into five classes such that each class contains
                  approximately the same number of regions. This method adjusts
                  the intervals to ensure an equal number of regions per class,
                  which might result in unequal interval sizes.
                </p>
                <p>
                  <strong
                    >The equal quantile classification is best for data that is
                    evenly distributed across its range.</strong
                  >
                </p>
                <p>
                  As there are 88 counties in Hunan, each class in the quantile
                  classification methodology will contain 88 / 5 = 17.6
                  different counties. The advantage to this method is that it
                  often excels at emphasizing the relative position of the data
                  values (i.e., which counties contain the top 20 percent of the
                  Hunan population). The primary disadvantage of the quantile
                  classification methodology is that features placed within the
                  same class can have wildly differing values, particularly if
                  the data are not evenly distributed across its range. In
                  addition, the opposite can also happen whereby values with
                  small range differences can be placed into different classes,
                  suggesting a wider difference in the dataset than actually
                  exists.
                </p>
                <p>
                  For more info, see
                  <a
                    href="https://saylordotorg.github.io/text_essentials-of-geographic-information-systems/s10-03-data-classification.html#:~:text=The%20equal%20interval,such%20as%20precipitation%20or%20temperature."
                    >Data Classification</a
                  >
                </p>
              </div>
            </div>
          </section>
        </section>
        <section
          id="global-measures-of-spatial-autocorrelation"
          class="level2"
          data-number="8"
        >
          <h2
            data-number="8"
            class="anchored"
            data-anchor-id="global-measures-of-spatial-autocorrelation"
          >
            <span class="header-section-number">8</span> Global Measures of
            Spatial Autocorrelation
          </h2>
          <p>
            In this section, we will compute global spatial autocorrelation
            statistics and to perform spatial complete randomness test for
            global spatial autocorrelation.
          </p>
          <section
            id="computing-contiguity-spatial-weights"
            class="level3"
            data-number="8.1"
          >
            <h3
              data-number="8.1"
              class="anchored"
              data-anchor-id="computing-contiguity-spatial-weights"
            >
              <span class="header-section-number">8.1</span> Computing
              Contiguity Spatial Weights
            </h3>
            <p>
              Before we can compute the global spatial autocorrelation
              statistics, we need to construct a spatial weights of the study
              area. The spatial weights is used to define the neighbourhood
              relationships between the geographical units (i.e.&nbsp;county) in
              the study area.
            </p>
            <p>
              In the code block below, the <code>poly2nb()</code> function from
              the <strong>spdep</strong> package calculates contiguity weight
              matrices for the study area by identifying regions that share
              boundaries.
            </p>
            <p>
              By default, <code>poly2nb()</code> uses the “Queen” criteria,
              which considers any shared boundary or corner as a neighbor
              (equivalent to setting <code>queen = TRUE</code>). If we want to
              restrict the criteria to shared boundaries only (excluding
              corners), set <code>queen = FALSE</code>.
            </p>
            <div class="cell">
              <div class="sourceCode" id="cb7">
                <pre
                  class="downlit sourceCode r code-with-copy"
                ><code class="sourceCode R"><span><span class="va">wm_q</span> <span class="op">&lt;-</span> <span class="fu">poly2nb</span><span class="op">(</span><span class="va">hunan</span>, </span>
<span>                queen<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">wm_q</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
              </div>
              <div class="cell-output cell-output-stdout">
                <pre><code>Neighbour list object:
Number of regions: 88
Number of nonzero links: 448
Percentage nonzero weights: 5.785124
Average number of links: 5.090909
Link number distribution:

 1  2  3  4  5  6  7  8  9 11
 2  2 12 16 24 14 11  4  2  1
2 least connected regions:
30 65 with 1 link
1 most connected region:
85 with 11 links</code></pre>
              </div>
            </div>
            <p>
              The summary report above shows that there are 88 area units in
              Hunan. The most connected area unit has 11 neighbours. There are
              two area units with only one neighbours.
            </p>
          </section>
          <section
            id="row-standardised-weights-matrix"
            class="level3"
            data-number="8.2"
          >
            <h3
              data-number="8.2"
              class="anchored"
              data-anchor-id="row-standardised-weights-matrix"
            >
              <span class="header-section-number">8.2</span> Row-standardised
              Weights Matrix
            </h3>
            <p>
              Next, we need to assign weights to each neighboring polygon. In
              this case, we’ll use equal weights (style=“W”), where each
              neighboring polygon gets a weight of
              <strong>1/(number of neighbors)</strong>. This means we take the
              value for each neighbor and divide it by the total number of
              neighbors, then sum these weighted values to calculate a summary
              measure, such as weighted income.
            </p>
            <p>
              While this equal weighting approach is straightforward and easy to
              understand, it has a limitation:
              <strong
                >polygons on the edges of the study area have fewer neighbors,
                which can lead to over- or underestimation of the actual spatial
                relationships (spatial autocorrelation) in the data.</strong
              >
            </p>
            <div
              class="callout callout-style-default callout-tip callout-titled"
            >
              <div class="callout-header d-flex align-content-center">
                <div class="callout-icon-container">
                  <i class="callout-icon"></i>
                </div>
                <div class="callout-title-container flex-fill">Tip</div>
              </div>
              <div class="callout-body-container callout-body">
                <p>
                  For simplicity, we use the style=“W” option in this example,
                  but keep in mind that other, potentially more accurate methods
                  are available, such as style=“B”.
                </p>
              </div>
            </div>
            <div class="cell">
              <div class="sourceCode" id="cb9">
                <pre
                  class="downlit sourceCode r code-with-copy"
                ><code class="sourceCode R"><span><span class="va">rswm_q</span> <span class="op">&lt;-</span> <span class="fu">nb2listw</span><span class="op">(</span><span class="va">wm_q</span>, style<span class="op">=</span><span class="st">"W"</span>, zero.policy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">rswm_q</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
              </div>
              <div class="cell-output cell-output-stdout">
                <pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 88
Number of nonzero links: 448
Percentage nonzero weights: 5.785124
Average number of links: 5.090909

Weights style: W
Weights constants summary:
   n   nn S0       S1       S2
W 88 7744 88 37.86334 365.9147</code></pre>
              </div>
            </div>
            <div
              class="callout callout-style-default callout-tip callout-titled"
            >
              <div class="callout-header d-flex align-content-center">
                <div class="callout-icon-container">
                  <i class="callout-icon"></i>
                </div>
                <div class="callout-title-container flex-fill">Tip</div>
              </div>
              <div class="callout-body-container callout-body">
                <ul>
                  <li>
                    <p>
                      The input of
                      <a
                        href="https://r-spatial.github.io/spdep/reference/nb2listw.html"
                        ><code>nb2listw()</code></a
                      >
                      must be an object of class <strong>nb</strong>. The syntax
                      of the function has two major arguments, namely style and
                      zero.poly.
                    </p>
                  </li>
                  <li>
                    <p>
                      <em>style</em> can take values “W”, “B”, “C”, “U”,
                      “minmax” and “S”. B is the basic binary coding, W is row
                      standardised (sums over all links to n), C is globally
                      standardised (sums over all links to n), U is equal to C
                      divided by the number of neighbours (sums over all links
                      to unity), while S is the variance-stabilizing coding
                      scheme proposed by Tiefelsdorf et al.&nbsp;1999,
                      p.&nbsp;167-168 (sums over all links to n).
                    </p>
                  </li>
                  <li>
                    <p>
                      The zero.policy=TRUE option allows for lists of
                      non-neighbors. This should be used with caution since the
                      user may not be aware of missing neighbors in their
                      dataset however, a zero.policy of FALSE would return an
                      error.
                    </p>
                  </li>
                </ul>
              </div>
            </div>
          </section>
        </section>
        <section
          id="global-measures-of-spatial-autocorrelation-morans-i"
          class="level2"
          data-number="9"
        >
          <h2
            data-number="9"
            class="anchored"
            data-anchor-id="global-measures-of-spatial-autocorrelation-morans-i"
          >
            <span class="header-section-number">9</span> Global Measures of
            Spatial Autocorrelation: Moran’s I
          </h2>
          <p>
            In this section, you will learn how to perform Moran’s I statistics
            testing by using
            <a
              href="https://r-spatial.github.io/spdep/reference/moran.test.html"
              ><code>moran.test()</code></a
            >
            of <strong>spdep</strong>.
          </p>
          <div
            class="callout callout-style-default callout-note callout-titled"
          >
            <div class="callout-header d-flex align-content-center">
              <div class="callout-icon-container">
                <i class="callout-icon"></i>
              </div>
              <div class="callout-title-container flex-fill">Note</div>
            </div>
            <div class="callout-body-container callout-body">
              <p>
                Spatial Autocorrelation, specifically Global Moran’s I, is a
                statistical measure used to evaluate the degree to which similar
                values in a dataset are clustered together or dispersed across a
                geographic space.
              </p>
              <p>
                In simpler terms, it measures whether similar values occur near
                each other (positive autocorrelation) or if dissimilar values
                are found near each other (negative autocorrelation).
              </p>
              <p>
                Global Moran’s I takes into account both the locations of
                features and the values associated with those features. It
                computes an index value (Moran’s I), a z-score, and a p-value to
                determine the statistical significance of the observed spatial
                pattern
              </p>
              <p><strong>Intepreting Moran’s I index</strong></p>
              <p>
                The Moran’s I index ranges from -1 to +1. A value close to +1
                indicates clustering of similar values, a value close to -1
                indicates dispersion of similar values, and a value near 0
                suggests a random spatial pattern2.
              </p>
              <ul>
                <li>
                  <strong>Positive Moran’s I</strong>: Indicates that high
                  values are near other high values, and low values are near
                  other low values.
                </li>
                <li>
                  <strong>Negative Moran’s I</strong>: Indicates that high
                  values are near low values and vice versa.
                </li>
                <li>
                  <strong>Zero Moran’s I</strong>: Suggests no spatial
                  autocorrelation, implying a random distribution.
                </li>
              </ul>
              <p>
                For more info, see
                <a
                  href="https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-statistics/h-how-spatial-autocorrelation-moran-s-i-spatial-st.htm"
                  >How Spatial Autocorrelation (Global Moran’s I) works—ArcGIS
                  Pro | Documentation</a
                >
              </p>
            </div>
          </div>
          <section id="morans-i-test" class="level3" data-number="9.1">
            <h3
              data-number="9.1"
              class="anchored"
              data-anchor-id="morans-i-test"
            >
              <span class="header-section-number">9.1</span> Moran’s I test
            </h3>
            <p>
              To assess whether there is significant spatial autocorrelation in
              the GDP per capita (GDPPC) across regions, we use
              <strong>Moran’s I test</strong>. The test is performed using the
              <a
                href="https://r-spatial.github.io/spdep/reference/moran.test.html"
                ><code>moran.test()</code></a
              >
              function from the <strong>spdep</strong> package.
            </p>
            <ul>
              <li>
                <strong>Null Hypothesis (</strong
                ><span class="math inline">\(H_0\)</span>): There is no spatial
                autocorrelation in GDP per capita across the regions (Moran’s I
                = 0).
              </li>
              <li>
                <strong>Alternative Hypothesis (</strong
                ><span class="math inline">\(H_1\)</span>): There is positive
                spatial autocorrelation in GDP per capita (Moran’s I &gt; 0).
              </li>
            </ul>
            <p>
              We will use an
              <strong>alpha value (α) of 0.05 (95% confidence level)</strong> to
              determine the statistical significance.
            </p>
            <div class="cell">
              <div class="sourceCode" id="cb11">
                <pre
                  class="downlit sourceCode r code-with-copy"
                ><code class="sourceCode R"><span><span class="fu">moran.test</span><span class="op">(</span><span class="va">hunan</span><span class="op">$</span><span class="va">GDPPC</span>, </span>
<span>           listw<span class="op">=</span><span class="va">rswm_q</span>, </span>
<span>           zero.policy <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>           na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
              </div>
              <div class="cell-output cell-output-stdout">
                <pre><code>
    Moran I test under randomisation

data:  hunan$GDPPC
weights: rswm_q

Moran I statistic standard deviate = 4.7351, p-value = 1.095e-06
alternative hypothesis: greater
sample estimates:
Moran I statistic       Expectation          Variance
      0.300749970      -0.011494253       0.004348351 </code></pre>
              </div>
            </div>
            <div
              class="callout callout-style-default callout-note callout-titled"
            >
              <div class="callout-header d-flex align-content-center">
                <div class="callout-icon-container">
                  <i class="callout-icon"></i>
                </div>
                <div class="callout-title-container flex-fill">Note</div>
              </div>
              <div class="callout-body-container callout-body">
                <p>
                  <strong
                    >Question: What statistical conclusion can you draw from the
                    output above?</strong
                  >
                </p>
                <ul>
                  <li>
                    <p>
                      The value of Moran’s I is 0.3007, a positive number,
                      indicating positive spatial autocorrelation. This means
                      that regions with similar GDP per capita (GDPPC) values
                      tend to be geographically close to each other.
                    </p>
                  </li>
                  <li>
                    <p>
                      The p-value is 1.095e-06, which is much smaller than our
                      alpha value of 0.05. This provides strong evidence against
                      the null hypothesis of no spatial autocorrelation.
                    </p>
                  </li>
                </ul>
                <p>
                  Therefore, We will
                  <strong
                    >reject the null hypothesis at 95% confidence
                    interval</strong
                  >
                  because the p-value is smaller than our chosen alpha value.
                </p>
              </div>
            </div>
          </section>
          <section
            id="computing-monte-carlo-morans-i"
            class="level3"
            data-number="9.2"
          >
            <h3
              data-number="9.2"
              class="anchored"
              data-anchor-id="computing-monte-carlo-morans-i"
            >
              <span class="header-section-number">9.2</span> Computing Monte
              Carlo Moran’s I
            </h3>
            <p>
              In this example, we explore the spatial distribution of Hunan
              GDPPC by county for the state of Hunan using the Monte Carlo
              approach. A total of 1000 simulation will be performed. We will
              perform the same hypothesis testing described above.
            </p>
            <div class="cell">
              <div class="sourceCode" id="cb13">
                <pre
                  class="downlit sourceCode r code-with-copy"
                ><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bperm</span><span class="op">=</span> <span class="fu">moran.mc</span><span class="op">(</span><span class="va">hunan</span><span class="op">$</span><span class="va">GDPPC</span>, </span>
<span>                listw<span class="op">=</span><span class="va">rswm_q</span>, </span>
<span>                nsim<span class="op">=</span><span class="fl">999</span>, </span>
<span>                zero.policy <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span></span>
<span><span class="va">bperm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
              </div>
              <div class="cell-output cell-output-stdout">
                <pre><code>
    Monte-Carlo simulation of Moran I

data:  hunan$GDPPC
weights: rswm_q
number of simulations + 1: 1000

statistic = 0.30075, observed rank = 1000, p-value = 0.001
alternative hypothesis: greater</code></pre>
              </div>
            </div>
            <div
              class="callout callout-style-default callout-note callout-titled"
            >
              <div class="callout-header d-flex align-content-center">
                <div class="callout-icon-container">
                  <i class="callout-icon"></i>
                </div>
                <div class="callout-title-container flex-fill">Note</div>
              </div>
              <div class="callout-body-container callout-body">
                <p>
                  <strong
                    >Question: What statistical conclusion can you draw from the
                    output above?</strong
                  >
                </p>
                <ul>
                  <li>
                    <p>
                      The value of Moran’s I is 0.30075, which is a positive
                      number, indicating positive spatial autocorrelation. This
                      suggests that regions with similar GDP per capita (GDPPC)
                      values are geographically close to each other.
                    </p>
                  </li>
                  <li>
                    <p>
                      The p-value obtained from the Monte Carlo simulation is
                      0.001, which is much smaller than our alpha value of 0.05.
                      This provides strong evidence against the null hypothesis
                      of no spatial autocorrelation.
                    </p>
                  </li>
                </ul>
                <p>
                  Therefore, we will
                  <strong
                    >reject the null hypothesis at 95% confidence
                    interval</strong
                  >
                  because the p-value is smaller than our chosen alpha value.
                </p>
              </div>
            </div>
          </section>
          <section
            id="visualising-monte-carlo-morans-i"
            class="level3"
            data-number="9.3"
          >
            <h3
              data-number="9.3"
              class="anchored"
              data-anchor-id="visualising-monte-carlo-morans-i"
            >
              <span class="header-section-number">9.3</span> Visualising Monte
              Carlo Moran’s I
            </h3>
            <p>
              It is always a good practice for us the examine the simulated
              Moran’s I test statistics in greater detail. This can be achieved
              by plotting the distribution of the statistical values as a
              histogram by using the code block below.
            </p>
            <p>
              We will first observe the summary report of the Monte Carlo
              Moran’s I output before visualizing the plots using
              <code>ggplot2</code> and base R.
            </p>
            <div class="cell">
              <div class="sourceCode" id="cb15">
                <pre
                  class="downlit sourceCode r code-with-copy"
                ><code class="sourceCode R"><span><span class="co"># Calculate the mean of the first 999 simulated Moran's I values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bperm</span><span class="op">$</span><span class="va">res</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">999</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
              </div>
              <div class="cell-output cell-output-stdout">
                <pre><code>[1] -0.01504572</code></pre>
              </div>
              <div class="sourceCode" id="cb17">
                <pre
                  class="downlit sourceCode r code-with-copy"
                ><code class="sourceCode R"><span><span class="co"># Calculate the variance of the first 999 simulated Moran's I values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">bperm</span><span class="op">$</span><span class="va">res</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">999</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
              </div>
              <div class="cell-output cell-output-stdout">
                <pre><code>[1] 0.004371574</code></pre>
              </div>
              <div class="sourceCode" id="cb19">
                <pre
                  class="downlit sourceCode r code-with-copy"
                ><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bperm</span><span class="op">$</span><span class="va">res</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">999</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
              </div>
              <div class="cell-output cell-output-stdout">
                <pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max.
-0.18339 -0.06168 -0.02125 -0.01505  0.02611  0.27593 </code></pre>
              </div>
            </div>
            <div class="tabset-margin-container"></div>
            <div class="panel-tabset">
              <ul class="nav nav-tabs" role="tablist">
                <li class="nav-item" role="presentation">
                  <a
                    class="nav-link active"
                    id="tabset-1-1-tab"
                    data-bs-toggle="tab"
                    data-bs-target="#tabset-1-1"
                    role="tab"
                    aria-controls="tabset-1-1"
                    aria-selected="true"
                    >ggplot2</a
                  >
                </li>
                <li class="nav-item" role="presentation">
                  <a
                    class="nav-link"
                    id="tabset-1-2-tab"
                    data-bs-toggle="tab"
                    data-bs-target="#tabset-1-2"
                    role="tab"
                    aria-controls="tabset-1-2"
                    aria-selected="false"
                    >base R</a
                  >
                </li>
              </ul>
              <div class="tab-content">
                <div
                  id="tabset-1-1"
                  class="tab-pane active"
                  role="tabpanel"
                  aria-labelledby="tabset-1-1-tab"
                >
                  <div class="cell">
                    <div class="sourceCode" id="cb21">
                      <pre
                        class="downlit sourceCode r code-with-copy"
                      ><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bperm</span><span class="op">$</span><span class="va">res</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">bperm</span><span class="op">$</span><span class="va">res</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">20</span>,</span>
<span>                 fill <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>                 color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"red"</span>, </span>
<span>             linetype <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Simulated Moran's I"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Frequency"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Histogram of Simulated Moran's I Values"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
                    </div>
                    <div class="cell-output-display">
                      <div>
                        <figure class="figure">
                          <p>
                            <img
                              src="Hands-on_Ex05a_files/figure-html/unnamed-chunk-11-1.png"
                              class="img-fluid figure-img"
                              width="672"
                            />
                          </p>
                        </figure>
                      </div>
                    </div>
                  </div>
                </div>
                <div
                  id="tabset-1-2"
                  class="tab-pane"
                  role="tabpanel"
                  aria-labelledby="tabset-1-2-tab"
                >
                  <div class="cell">
                    <div class="sourceCode" id="cb22">
                      <pre
                        class="downlit sourceCode r code-with-copy"
                      ><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">bperm</span><span class="op">$</span><span class="va">res</span>, </span>
<span>     freq <span class="op">=</span> <span class="cn">TRUE</span>,         <span class="co"># Show the frequency (count) on y-axis</span></span>
<span>     breaks <span class="op">=</span> <span class="fl">20</span>,         <span class="co"># Set the number of bins</span></span>
<span>     xlab <span class="op">=</span> <span class="st">"Simulated Moran's I"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add vertical red line at 0 to indicate the mean under the null hypothesis of no autocorrelation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">0</span>, </span>
<span>       col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
                    </div>
                    <div class="cell-output-display">
                      <div>
                        <figure class="figure">
                          <p>
                            <img
                              src="Hands-on_Ex05a_files/figure-html/unnamed-chunk-12-1.png"
                              class="img-fluid figure-img"
                              width="672"
                            />
                          </p>
                        </figure>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div
              class="callout callout-style-default callout-note callout-titled"
            >
              <div class="callout-header d-flex align-content-center">
                <div class="callout-icon-container">
                  <i class="callout-icon"></i>
                </div>
                <div class="callout-title-container flex-fill">Note</div>
              </div>
              <div class="callout-body-container callout-body">
                <p>
                  <strong
                    >Question: What statistical conclusion can you draw from the
                    output above?</strong
                  >
                </p>
                <p>
                  The observed Moran’s I value (0.30075) lies outside the range
                  of most simulated values, indicating that it is an outlier
                  compared to the expected distribution under the null
                  hypothesis, which are centered around the expected value of
                  0.0 under the null hypothesis of no spatial autocorrelation.
                  The histogram shows that most of the simulated values of
                  Moran’s I are clustered around the mean of -0.01504572, with a
                  variance of 0.004371574.
                </p>
                <p>
                  Since the observed Moran’s I value is significantly greater
                  than the bulk of the simulated values and given the p-value
                  from the test is very small (p &lt; 0.05), there is strong
                  evidence against the null hypothesis.
                </p>
                <p>
                  There is significant positive spatial autocorrelation in the
                  GDP per capita (GDPPC) across regions, as indicated by the
                  Moran’s I test. This suggests that regions with similar GDPPC
                  values are more likely to be geographically clustered.
                </p>
              </div>
            </div>
          </section>
        </section>
        <section
          id="global-measures-of-spatial-autocorrelation-gearys-c"
          class="level2"
          data-number="10"
        >
          <h2
            data-number="10"
            class="anchored"
            data-anchor-id="global-measures-of-spatial-autocorrelation-gearys-c"
          >
            <span class="header-section-number">10</span> Global Measures of
            Spatial Autocorrelation: Geary’s C
          </h2>
          <p>
            In this section, we will perform Geary’s C statistics testing by
            using appropriate functions of <strong>spdep</strong> package.
          </p>
          <section id="gearys-c-test" class="level3" data-number="10.1">
            <h3
              data-number="10.1"
              class="anchored"
              data-anchor-id="gearys-c-test"
            >
              <span class="header-section-number">10.1</span> Geary’s C test
            </h3>
            <p>
              Another popular index of global spatial autocorrelation is Geary’s
              C which is a cousin to the Moran’s I.
            </p>
            <div
              class="callout callout-style-default callout-note callout-titled"
            >
              <div class="callout-header d-flex align-content-center">
                <div class="callout-icon-container">
                  <i class="callout-icon"></i>
                </div>
                <div class="callout-title-container flex-fill">Note</div>
              </div>
              <div class="callout-body-container callout-body">
                <p>
                  Geary’s C, also known as Geary’s contiguity ratio, is used to
                  assess the degree of spatial autocorrelation in a dataset.
                </p>
                <p>
                  It is particularly sensitive to local variations in spatial
                  data, making it suitable for analyzing patterns within smaller
                  areas.
                </p>
                <p><strong>Interpreting Geary’s C Values</strong></p>
                <p>
                  <strong>Geary’s C values range from 0 to 2.</strong> Under the
                  null hypothesis of no spatial autocorrelation, the expected
                  value of Geary’s C is 1.
                </p>
                <ul>
                  <li>
                    <p>
                      <strong>Values &lt; 1</strong>: Indicate positive spatial
                      autocorrelation, meaning similar values are clustered
                      together.
                    </p>
                  </li>
                  <li>
                    <p>
                      <strong>Values = 1</strong>: Suggest a random spatial
                      pattern with no autocorrelation.
                    </p>
                  </li>
                  <li>
                    <p>
                      <strong>Values &gt; 1</strong>: Indicate negative spatial
                      autocorrelation, meaning dissimilar values are clustered
                      together.
                    </p>
                  </li>
                </ul>
              </div>
            </div>
            <blockquote class="blockquote">
              <p>
                While Moran’s I and Geary’s C are both measures of global
                spatial autocorrelation, they are slightly different. Geary’s C
                uses the sum of squared distances whereas Moran’s I uses
                standardized spatial covariance.
              </p>
              <p>
                Unlike Moran’s I, which focuses on global patterns, Geary’s C
                emphasizes local variations and can reveal nuances in spatial
                relationships.
              </p>
              <p>
                For more info:
                <a
                  href="https://en.wikipedia.org/wiki/Geary%27s_C#:~:text=While%20Moran's%20I%20and%20Geary's,I%20uses%20standardized%20spatial%20covariance."
                  >Geary’s C</a
                >,
                <a
                  href="https://library.fiveable.me/key-terms/geospatial-engineering/gearys-c"
                  >Geary’s C</a
                >
              </p>
            </blockquote>
            <p>
              Similarly, to assess whether there is significant spatial
              autocorrelation in the GDP per capita (GDPPC) across regions, we
              can performGeary’s C test for spatial autocorrelation by using
              <a
                href="https://r-spatial.github.io/spdep/reference/geary.test.html"
                ><code>geary.test()</code></a
              >
              of <strong>spdep</strong>.
            </p>
            <ul>
              <li>
                <strong
                  >Null Hypothesis (<span class="math inline">\(H_o\)</span
                  >):</strong
                >
                There is no spatial autocorrelation in GDP per capita across the
                regions (Geary’s C = 1).
              </li>
              <li>
                <strong
                  >Alternative Hypothesis (<span class="math inline"
                    >\(H_1\)</span
                  >):</strong
                >
                There is positive spatial autocorrelation in GDP per capita
                (Geary’s C &lt; 1).
              </li>
            </ul>
            <p>
              We will use an
              <strong>alpha value (α) of 0.05 (95% confidence level)</strong> to
              determine the statistical significance.
            </p>
            <div class="cell">
              <div class="sourceCode" id="cb23">
                <pre
                  class="downlit sourceCode r code-with-copy"
                ><code class="sourceCode R"><span><span class="fu">geary.test</span><span class="op">(</span><span class="va">hunan</span><span class="op">$</span><span class="va">GDPPC</span>, listw<span class="op">=</span><span class="va">rswm_q</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
              </div>
              <div class="cell-output cell-output-stdout">
                <pre><code>
    Geary C test under randomisation

data:  hunan$GDPPC
weights: rswm_q

Geary C statistic standard deviate = 3.6108, p-value = 0.0001526
alternative hypothesis: Expectation greater than statistic
sample estimates:
Geary C statistic       Expectation          Variance
        0.6907223         1.0000000         0.0073364 </code></pre>
              </div>
            </div>
            <div
              class="callout callout-style-default callout-note callout-titled"
            >
              <div class="callout-header d-flex align-content-center">
                <div class="callout-icon-container">
                  <i class="callout-icon"></i>
                </div>
                <div class="callout-title-container flex-fill">Note</div>
              </div>
              <div class="callout-body-container callout-body">
                <p>
                  <strong
                    >Question: What statistical conclusion can you draw from the
                    output above?</strong
                  >
                </p>
                <ul>
                  <li>
                    <p>
                      The value of Geary’s C statistic is 0.6907, which is less
                      than the expected value of 1.0. This indicates positive
                      spatial autocorrelation, meaning regions with similar GDP
                      per capita (GDPPC) values tend to be geographically close
                      to each other.
                    </p>
                  </li>
                  <li>
                    <p>
                      The p-value is 0.0001526, which is much smaller than our
                      alpha value of 0.05. This provides strong evidence against
                      the null hypothesis of no spatial autocorrelation.
                    </p>
                  </li>
                </ul>
                <p>
                  Therefore, we will reject the null hypothesis at 95%
                  confidence interval because the p-value is smaller than our
                  chosen alpha value.
                </p>
              </div>
            </div>
          </section>
          <section
            id="computing-monte-carlo-gearys-c"
            class="level3"
            data-number="10.2"
          >
            <h3
              data-number="10.2"
              class="anchored"
              data-anchor-id="computing-monte-carlo-gearys-c"
            >
              <span class="header-section-number">10.2</span> Computing Monte
              Carlo Geary’s C
            </h3>
            <p>
              Similar to Moran’s I, it is best to test the statistical
              significance of Geary’s C using a Monte Carlo simulation.
            </p>
            <p>
              To perform permutation test for Geary’s C statistic by using
              <a
                href="https://r-spatial.github.io/spdep/reference/geary.mc.html"
                ><code>geary.mc()</code></a
              >
              of <strong>spdep</strong>:
            </p>
            <div class="cell">
              <div class="sourceCode" id="cb25">
                <pre
                  class="downlit sourceCode r code-with-copy"
                ><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">bperm</span><span class="op">=</span><span class="fu">geary.mc</span><span class="op">(</span><span class="va">hunan</span><span class="op">$</span><span class="va">GDPPC</span>, </span>
<span>               listw<span class="op">=</span><span class="va">rswm_q</span>, </span>
<span>               nsim<span class="op">=</span><span class="fl">999</span><span class="op">)</span></span>
<span><span class="va">bperm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
              </div>
              <div class="cell-output cell-output-stdout">
                <pre><code>
    Monte-Carlo simulation of Geary C

data:  hunan$GDPPC
weights: rswm_q
number of simulations + 1: 1000

statistic = 0.69072, observed rank = 1, p-value = 0.001
alternative hypothesis: greater</code></pre>
              </div>
            </div>
            <div
              class="callout callout-style-default callout-note callout-titled"
            >
              <div class="callout-header d-flex align-content-center">
                <div class="callout-icon-container">
                  <i class="callout-icon"></i>
                </div>
                <div class="callout-title-container flex-fill">Note</div>
              </div>
              <div class="callout-body-container callout-body">
                <p>
                  <strong
                    >Question: What statistical conclusion can you draw from the
                    output above?</strong
                  >
                </p>
                <ul>
                  <li>
                    <p>
                      The value of Geary’s C statistic is 0.6907, which is less
                      than the expected value of 1.0. This indicates positive
                      spatial autocorrelation, meaning regions with similar GDP
                      per capita (GDPPC) values tend to be geographically close
                      to each other.
                    </p>
                  </li>
                  <li>
                    <p>
                      The p-value from the Monte Carlo simulation is 0.001,
                      which is much smaller than our alpha value of 0.05. This
                      provides strong evidence against the null hypothesis of no
                      spatial autocorrelation.
                    </p>
                  </li>
                </ul>
                <p>
                  Therefore, we will
                  <strong>reject the null hypothesis at 95% confidence</strong>
                  because the p-value is smaller than our chosen alpha value.
                </p>
              </div>
            </div>
          </section>
          <section
            id="visualising-the-monte-carlo-gearys-c"
            class="level3"
            data-number="10.3"
          >
            <h3
              data-number="10.3"
              class="anchored"
              data-anchor-id="visualising-the-monte-carlo-gearys-c"
            >
              <span class="header-section-number">10.3</span> Visualising the
              Monte Carlo Geary’s C
            </h3>
            <p>
              Next, we will plot a histogram to reveal the distribution of the
              simulated values by using the code block below.
            </p>
            <p>
              We will first observe the summary report of the Geary’s C output
              before visualizing the plots using <code>ggplot2</code> and base
              R.
            </p>
            <div class="cell">
              <div class="sourceCode" id="cb27">
                <pre
                  class="downlit sourceCode r code-with-copy"
                ><code class="sourceCode R"><span><span class="co"># Calculate the mean of the first 999 simulated geary's c values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bperm</span><span class="op">$</span><span class="va">res</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">999</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
              </div>
              <div class="cell-output cell-output-stdout">
                <pre><code>[1] 1.004402</code></pre>
              </div>
              <div class="sourceCode" id="cb29">
                <pre
                  class="downlit sourceCode r code-with-copy"
                ><code class="sourceCode R"><span><span class="co"># Calculate the variance of the first 999 simulated geary's c values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">bperm</span><span class="op">$</span><span class="va">res</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">999</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
              </div>
              <div class="cell-output cell-output-stdout">
                <pre><code>[1] 0.007436493</code></pre>
              </div>
              <div class="sourceCode" id="cb31">
                <pre
                  class="downlit sourceCode r code-with-copy"
                ><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">bperm</span><span class="op">$</span><span class="va">res</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">999</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
              </div>
              <div class="cell-output cell-output-stdout">
                <pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.
 0.7142  0.9502  1.0052  1.0044  1.0595  1.2722 </code></pre>
              </div>
            </div>
            <div class="tabset-margin-container"></div>
            <div class="panel-tabset">
              <ul class="nav nav-tabs" role="tablist">
                <li class="nav-item" role="presentation">
                  <a
                    class="nav-link active"
                    id="tabset-2-1-tab"
                    data-bs-toggle="tab"
                    data-bs-target="#tabset-2-1"
                    role="tab"
                    aria-controls="tabset-2-1"
                    aria-selected="true"
                    >ggplot2</a
                  >
                </li>
                <li class="nav-item" role="presentation">
                  <a
                    class="nav-link"
                    id="tabset-2-2-tab"
                    data-bs-toggle="tab"
                    data-bs-target="#tabset-2-2"
                    role="tab"
                    aria-controls="tabset-2-2"
                    aria-selected="false"
                    >base R</a
                  >
                </li>
              </ul>
              <div class="tab-content">
                <div
                  id="tabset-2-1"
                  class="tab-pane active"
                  role="tabpanel"
                  aria-labelledby="tabset-2-1-tab"
                >
                  <div class="cell">
                    <div class="sourceCode" id="cb33">
                      <pre
                        class="downlit sourceCode r code-with-copy"
                      ><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bperm</span><span class="op">$</span><span class="va">res</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">bperm</span><span class="op">$</span><span class="va">res</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fl">20</span>,</span>
<span>                 color <span class="op">=</span> <span class="st">"black"</span>, </span>
<span>                 fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">1</span>, </span>
<span>             color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Simulated Geary's C"</span>, </span>
<span>       y <span class="op">=</span> <span class="st">"Frequency"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Histogram of Simulated Geary's C Values"</span><span class="op">)</span>       </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
                    </div>
                    <div class="cell-output-display">
                      <div>
                        <figure class="figure">
                          <p>
                            <img
                              src="Hands-on_Ex05a_files/figure-html/unnamed-chunk-16-1.png"
                              class="img-fluid figure-img"
                              width="672"
                            />
                          </p>
                        </figure>
                      </div>
                    </div>
                  </div>
                </div>
                <div
                  id="tabset-2-2"
                  class="tab-pane"
                  role="tabpanel"
                  aria-labelledby="tabset-2-2-tab"
                >
                  <div class="cell">
                    <div class="sourceCode" id="cb34">
                      <pre
                        class="downlit sourceCode r code-with-copy"
                      ><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">bperm</span><span class="op">$</span><span class="va">res</span>, freq<span class="op">=</span><span class="cn">TRUE</span>, breaks<span class="op">=</span><span class="fl">20</span>, xlab<span class="op">=</span><span class="st">"Simulated Geary's C"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fl">1</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
                    </div>
                    <div class="cell-output-display">
                      <div>
                        <figure class="figure">
                          <p>
                            <img
                              src="Hands-on_Ex05a_files/figure-html/unnamed-chunk-17-1.png"
                              class="img-fluid figure-img"
                              width="672"
                            />
                          </p>
                        </figure>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div
              class="callout callout-style-default callout-note callout-titled"
            >
              <div class="callout-header d-flex align-content-center">
                <div class="callout-icon-container">
                  <i class="callout-icon"></i>
                </div>
                <div class="callout-title-container flex-fill">Note</div>
              </div>
              <div class="callout-body-container callout-body">
                <p>
                  <strong
                    >Question: What statistical conclusion can you draw from the
                    output above?</strong
                  >
                </p>
                <p>
                  The observed Geary’s C value (0.69072) lies outside the range
                  of most simulated values, which are centered around the
                  expected value of 1.0 under the null hypothesis of no spatial
                  autocorrelation. The histogram shows that most of the
                  simulated values of Geary’s C are clustered around the mean of
                  1.0044, with a variance of 0.0074.
                </p>
                <p>
                  Since the observed Geary’s C value is significantly lower than
                  the bulk of the simulated values and the p-value from the test
                  is very small (p &lt; 0.05), there is strong evidence against
                  the null hypothesis.
                </p>
                <p>
                  There is significant positive spatial autocorrelation in the
                  GDP per capita (GDPPC) across regions, as indicated by the
                  Geary’s C test. This suggests that regions with similar GDPPC
                  values are more likely to be geographically clustered.
                </p>
              </div>
            </div>
          </section>
        </section>
        <section id="spatial-correlogram" class="level2" data-number="11">
          <h2
            data-number="11"
            class="anchored"
            data-anchor-id="spatial-correlogram"
          >
            <span class="header-section-number">11</span> Spatial Correlogram
          </h2>
          <p>
            Spatial correlograms are useful for examining patterns of spatial
            autocorrelation in your data or model residuals. They show how the
            correlation between pairs of spatial observations changes as the
            distance (lag) between them increases. Essentially, they are plots
            of a spatial autocorrelation index (such as Moran’s I or Geary’s C)
            against distance.
          </p>
          <p>
            While correlograms are not as fundamental as variograms—a core
            concept in geostatistics—they serve as powerful exploratory and
            descriptive tools. In fact, for examining spatial patterns,
            correlograms can provide more detailed insights than variograms.
          </p>
          <section
            id="compute-morans-i-correlogram"
            class="level3"
            data-number="11.1"
          >
            <h3
              data-number="11.1"
              class="anchored"
              data-anchor-id="compute-morans-i-correlogram"
            >
              <span class="header-section-number">11.1</span> Compute Moran’s I
              Correlogram
            </h3>
            <p>
              In the code below, we use the
              <a
                href="https://r-spatial.github.io/spdep/reference/sp.correlogram.html"
                ><code>sp.correlogram()</code></a
              >
              function from the <strong>spdep</strong> package to compute a
              6-lag spatial correlogram for GDP per capita (GDPPC). This
              function calculates global spatial autocorrelation using Moran’s
              I. The base R <strong>plot()</strong> function is then used to
              visualize the correlogram.
            </p>
            <div class="cell">
              <div class="sourceCode" id="cb35">
                <pre
                  class="downlit sourceCode r code-with-copy"
                ><code class="sourceCode R"><span><span class="va">MI_corr</span> <span class="op">&lt;-</span> <span class="fu">sp.correlogram</span><span class="op">(</span><span class="va">wm_q</span>, </span>
<span>                          <span class="va">hunan</span><span class="op">$</span><span class="va">GDPPC</span>, </span>
<span>                          order <span class="op">=</span> <span class="fl">6</span>, </span>
<span>                          method <span class="op">=</span> <span class="st">"I"</span>, </span>
<span>                          style <span class="op">=</span> <span class="st">"W"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">MI_corr</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
              </div>
              <div class="cell-output-display">
                <div>
                  <figure class="figure">
                    <p>
                      <img
                        src="Hands-on_Ex05a_files/figure-html/unnamed-chunk-18-1.png"
                        class="img-fluid figure-img"
                        width="672"
                      />
                    </p>
                  </figure>
                </div>
              </div>
            </div>
            <div
              class="callout callout-style-default callout-tip callout-titled"
            >
              <div class="callout-header d-flex align-content-center">
                <div class="callout-icon-container">
                  <i class="callout-icon"></i>
                </div>
                <div class="callout-title-container flex-fill">Tip</div>
              </div>
              <div class="callout-body-container callout-body">
                <p>
                  However, simply plotting the output does not provide a
                  complete interpretation because not all autocorrelation values
                  may be statistically significant. Therefore, it is important
                  to examine the full analysis report by printing the results.
                </p>
              </div>
            </div>
            <div class="cell">
              <div class="sourceCode" id="cb36">
                <pre
                  class="downlit sourceCode r code-with-copy"
                ><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">MI_corr</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
              </div>
              <div class="cell-output cell-output-stdout">
                <pre><code>Spatial correlogram for hunan$GDPPC
method: Moran's I
         estimate expectation   variance standard deviate Pr(I) two sided
1 (88)  0.3007500  -0.0114943  0.0043484           4.7351       2.189e-06 ***
2 (88)  0.2060084  -0.0114943  0.0020962           4.7505       2.029e-06 ***
3 (88)  0.0668273  -0.0114943  0.0014602           2.0496        0.040400 *
4 (88)  0.0299470  -0.0114943  0.0011717           1.2107        0.226015
5 (88) -0.1530471  -0.0114943  0.0012440          -4.0134       5.984e-05 ***
6 (88) -0.1187070  -0.0114943  0.0016791          -2.6164        0.008886 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
              </div>
            </div>
            <div
              class="callout callout-style-default callout-note callout-titled"
            >
              <div class="callout-header d-flex align-content-center">
                <div class="callout-icon-container">
                  <i class="callout-icon"></i>
                </div>
                <div class="callout-title-container flex-fill">Note</div>
              </div>
              <div class="callout-body-container callout-body">
                <p>
                  <strong
                    >Question: What statistical observation can you draw from
                    the plot above?</strong
                  >
                </p>
                <p>
                  The spatial correlogram shows Moran’s I values for different
                  distance lags, which indicate how spatial autocorrelation in
                  GDP per capita (GDPPC) changes as the distance between regions
                  increases.
                </p>
                <ol type="1">
                  <li>
                    <strong
                      >Significant Positive Spatial Autocorrelation at Shorter
                      Distances:</strong
                    >
                    <ul>
                      <li>
                        For lags 1 and 2, Moran’s I values are significantly
                        positive (0.30075 and 0.20601, respectively). The
                        p-values for these lags are very small (p &lt; 0.001).
                        This suggests that regions with similar GDPPC values
                        tend to be clustered together at these shorter
                        distances.
                      </li>
                    </ul>
                  </li>
                  <li>
                    <strong
                      >Decreasing and Insignificant Spatial Autocorrelation at
                      Moderate Distances:</strong
                    >
                    <ul>
                      <li>
                        At lag 3, Moran’s I value is 0.06683, with the
                        confidence interval still above zero, indicating weak
                        but significant positive spatial autocorrelation (p &lt;
                        0.05).
                      </li>
                      <li>
                        At lag 4, Moran’s I value further decreases to 0.02995.
                        The p-value (0.226) is not significant, suggesting that
                        spatial autocorrelation is not statistically significant
                        at this distance.
                      </li>
                    </ul>
                  </li>
                  <li>
                    <strong
                      >Significant Negative Spatial Autocorrelation at Longer
                      Distances:</strong
                    >
                    <ul>
                      <li>
                        For lags 5 and 6, Moran’s I values become negative
                        (-0.15305 and -0.11871, respectively). The p-values for
                        these lags are very small (p &lt; 0.001 and p &lt; 0.01,
                        respectively), indicating statistically significant
                        negative spatial autocorrelation. This means that
                        regions with dissimilar GDPPC values tend to be found
                        farther apart.
                      </li>
                    </ul>
                  </li>
                </ol>
              </div>
            </div>
          </section>
          <section
            id="compute-gearys-c-correlogram-and-plot"
            class="level3"
            data-number="11.2"
          >
            <h3
              data-number="11.2"
              class="anchored"
              data-anchor-id="compute-gearys-c-correlogram-and-plot"
            >
              <span class="header-section-number">11.2</span> Compute Geary’s C
              Correlogram and Plot
            </h3>
            <p>
              Similarly, we can use <code>sp.correlogram()</code> of
              <strong>spdep</strong> package to compute a 6-lag spatial
              correlogram of GDPPC. The global spatial autocorrelation used in
              Geary’s C and the <strong>plot()</strong> of base Graph is then
              used to plot the output.
            </p>
            <div class="cell">
              <div class="sourceCode" id="cb38">
                <pre
                  class="downlit sourceCode r code-with-copy"
                ><code class="sourceCode R"><span><span class="va">GC_corr</span> <span class="op">&lt;-</span> <span class="fu">sp.correlogram</span><span class="op">(</span><span class="va">wm_q</span>, </span>
<span>                          <span class="va">hunan</span><span class="op">$</span><span class="va">GDPPC</span>, </span>
<span>                          order<span class="op">=</span><span class="fl">6</span>, </span>
<span>                          method<span class="op">=</span><span class="st">"C"</span>, </span>
<span>                          style<span class="op">=</span><span class="st">"W"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">GC_corr</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
              </div>
              <div class="cell-output-display">
                <div>
                  <figure class="figure">
                    <p>
                      <img
                        src="Hands-on_Ex05a_files/figure-html/unnamed-chunk-20-1.png"
                        class="img-fluid figure-img"
                        width="672"
                      />
                    </p>
                  </figure>
                </div>
              </div>
            </div>
            <p>
              Similar to the previous step, we will print out the analysis
              report by using the code block below.
            </p>
            <div class="cell">
              <div class="sourceCode" id="cb39">
                <pre
                  class="downlit sourceCode r code-with-copy"
                ><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">GC_corr</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre>
              </div>
              <div class="cell-output cell-output-stdout">
                <pre><code>Spatial correlogram for hunan$GDPPC
method: Geary's C
        estimate expectation  variance standard deviate Pr(I) two sided
1 (88) 0.6907223   1.0000000 0.0073364          -3.6108       0.0003052 ***
2 (88) 0.7630197   1.0000000 0.0049126          -3.3811       0.0007220 ***
3 (88) 0.9397299   1.0000000 0.0049005          -0.8610       0.3892612
4 (88) 1.0098462   1.0000000 0.0039631           0.1564       0.8757128
5 (88) 1.2008204   1.0000000 0.0035568           3.3673       0.0007592 ***
6 (88) 1.0773386   1.0000000 0.0058042           1.0151       0.3100407
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
              </div>
            </div>
            <div
              class="callout callout-style-default callout-note callout-titled"
            >
              <div class="callout-header d-flex align-content-center">
                <div class="callout-icon-container">
                  <i class="callout-icon"></i>
                </div>
                <div class="callout-title-container flex-fill">Note</div>
              </div>
              <div class="callout-body-container callout-body">
                <p>
                  <strong
                    >Question: What statistical observation can you draw from
                    the plot above?</strong
                  >
                </p>
                <p>
                  The spatial correlogram shows Geary’s C values for different
                  distance lags, illustrating how spatial autocorrelation in GDP
                  per capita (GDPPC) changes with distance:
                </p>
                <ol type="1">
                  <li>
                    <strong
                      >Significant Positive Spatial Autocorrelation at Shorter
                      Distances:</strong
                    >
                    <ul>
                      <li>
                        For lags 1 and 2, Geary’s C values (0.6907 and 0.7630,
                        respectively). This indicates significant positive
                        spatial autocorrelation, suggesting that similar GDPPC
                        values are clustered together at shorter distances (p
                        &lt; 0.05).
                      </li>
                    </ul>
                  </li>
                  <li>
                    <strong
                      >Insignificant Autocorrelation at Moderate
                      Distances:</strong
                    >
                    <ul>
                      <li>
                        At lags 3 and 4, Geary’s C values are close to 1.0
                        (0.9397 and 1.0098), and their confidence intervals
                        include 1, indicating no significant spatial
                        autocorrelation (p &gt; 0.05).
                      </li>
                    </ul>
                  </li>
                  <li>
                    <strong
                      >Significant Negative Spatial Autocorrelation at Longer
                      Distances:</strong
                    >
                    <ul>
                      <li>
                        At lag 5, Geary’s C value (1.2008) is significantly
                        greater than 1.0, with the confidence interval not
                        crossing 1, indicating significant negative spatial
                        autocorrelation (p &lt; 0.05). This suggests that
                        dissimilar GDPPC values are more likely to be found at
                        longer distances.
                      </li>
                    </ul>
                  </li>
                  <li>
                    <strong
                      >No Significant Spatial Autocorrelation at the Furthest
                      Distance:</strong
                    >
                    <ul>
                      <li>
                        At lag 6, Geary’s C value (1.0773) is slightly above 1,
                        but the confidence interval includes 1, indicating no
                        significant spatial autocorrelation (p &gt; 0.05).
                      </li>
                    </ul>
                  </li>
                </ol>
              </div>
            </div>
          </section>
        </section>
      </main>
      <!-- /main -->
      <script id="quarto-html-after-body" type="application/javascript">
        window.document.addEventListener("DOMContentLoaded", function (event) {
          const toggleBodyColorMode = (bsSheetEl) => {
            const mode = bsSheetEl.getAttribute("data-mode");
            const bodyEl = window.document.querySelector("body");
            if (mode === "dark") {
              bodyEl.classList.add("quarto-dark");
              bodyEl.classList.remove("quarto-light");
            } else {
              bodyEl.classList.add("quarto-light");
              bodyEl.classList.remove("quarto-dark");
            }
          };
          const toggleBodyColorPrimary = () => {
            const bsSheetEl = window.document.querySelector(
              "link#quarto-bootstrap"
            );
            if (bsSheetEl) {
              toggleBodyColorMode(bsSheetEl);
            }
          };
          toggleBodyColorPrimary();
          const disableStylesheet = (stylesheets) => {
            for (let i = 0; i < stylesheets.length; i++) {
              const stylesheet = stylesheets[i];
              stylesheet.rel = "prefetch";
            }
          };
          const enableStylesheet = (stylesheets) => {
            for (let i = 0; i < stylesheets.length; i++) {
              const stylesheet = stylesheets[i];
              stylesheet.rel = "stylesheet";
            }
          };
          const manageTransitions = (selector, allowTransitions) => {
            const els = window.document.querySelectorAll(selector);
            for (let i = 0; i < els.length; i++) {
              const el = els[i];
              if (allowTransitions) {
                el.classList.remove("notransition");
              } else {
                el.classList.add("notransition");
              }
            }
          };
          const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
            const baseTheme =
              document.querySelector("#giscus-base-theme")?.value ?? "light";
            const alternateTheme =
              document.querySelector("#giscus-alt-theme")?.value ?? "dark";
            let newTheme = "";
            if (darkModeDefault) {
              newTheme = isAlternate ? baseTheme : alternateTheme;
            } else {
              newTheme = isAlternate ? alternateTheme : baseTheme;
            }
            const changeGiscusTheme = () => {
              // From: https://github.com/giscus/giscus/issues/336
              const sendMessage = (message) => {
                const iframe = document.querySelector("iframe.giscus-frame");
                if (!iframe) return;
                iframe.contentWindow.postMessage(
                  { giscus: message },
                  "https://giscus.app"
                );
              };
              sendMessage({
                setConfig: {
                  theme: newTheme,
                },
              });
            };
            const isGiscussLoaded =
              window.document.querySelector("iframe.giscus-frame") !== null;
            if (isGiscussLoaded) {
              changeGiscusTheme();
            }
          };
          const toggleColorMode = (alternate) => {
            // Switch the stylesheets
            const alternateStylesheets = window.document.querySelectorAll(
              "link.quarto-color-scheme.quarto-color-alternate"
            );
            manageTransitions("#quarto-margin-sidebar .nav-link", false);
            if (alternate) {
              enableStylesheet(alternateStylesheets);
              for (const sheetNode of alternateStylesheets) {
                if (sheetNode.id === "quarto-bootstrap") {
                  toggleBodyColorMode(sheetNode);
                }
              }
            } else {
              disableStylesheet(alternateStylesheets);
              toggleBodyColorPrimary();
            }
            manageTransitions("#quarto-margin-sidebar .nav-link", true);
            // Switch the toggles
            const toggles = window.document.querySelectorAll(
              ".quarto-color-scheme-toggle"
            );
            for (let i = 0; i < toggles.length; i++) {
              const toggle = toggles[i];
              if (toggle) {
                if (alternate) {
                  toggle.classList.add("alternate");
                } else {
                  toggle.classList.remove("alternate");
                }
              }
            }
            // Hack to workaround the fact that safari doesn't
            // properly recolor the scrollbar when toggling (#1455)
            if (
              navigator.userAgent.indexOf("Safari") > 0 &&
              navigator.userAgent.indexOf("Chrome") == -1
            ) {
              manageTransitions("body", false);
              window.scrollTo(0, 1);
              setTimeout(() => {
                window.scrollTo(0, 0);
                manageTransitions("body", true);
              }, 40);
            }
          };
          const isFileUrl = () => {
            return window.location.protocol === "file:";
          };
          const hasAlternateSentinel = () => {
            let styleSentinel = getColorSchemeSentinel();
            if (styleSentinel !== null) {
              return styleSentinel === "alternate";
            } else {
              return false;
            }
          };
          const setStyleSentinel = (alternate) => {
            const value = alternate ? "alternate" : "default";
            if (!isFileUrl()) {
              window.localStorage.setItem("quarto-color-scheme", value);
            } else {
              localAlternateSentinel = value;
            }
          };
          const getColorSchemeSentinel = () => {
            if (!isFileUrl()) {
              const storageValue = window.localStorage.getItem(
                "quarto-color-scheme"
              );
              return storageValue != null
                ? storageValue
                : localAlternateSentinel;
            } else {
              return localAlternateSentinel;
            }
          };
          const darkModeDefault = true;
          let localAlternateSentinel = darkModeDefault
            ? "alternate"
            : "default";
          // Dark / light mode switch
          window.quartoToggleColorScheme = () => {
            // Read the current dark / light value
            let toAlternate = !hasAlternateSentinel();
            toggleColorMode(toAlternate);
            setStyleSentinel(toAlternate);
            toggleGiscusIfUsed(toAlternate, darkModeDefault);
          };
          // Ensure there is a toggle, if there isn't float one in the top right
          if (
            window.document.querySelector(".quarto-color-scheme-toggle") ===
            null
          ) {
            const a = window.document.createElement("a");
            a.classList.add("top-right");
            a.classList.add("quarto-color-scheme-toggle");
            a.href = "";
            a.onclick = function () {
              try {
                window.quartoToggleColorScheme();
              } catch {}
              return false;
            };
            const i = window.document.createElement("i");
            i.classList.add("bi");
            a.appendChild(i);
            window.document.body.appendChild(a);
          }
          // Switch to dark mode if need be
          if (hasAlternateSentinel()) {
            toggleColorMode(true);
          } else {
            toggleColorMode(false);
          }
          const icon = "";
          const anchorJS = new window.AnchorJS();
          anchorJS.options = {
            placement: "right",
            icon: icon,
          };
          anchorJS.add(".anchored");
          const isCodeAnnotation = (el) => {
            for (const clz of el.classList) {
              if (clz.startsWith("code-annotation-")) {
                return true;
              }
            }
            return false;
          };
          const onCopySuccess = function (e) {
            // button target
            const button = e.trigger;
            // don't keep focus
            button.blur();
            // flash "checked"
            button.classList.add("code-copy-button-checked");
            var currentTitle = button.getAttribute("title");
            button.setAttribute("title", "Copied!");
            let tooltip;
            if (window.bootstrap) {
              button.setAttribute("data-bs-toggle", "tooltip");
              button.setAttribute("data-bs-placement", "left");
              button.setAttribute("data-bs-title", "Copied!");
              tooltip = new bootstrap.Tooltip(button, {
                trigger: "manual",
                customClass: "code-copy-button-tooltip",
                offset: [0, -8],
              });
              tooltip.show();
            }
            setTimeout(function () {
              if (tooltip) {
                tooltip.hide();
                button.removeAttribute("data-bs-title");
                button.removeAttribute("data-bs-toggle");
                button.removeAttribute("data-bs-placement");
              }
              button.setAttribute("title", currentTitle);
              button.classList.remove("code-copy-button-checked");
            }, 1000);
            // clear code selection
            e.clearSelection();
          };
          const getTextToCopy = function (trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
          };
          const clipboard = new window.ClipboardJS(
            ".code-copy-button:not([data-in-quarto-modal])",
            {
              text: getTextToCopy,
            }
          );
          clipboard.on("success", onCopySuccess);
          if (
            window.document.getElementById("quarto-embedded-source-code-modal")
          ) {
            // For code content inside modals, clipBoardJS needs to be initialized with a container option
            // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
            const clipboardModal = new window.ClipboardJS(
              ".code-copy-button[data-in-quarto-modal]",
              {
                text: getTextToCopy,
                container: window.document.getElementById(
                  "quarto-embedded-source-code-modal"
                ),
              }
            );
            clipboardModal.on("success", onCopySuccess);
          }
          var localhostRegex = new RegExp(
            /^(?:http|https):\/\/localhost\:?[0-9]*\//
          );
          var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/isss626-gaa\.netlify\.app\/");
          var isInternal = (href) => {
            return (
              filterRegex.test(href) ||
              localhostRegex.test(href) ||
              mailtoRegex.test(href)
            );
          };
          // Inspect non-navigation links and adorn them if external
          var links = window.document.querySelectorAll(
            "a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)"
          );
          for (var i = 0; i < links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
          function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
            const config = {
              allowHTML: true,
              maxWidth: 500,
              delay: 100,
              arrow: false,
              appendTo: function (el) {
                return el.parentElement;
              },
              interactive: true,
              interactiveBorder: 10,
              theme: "quarto",
              placement: "bottom-start",
            };
            if (contentFn) {
              config.content = contentFn;
            }
            if (onTriggerFn) {
              config.onTrigger = onTriggerFn;
            }
            if (onUntriggerFn) {
              config.onUntrigger = onUntriggerFn;
            }
            window.tippy(el, config);
          }
          const noterefs = window.document.querySelectorAll(
            'a[role="doc-noteref"]'
          );
          for (var i = 0; i < noterefs.length; i++) {
            const ref = noterefs[i];
            tippyHover(ref, function () {
              // use id or data attribute instead here
              let href =
                ref.getAttribute("data-footnote-href") ||
                ref.getAttribute("href");
              try {
                href = new URL(href).hash;
              } catch {}
              const id = href.replace(/^#\/?/, "");
              const note = window.document.getElementById(id);
              if (note) {
                return note.innerHTML;
              } else {
                return "";
              }
            });
          }
          const xrefs = window.document.querySelectorAll("a.quarto-xref");
          const processXRef = (id, note) => {
            // Strip column container classes
            const stripColumnClz = (el) => {
              el.classList.remove("page-full", "page-columns");
              if (el.children) {
                for (const child of el.children) {
                  stripColumnClz(child);
                }
              }
            };
            stripColumnClz(note);
            if (id === null || id.startsWith("sec-")) {
              // Special case sections, only their first couple elements
              const container = document.createElement("div");
              if (note.children && note.children.length > 2) {
                container.appendChild(note.children[0].cloneNode(true));
                for (let i = 1; i < note.children.length; i++) {
                  const child = note.children[i];
                  if (child.tagName === "P" && child.innerText === "") {
                    continue;
                  } else {
                    container.appendChild(child.cloneNode(true));
                    break;
                  }
                }
                if (window.Quarto?.typesetMath) {
                  window.Quarto.typesetMath(container);
                }
                return container.innerHTML;
              } else {
                if (window.Quarto?.typesetMath) {
                  window.Quarto.typesetMath(note);
                }
                return note.innerHTML;
              }
            } else {
              // Remove any anchor links if they are present
              const anchorLink = note.querySelector("a.anchorjs-link");
              if (anchorLink) {
                anchorLink.remove();
              }
              if (window.Quarto?.typesetMath) {
                window.Quarto.typesetMath(note);
              }
              // TODO in 1.5, we should make sure this works without a callout special case
              if (note.classList.contains("callout")) {
                return note.outerHTML;
              } else {
                return note.innerHTML;
              }
            }
          };
          for (var i = 0; i < xrefs.length; i++) {
            const xref = xrefs[i];
            tippyHover(
              xref,
              undefined,
              function (instance) {
                instance.disable();
                let url = xref.getAttribute("href");
                let hash = undefined;
                if (url.startsWith("#")) {
                  hash = url;
                } else {
                  try {
                    hash = new URL(url).hash;
                  } catch {}
                }
                if (hash) {
                  const id = hash.replace(/^#\/?/, "");
                  const note = window.document.getElementById(id);
                  if (note !== null) {
                    try {
                      const html = processXRef(id, note.cloneNode(true));
                      instance.setContent(html);
                    } finally {
                      instance.enable();
                      instance.show();
                    }
                  } else {
                    // See if we can fetch this
                    fetch(url.split("#")[0])
                      .then((res) => res.text())
                      .then((html) => {
                        const parser = new DOMParser();
                        const htmlDoc = parser.parseFromString(
                          html,
                          "text/html"
                        );
                        const note = htmlDoc.getElementById(id);
                        if (note !== null) {
                          const html = processXRef(id, note);
                          instance.setContent(html);
                        }
                      })
                      .finally(() => {
                        instance.enable();
                        instance.show();
                      });
                  }
                } else {
                  // See if we can fetch a full url (with no hash to target)
                  // This is a special case and we should probably do some content thinning / targeting
                  fetch(url)
                    .then((res) => res.text())
                    .then((html) => {
                      const parser = new DOMParser();
                      const htmlDoc = parser.parseFromString(html, "text/html");
                      const note = htmlDoc.querySelector("main.content");
                      if (note !== null) {
                        // This should only happen for chapter cross references
                        // (since there is no id in the URL)
                        // remove the first header
                        if (
                          note.children.length > 0 &&
                          note.children[0].tagName === "HEADER"
                        ) {
                          note.children[0].remove();
                        }
                        const html = processXRef(null, note);
                        instance.setContent(html);
                      }
                    })
                    .finally(() => {
                      instance.enable();
                      instance.show();
                    });
                }
              },
              function (instance) {}
            );
          }
          let selectedAnnoteEl;
          const selectorForAnnotation = (cell, annotation) => {
            let cellAttr = 'data-code-cell="' + cell + '"';
            let lineAttr = 'data-code-annotation="' + annotation + '"';
            const selector = "span[" + cellAttr + "][" + lineAttr + "]";
            return selector;
          };
          const selectCodeLines = (annoteEl) => {
            const doc = window.document;
            const targetCell = annoteEl.getAttribute("data-target-cell");
            const targetAnnotation = annoteEl.getAttribute(
              "data-target-annotation"
            );
            const annoteSpan = window.document.querySelector(
              selectorForAnnotation(targetCell, targetAnnotation)
            );
            const lines = annoteSpan.getAttribute("data-code-lines").split(",");
            const lineIds = lines.map((line) => {
              return targetCell + "-" + line;
            });
            let top = null;
            let height = null;
            let parent = null;
            if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
              if (lineIds.length > 1) {
                const lastEl = window.document.getElementById(
                  lineIds[lineIds.length - 1]
                );
                const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                height = bottom - top;
              }
              if (top !== null && height !== null && parent !== null) {
                // cook up a div (if necessary) and position it
                let div = window.document.getElementById(
                  "code-annotation-line-highlight"
                );
                if (div === null) {
                  div = window.document.createElement("div");
                  div.setAttribute("id", "code-annotation-line-highlight");
                  div.style.position = "absolute";
                  parent.appendChild(div);
                }
                div.style.top = top - 2 + "px";
                div.style.height = height + 4 + "px";
                div.style.left = 0;
                let gutterDiv = window.document.getElementById(
                  "code-annotation-line-highlight-gutter"
                );
                if (gutterDiv === null) {
                  gutterDiv = window.document.createElement("div");
                  gutterDiv.setAttribute(
                    "id",
                    "code-annotation-line-highlight-gutter"
                  );
                  gutterDiv.style.position = "absolute";
                  const codeCell = window.document.getElementById(targetCell);
                  const gutter = codeCell.querySelector(
                    ".code-annotation-gutter"
                  );
                  gutter.appendChild(gutterDiv);
                }
                gutterDiv.style.top = top - 2 + "px";
                gutterDiv.style.height = height + 4 + "px";
              }
              selectedAnnoteEl = annoteEl;
            }
          };
          const unselectCodeLines = () => {
            const elementsIds = [
              "code-annotation-line-highlight",
              "code-annotation-line-highlight-gutter",
            ];
            elementsIds.forEach((elId) => {
              const div = window.document.getElementById(elId);
              if (div) {
                div.remove();
              }
            });
            selectedAnnoteEl = undefined;
          };
          // Handle positioning of the toggle
          window.addEventListener(
            "resize",
            throttle(() => {
              elRect = undefined;
              if (selectedAnnoteEl) {
                selectCodeLines(selectedAnnoteEl);
              }
            }, 10)
          );
          function throttle(fn, ms) {
            let throttle = false;
            let timer;
            return (...args) => {
              if (!throttle) {
                // first call gets through
                fn.apply(this, args);
                throttle = true;
              } else {
                // all the others get throttled
                if (timer) clearTimeout(timer); // cancel #2
                timer = setTimeout(() => {
                  fn.apply(this, args);
                  timer = throttle = false;
                }, ms);
              }
            };
          }
          // Attach click handler to the DT
          const annoteDls = window.document.querySelectorAll(
            "dt[data-target-cell]"
          );
          for (const annoteDlNode of annoteDls) {
            annoteDlNode.addEventListener("click", (event) => {
              const clickedEl = event.target;
              if (clickedEl !== selectedAnnoteEl) {
                unselectCodeLines();
                const activeEl = window.document.querySelector(
                  "dt[data-target-cell].code-annotation-active"
                );
                if (activeEl) {
                  activeEl.classList.remove("code-annotation-active");
                }
                selectCodeLines(clickedEl);
                clickedEl.classList.add("code-annotation-active");
              } else {
                // Unselect the line
                unselectCodeLines();
                clickedEl.classList.remove("code-annotation-active");
              }
            });
          }
          const findCites = (el) => {
            const parentEl = el.parentElement;
            if (parentEl) {
              const cites = parentEl.dataset.cites;
              if (cites) {
                return {
                  el,
                  cites: cites.split(" "),
                };
              } else {
                return findCites(el.parentElement);
              }
            } else {
              return undefined;
            }
          };
          var bibliorefs = window.document.querySelectorAll(
            'a[role="doc-biblioref"]'
          );
          for (var i = 0; i < bibliorefs.length; i++) {
            const ref = bibliorefs[i];
            const citeInfo = findCites(ref);
            if (citeInfo) {
              tippyHover(citeInfo.el, function () {
                var popup = window.document.createElement("div");
                citeInfo.cites.forEach(function (cite) {
                  var citeDiv = window.document.createElement("div");
                  citeDiv.classList.add("hanging-indent");
                  citeDiv.classList.add("csl-entry");
                  var biblioDiv = window.document.getElementById("ref-" + cite);
                  if (biblioDiv) {
                    citeDiv.innerHTML = biblioDiv.innerHTML;
                  }
                  popup.appendChild(citeDiv);
                });
                return popup.innerHTML;
              });
            }
          }
        });
      </script>
    </div>
    <!-- /content -->
  </body>
</html>

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Teng Kok Wai (Walter)">
<meta name="dcterms.date" content="2024-09-30">
<title>Take Home Exercise 2 – Walter Teng’s Coursework for SMU ISSS626: Geospatial Analytics and Applications</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-4MGB7PXBSL"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-4MGB7PXBSL', { 'anonymize_ip': true});
</script><link href="../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="../../site_libs/datatables-binding-0.33/datatables.js"></script><script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><link href="../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><script src="../../site_libs/plotly-binding-4.10.4/plotly.js"></script><script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script><link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Take Home Exercise 2 – Walter Teng’s Coursework for SMU ISSS626: Geospatial Analytics and Applications">
<meta property="og:description" content="In this exercise, we will explore how COVID-19 affected Thailand’s tourism economy using spatial and spatio-temporal analysis, focusing on how the impacts varied across different provinces and examining recovery patterns.">
<meta property="og:image" content="https://isss626-gaa.netlify.app/Take-home_Ex/Take-home_Ex02/og-img.png">
<meta property="og:site_name" content="Walter Teng's Coursework for SMU ISSS626: Geospatial Analytics and Applications">
<meta name="twitter:title" content="Take Home Exercise 2 – Walter Teng’s Coursework for SMU ISSS626: Geospatial Analytics and Applications">
<meta name="twitter:description" content="In this exercise, we will explore how COVID-19 affected Thailand’s tourism economy using spatial and spatio-temporal analysis, focusing on how the impacts varied across different provinces and examining recovery patterns.">
<meta name="twitter:image" content="https://isss626-gaa.netlify.app/Take-home_Ex/Take-home_Ex02/og-img.png">
<meta name="twitter:creator" content="@davzoku">
<meta name="twitter:site" content="@davzoku">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS626 Geospatial Analytics and Applications</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">
<li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01a.html">
 <span class="dropdown-text">1A: Geospatial Data Wrangling with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01b.html">
 <span class="dropdown-text">1B: Choropleth Mapping with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02a.html">
 <span class="dropdown-text">2A: 1st Order Spatial Point Patterns Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02b.html">
 <span class="dropdown-text">2B: 2nd Order Spatial Point Patterns Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03a.html">
 <span class="dropdown-text">3A: Network Constrained Spatial Point Patterns Analysis</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04a.html">
 <span class="dropdown-text">4A: Spatial Weights and Applications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05a.html">
 <span class="dropdown-text">5A: Global Measures of Spatial Autocorrelation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05b.html">
 <span class="dropdown-text">5B: Local Measures of Spatial Autocorrelation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06a.html">
 <span class="dropdown-text">6A: Geographical Segmentation with Spatially Constrained Clustering Techniques</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07a.html">
 <span class="dropdown-text">7A: Calibrating Hedonic Pricing Model for Private Highrise Property with GWR Method</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08a.html">
 <span class="dropdown-text">8A: Geographically Weighted Predictive Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09a.html">
 <span class="dropdown-text">9A: Processing and Visualising Flow Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09b.html">
 <span class="dropdown-text">9B: Calibrating Spatial Interaction Models with R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10a.html">
 <span class="dropdown-text">10A: Modelling Geographical Accessibility</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">
<li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html">
 <span class="dropdown-text">In-class Exercise 01</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html">
 <span class="dropdown-text">In-class Exercise 02</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-class Exercise 03</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-class Exercise 04</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html">
 <span class="dropdown-text">In-class Exercise 05</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html">
 <span class="dropdown-text">In-class Exercise 06</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex07.html">
 <span class="dropdown-text">In-class Exercise 07</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex08/In-class_Ex08.html">
 <span class="dropdown-text">In-class Exercise 08</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex09/In-class_Ex09.html">
 <span class="dropdown-text">In-class Exercise 09</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex10/In-class_Ex10.html">
 <span class="dropdown-text">In-class Exercise 10</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">
<li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html">
 <span class="dropdown-text">Take-home Exercise 01</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html">
 <span class="dropdown-text">Take-home Exercise 02</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html">
 <span class="dropdown-text">Take-home Exercise 03</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link" href="../../Exploration/index.html"> 
<span class="menu-text">Exploration</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text"><i class="fa-solid fa-house fa-md" aria-label="house"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.walterteng.com"> 
<span class="menu-text"><i class="fa-solid fa-user fa-md" aria-label="user"></i></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/tengkokwai/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/davzoku/isss626-gaa"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#assignment-task" id="toc-assignment-task" class="nav-link active" data-scroll-target="#assignment-task"><span class="header-section-number">1</span> Assignment Task</a></li>
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview"><span class="header-section-number">2</span> Overview</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives"><span class="header-section-number">3</span> Objectives</a></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology"><span class="header-section-number">4</span> Methodology</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data"><span class="header-section-number">5</span> The Data</a></li>
  <li>
<a href="#installing-and-launching-the-r-packages" id="toc-installing-and-launching-the-r-packages" class="nav-link" data-scroll-target="#installing-and-launching-the-r-packages"><span class="header-section-number">6</span> Installing and Launching the R Packages</a>
  <ul class="collapse">
<li><a href="#reproducibility" id="toc-reproducibility" class="nav-link" data-scroll-target="#reproducibility"><span class="header-section-number">6.1</span> Reproducibility</a></li>
  </ul>
</li>
  <li>
<a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data"><span class="header-section-number">7</span> Import Data</a>
  <ul class="collapse">
<li><a href="#import-geospatial-data" id="toc-import-geospatial-data" class="nav-link" data-scroll-target="#import-geospatial-data"><span class="header-section-number">7.1</span> Import Geospatial Data</a></li>
  <li><a href="#import-aspatial-data" id="toc-import-aspatial-data" class="nav-link" data-scroll-target="#import-aspatial-data"><span class="header-section-number">7.2</span> Import Aspatial Data</a></li>
  </ul>
</li>
  <li>
<a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling"><span class="header-section-number">8</span> Data Wrangling</a>
  <ul class="collapse">
<li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning"><span class="header-section-number">8.1</span> Data Cleaning</a></li>
  <li><a href="#feature-engineering" id="toc-feature-engineering" class="nav-link" data-scroll-target="#feature-engineering"><span class="header-section-number">8.2</span> Feature Engineering</a></li>
  <li><a href="#combining-datasets" id="toc-combining-datasets" class="nav-link" data-scroll-target="#combining-datasets"><span class="header-section-number">8.3</span> Combining Datasets</a></li>
  </ul>
</li>
  <li>
<a href="#exploratory-data-analysis-eda" id="toc-exploratory-data-analysis-eda" class="nav-link" data-scroll-target="#exploratory-data-analysis-eda"><span class="header-section-number">9</span> Exploratory Data Analysis (EDA)</a>
  <ul class="collapse">
<li><a href="#determining-key-economic-indicators" id="toc-determining-key-economic-indicators" class="nav-link" data-scroll-target="#determining-key-economic-indicators"><span class="header-section-number">9.1</span> Determining Key Economic Indicators</a></li>
  <li><a href="#creating-the-derived-tourism-economy-indicators-layer-in-spacetime" id="toc-creating-the-derived-tourism-economy-indicators-layer-in-spacetime" class="nav-link" data-scroll-target="#creating-the-derived-tourism-economy-indicators-layer-in-spacetime"><span class="header-section-number">9.2</span> Creating the Derived Tourism Economy Indicators Layer in spacetime</a></li>
  </ul>
</li>
  <li>
<a href="#spatial-independence-of-thailands-tourism-economy-indictators" id="toc-spatial-independence-of-thailands-tourism-economy-indictators" class="nav-link" data-scroll-target="#spatial-independence-of-thailands-tourism-economy-indictators"><span class="header-section-number">10</span> Spatial Independence of Thailand’s Tourism Economy Indictators</a>
  <ul class="collapse">
<li><a href="#creating-spatial-weight-matrix" id="toc-creating-spatial-weight-matrix" class="nav-link" data-scroll-target="#creating-spatial-weight-matrix"><span class="header-section-number">10.1</span> Creating Spatial Weight Matrix</a></li>
  <li><a href="#global-spatial-autocorrelation-analysis" id="toc-global-spatial-autocorrelation-analysis" class="nav-link" data-scroll-target="#global-spatial-autocorrelation-analysis"><span class="header-section-number">10.2</span> Global Spatial Autocorrelation Analysis</a></li>
  <li><a href="#local-spatial-autocorrelation-analysis" id="toc-local-spatial-autocorrelation-analysis" class="nav-link" data-scroll-target="#local-spatial-autocorrelation-analysis"><span class="header-section-number">10.3</span> Local Spatial Autocorrelation Analysis</a></li>
  </ul>
</li>
  <li>
<a href="#spatio-temporal-independence-of-thailands-tourism-economy-indictators" id="toc-spatio-temporal-independence-of-thailands-tourism-economy-indictators" class="nav-link" data-scroll-target="#spatio-temporal-independence-of-thailands-tourism-economy-indictators"><span class="header-section-number">11</span> Spatio-Temporal Independence of Thailand’s Tourism Economy Indictators</a>
  <ul class="collapse">
<li><a href="#global-spatial-autocorrelation-analysis-across-time-periods" id="toc-global-spatial-autocorrelation-analysis-across-time-periods" class="nav-link" data-scroll-target="#global-spatial-autocorrelation-analysis-across-time-periods"><span class="header-section-number">11.1</span> Global Spatial Autocorrelation Analysis Across Time Periods</a></li>
  <li><a href="#local-spatial-autocorrelation-analysis-across-time-periods" id="toc-local-spatial-autocorrelation-analysis-across-time-periods" class="nav-link" data-scroll-target="#local-spatial-autocorrelation-analysis-across-time-periods"><span class="header-section-number">11.2</span> Local Spatial Autocorrelation Analysis Across Time Periods</a></li>
  </ul>
</li>
  <li>
<a href="#emerging-hotspot-analysis" id="toc-emerging-hotspot-analysis" class="nav-link" data-scroll-target="#emerging-hotspot-analysis"><span class="header-section-number">12</span> Emerging Hotspot Analysis</a>
  <ul class="collapse">
<li><a href="#computing-gi" id="toc-computing-gi" class="nav-link" data-scroll-target="#computing-gi"><span class="header-section-number">12.1</span> Computing Gi*</a></li>
  <li><a href="#mann-kendall-test" id="toc-mann-kendall-test" class="nav-link" data-scroll-target="#mann-kendall-test"><span class="header-section-number">12.2</span> Mann-Kendall Test</a></li>
  <li><a href="#performing-emerging-hotspot-analysis" id="toc-performing-emerging-hotspot-analysis" class="nav-link" data-scroll-target="#performing-emerging-hotspot-analysis"><span class="header-section-number">12.3</span> Performing Emerging Hotspot Analysis</a></li>
  <li><a href="#visualizing-distribution-of-ehsa-classes-and-maps" id="toc-visualizing-distribution-of-ehsa-classes-and-maps" class="nav-link" data-scroll-target="#visualizing-distribution-of-ehsa-classes-and-maps"><span class="header-section-number">12.4</span> Visualizing Distribution of EHSA Classes and Maps</a></li>
  </ul>
</li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">13</span> Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">14</span> References</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Take Home Exercise 2</h1>
<p class="subtitle lead">In this exercise, we will explore how COVID-19 affected Thailand’s tourism economy using spatial and spatio-temporal analysis, focusing on how the impacts varied across different provinces and examining recovery patterns.</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Teng Kok Wai (Walter) </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 30, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">October 13, 2024</p>
    </div>
  </div>
    
  </div>
  


</header><section id="assignment-task" class="level2" data-number="1"><h2 data-number="1" class="anchored" data-anchor-id="assignment-task">
<span class="header-section-number">1</span> Assignment Task</h2>
<p>Refer to: <a href="https://isss626-ay2024-25aug.netlify.app/take-home_ex02">Take-home Exercise 2: Discovering impacts of COVID-19 on Thailand tourism economy at the province level using spatial and spatio-temporal statistics – ISSS626 Geospatial Analytics and Applications</a></p>
</section><section id="overview" class="level2" data-number="2"><h2 data-number="2" class="anchored" data-anchor-id="overview">
<span class="header-section-number">2</span> Overview</h2>
<p>Tourism is a major industry in Thailand, accounting for about 20% of the GDP. In 2019, the sector generated 90 billion USD, but this dropped sharply to 24 billion USD in 2020 due to the COVID-19 pandemic. Notably,tourism revenue is also unevenly distributed, with provinces like Bangkok, Phuket, and Chiang Mai dominating the sector, while others see less impact.</p>
<p>In this exercise, we will explore how COVID-19 affected Thailand’s tourism economy using spatial and spatio-temporal analysis, focusing on how the impacts varied across different provinces and examining recovery patterns.</p>
</section><section id="objectives" class="level2" data-number="3"><h2 data-number="3" class="anchored" data-anchor-id="objectives">
<span class="header-section-number">3</span> Objectives</h2>
<p>The main objectives of this exercise are:</p>
<ul>
<li>Determine if the key indicators of tourism economy of Thailand are independent from space and space and time.</li>
<li>If the tourism economy shows spatial and spatio-temporal dependence, identify clusters, outliers, and emerging hotspot/cold spot areas.</li>
</ul></section><section id="methodology" class="level2" data-number="4"><h2 data-number="4" class="anchored" data-anchor-id="methodology">
<span class="header-section-number">4</span> Methodology</h2>
<p>In this exercise, we will follow these steps:</p>
<ol type="1">
<li>
<strong>Geospatial Data Preparation</strong>: Using <code>sf</code> and <code>tidyverse</code> packages to create spatial and spatio-temporal datasets, specifically:</li>
</ol>
<ul>
<li>a province level study area layer of Bangkok in sf polygon features</li>
<li>a tourism economy indicators layer within the study area in sf polygon features.</li>
<li>a derived tourism economy indicator layer in spacetime s3 class of sfdep. The time series will be at month and year levels.</li>
</ul>
<ol start="2" type="1">
<li><p><strong>Global Spatial Autocorrelation Analysis</strong>: Using <code>sfdep</code> methods to identify spatial patterns in the tourism economy.</p></li>
<li><p><strong>Local Spatial Autocorrelation Analysis</strong>: Detecting clusters and outliers at the provincial level.</p></li>
<li><p><strong>Emerging Hotspot Analysis</strong>: Applying spatio-temporal analysis to identify trends in tourism revenue recovery or decline.</p></li>
</ol></section><section id="the-data" class="level2" data-number="5"><h2 data-number="5" class="anchored" data-anchor-id="the-data">
<span class="header-section-number">5</span> The Data</h2>
<p>We will use two primary datasets for this analysis:</p>
<table class="caption-top table">
<thead><tr class="header">
<th><strong>Dataset Name</strong></th>
<th><strong>Description</strong></th>
<th><strong>Format</strong></th>
<th><strong>Source</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Thailand Domestic Tourism Statistics</td>
<td>Monthly tourism statistics, including revenue and visitor numbers at the province level.</td>
<td>CSV</td>
<td><a href="https://www.kaggle.com/datasets/thaweewatboy/thailand-domestic-tourism-statistics">Kaggle</a></td>
</tr>
<tr class="even">
<td>Thailand - Subnational Administrative Boundaries</td>
<td>Geospatial data of provincial boundaries in Thailand.</td>
<td>ESRI Shapefile</td>
<td><a href="https://data.humdata.org/dataset/cod-ab-tha?">HDX</a></td>
</tr>
</tbody>
</table></section><section id="installing-and-launching-the-r-packages" class="level2" data-number="6"><h2 data-number="6" class="anchored" data-anchor-id="installing-and-launching-the-r-packages">
<span class="header-section-number">6</span> Installing and Launching the R Packages</h2>
<p>The following R packages will be used in this exercise:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 43%">
<col style="width: 48%">
</colgroup>
<thead><tr class="header">
<th><strong>Package</strong></th>
<th><strong>Purpose</strong></th>
<th><strong>Use Case in Exercise</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>sf</strong></td>
<td>Handles spatial data; imports, manages, and processes vector-based geospatial data.</td>
<td>Importing and managing geospatial data, such as Hunan’s county boundary shapefile.</td>
</tr>
<tr class="even">
<td><strong>sfdep</strong></td>
<td>Provides functions for spatial autocorrelation and temporal analysis, including Emerging Hot Spot Analysis (EHSA).</td>
<td>Performing spatio-temporal analysis using Gi* statistics and Mann-Kendall test.</td>
</tr>
<tr class="odd">
<td><strong>plotly</strong></td>
<td>Creates interactive plots in R.</td>
<td>Visualizing spatio-temporal trends with interactive plots.</td>
</tr>
<tr class="even">
<td><strong>tidyverse</strong></td>
<td>A collection of R packages for data science tasks like data manipulation, visualization, and modeling.</td>
<td>Wrangling aspatial data and joining it with geospatial datasets.</td>
</tr>
<tr class="odd">
<td><strong>Kendall</strong></td>
<td>Provides functions for performing the Mann-Kendall test for detecting trends in time series data.</td>
<td>Performing the Mann-Kendall test to assess the trends in Gi* statistics over time.</td>
</tr>
<tr class="even">
<td><strong>spdep</strong></td>
<td>Spatial dependence modeling and analysis tools for areal data.</td>
<td>Conducting spatial autocorrelation analysis for cluster detection using Moran’s I and other statistics.</td>
</tr>
<tr class="odd">
<td><strong>tmap</strong></td>
<td>Thematic map visualization for spatial data.</td>
<td>Creating visually appealing maps to highlight spatial patterns.</td>
</tr>
<tr class="even">
<td><strong>RColorBrewer</strong></td>
<td>Provides color palettes for enhancing visualizations.</td>
<td>Applying color schemes to maps for better data interpretation.</td>
</tr>
<tr class="odd">
<td><strong>DT</strong></td>
<td>Creates interactive tables.</td>
<td>Displaying summary statistics in an interactive format for easy data exploration.</td>
</tr>
<tr class="even">
<td><strong>ggplot2</strong></td>
<td>A versatile package for static data visualization.</td>
<td>Plotting spatial and aspatial data relationships, such as scatter plots and density maps.</td>
</tr>
<tr class="odd">
<td><strong>corrplot</strong></td>
<td>Visualizes correlation matrices.</td>
<td>Displaying the relationships between different spatial features and their correlations.</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">tidyverse</span>, <span class="va">sf</span>, <span class="va">spdep</span>, <span class="va">sfdep</span>, <span class="va">tmap</span>, <span class="va">knitr</span>, <span class="va">DT</span>, <span class="va">ggplot2</span>, <span class="va">plotly</span>, <span class="va">RColorBrewer</span>, <span class="va">corrplot</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="reproducibility" class="level3" data-number="6.1"><h3 data-number="6.1" class="anchored" data-anchor-id="reproducibility">
<span class="header-section-number">6.1</span> Reproducibility</h3>
<p>For reproducible results of this exercise, we will use seed value, <code>1234</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="import-data" class="level2" data-number="7"><h2 data-number="7" class="anchored" data-anchor-id="import-data">
<span class="header-section-number">7</span> Import Data</h2>
<p>In this section, we will perform sanity checks on the raw data obtained from official sources.</p>
<section id="import-geospatial-data" class="level3" data-number="7.1"><h3 data-number="7.1" class="anchored" data-anchor-id="import-geospatial-data">
<span class="header-section-number">7.1</span> Import Geospatial Data</h3>
<blockquote class="blockquote">
<p>Firstly, we import the spatial dataset of <strong>administrative level 1 boundaries</strong> for province-level analysis in Thailand. This forms the study area layer in <strong>sf polygon features</strong> and uses the <strong>UTM Zone 47N (EPSG:32647)</strong> CRS.</p>
</blockquote>
<p>We will rename <code>ADM1_EN</code> column to be consistent with the aspatial dataset later on.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">admin_boundary</span> <span class="op">&lt;-</span> <span class="fu">st_read</span><span class="op">(</span>dsn <span class="op">=</span> <span class="st">"data/raw_data/"</span>, </span>
<span>                      layer <span class="op">=</span> <span class="st">"tha_admbnda_adm1_rtsd_20220121"</span>,</span>
<span>                      crs<span class="op">=</span><span class="fl">32647</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `tha_admbnda_adm1_rtsd_20220121' from data source 
  `/Users/walter/code/isss626/isss626-gaa/Take-home_Ex/Take-home_Ex02/data/raw_data' 
  using driver `ESRI Shapefile'
Simple feature collection with 77 features and 16 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507
Projected CRS: WGS 84 / UTM zone 47N</code></pre>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">admin_boundary</span> <span class="op">&lt;-</span> <span class="va">admin_boundary</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">rename</span><span class="op">(</span>province_eng <span class="op">=</span> <span class="va">ADM1_EN</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">glimpse</span><span class="op">(</span><span class="va">admin_boundary</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 77
Columns: 17
$ Shape_Leng   &lt;dbl&gt; 2.417227, 1.695100, 1.251111, 1.884945, 3.041716, 1.73990…
$ Shape_Area   &lt;dbl&gt; 0.13133873, 0.07926199, 0.05323766, 0.12698345, 0.2139379…
$ province_eng &lt;chr&gt; "Bangkok", "Samut Prakan", "Nonthaburi", "Pathum Thani", …
$ ADM1_TH      &lt;chr&gt; "กรุงเทพมหานคร", "สมุทรปราการ", "นนทบุรี", "ปทุมธานี", "พระนครศ…
$ ADM1_PCODE   &lt;chr&gt; "TH10", "TH11", "TH12", "TH13", "TH14", "TH15", "TH16", "…
$ ADM1_REF     &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ ADM1ALT1EN   &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ ADM1ALT2EN   &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ ADM1ALT1TH   &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ ADM1ALT2TH   &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ ADM0_EN      &lt;chr&gt; "Thailand", "Thailand", "Thailand", "Thailand", "Thailand…
$ ADM0_TH      &lt;chr&gt; "ประเทศไทย", "ประเทศไทย", "ประเทศไทย", "ประเทศไทย", "ประเ…
$ ADM0_PCODE   &lt;chr&gt; "TH", "TH", "TH", "TH", "TH", "TH", "TH", "TH", "TH", "TH…
$ date         &lt;date&gt; 2019-02-18, 2019-02-18, 2019-02-18, 2019-02-18, 2019-02-…
$ validOn      &lt;date&gt; 2022-01-22, 2022-01-22, 2022-01-22, 2022-01-22, 2022-01-…
$ validTo      &lt;date&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
$ geometry     &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((100.6139 13..., MULTIPOLYGON…</code></pre>
</div>
</div>
</section><section id="import-aspatial-data" class="level3" data-number="7.2"><h3 data-number="7.2" class="anchored" data-anchor-id="import-aspatial-data">
<span class="header-section-number">7.2</span> Import Aspatial Data</h3>
<p>We import and examine the aspatial tourism dataset:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tourism_df</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/raw_data/thailand_domestic_tourism_2019_2023_ver2.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tourism_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30,800 × 7
   date       province_thai province_eng   region_thai region_eng variable value
   &lt;date&gt;     &lt;chr&gt;         &lt;chr&gt;          &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;
 1 2019-01-01 กรุงเทพมหานคร  Bangkok        ภาคกลาง     central    ratio_t…  93.4
 2 2019-01-01 ลพบุรี          Lopburi        ภาคกลาง     central    ratio_t…  61.3
 3 2019-01-01 พระนครศรีอยุธยา Phra Nakhon S… ภาคกลาง     central    ratio_t…  73.4
 4 2019-01-01 สระบุรี         Saraburi       ภาคกลาง     central    ratio_t…  67.3
 5 2019-01-01 ชัยนาท         Chainat        ภาคกลาง     central    ratio_t…  79.3
 6 2019-01-01 นครปฐม        Nakhon Pathom  ภาคกลาง     central    ratio_t…  71.7
 7 2019-01-01 สิงห์บุรี         Sing Buri      ภาคกลาง     central    ratio_t…  64.6
 8 2019-01-01 อ่างทอง        Ang Thong      ภาคกลาง     central    ratio_t…  71.2
 9 2019-01-01 นนทบุรี         Nonthaburi     ภาคกลาง     central    ratio_t…  75.1
10 2019-01-01 ปทุมธานี        Pathum Thani   ภาคกลาง     central    ratio_t…  60.8
# ℹ 30,790 more rows</code></pre>
</div>
</div>
<p>From the output above, we can observe that <strong>there are 7 columns in this dataset and there are 30,800 records in this dataset</strong>.</p>
<p>Next, we check for missing data in the dataset:</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">null_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">tourism_df</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">null_counts</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         date province_thai  province_eng   region_thai    region_eng 
            0             0             0             0             0 
     variable         value 
            0             0 </code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Column <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">null_counts</span><span class="op">)</span>, Null_Count <span class="op">=</span> <span class="va">null_counts</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     Column Null_Count
date                   date          0
province_thai province_thai          0
province_eng   province_eng          0
region_thai     region_thai          0
region_eng       region_eng          0
variable           variable          0
value                 value          0</code></pre>
</div>
</div>
<p>From the output above, there are no missing values in the dataset.</p>
<p>Next, we check for duplicate values.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">duplicate_count</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span><span class="op">(</span><span class="va">tourism_df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">duplicate_count</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>There are no exact duplicates in this dataset.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">glimpse</span><span class="op">(</span><span class="va">tourism_df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 30,800
Columns: 7
$ date          &lt;date&gt; 2019-01-01, 2019-01-01, 2019-01-01, 2019-01-01, 2019-01…
$ province_thai &lt;chr&gt; "กรุงเทพมหานคร", "ลพบุรี", "พระนครศรีอยุธยา", "สระบุรี", "ชัยนาท…
$ province_eng  &lt;chr&gt; "Bangkok", "Lopburi", "Phra Nakhon Si Ayutthaya", "Sarab…
$ region_thai   &lt;chr&gt; "ภาคกลาง", "ภาคกลาง", "ภาคกลาง", "ภาคกลาง", "ภาคกลาง", "…
$ region_eng    &lt;chr&gt; "central", "central", "central", "central", "central", "…
$ variable      &lt;chr&gt; "ratio_tourist_stay", "ratio_tourist_stay", "ratio_touri…
$ value         &lt;dbl&gt; 93.37, 61.32, 73.37, 67.33, 79.31, 71.70, 64.65, 71.21, …</code></pre>
</div>
</div>
</section></section><section id="data-wrangling" class="level2" data-number="8"><h2 data-number="8" class="anchored" data-anchor-id="data-wrangling">
<span class="header-section-number">8</span> Data Wrangling</h2>
<p>In this section, we will perform some data cleaning, feature engineering and finally combine the two data sets for spatial and spatial-temporal analysis later on.</p>
<section id="data-cleaning" class="level3" data-number="8.1"><h3 data-number="8.1" class="anchored" data-anchor-id="data-cleaning">
<span class="header-section-number">8.1</span> Data Cleaning</h3>
<p>Based on the discussions in the <a href="https://www.kaggle.com/datasets/thaweewatboy/thailand-domestic-tourism-statistics/discussion/440540">Kaggle forum</a>, there may be some mislabeled data and the provided data dictionary may not match this version (ver. 2) of the dataset.</p>
<p>In essence, we will address these issues in this section step by step:</p>
<ol type="1">
<li>Drop unused columns in Thai.</li>
<li>Simplify the region name <code>"east_northeast"</code> to <code>"northeast"</code>.</li>
<li>Correct the region name for Sisaket.</li>
<li>Create a “bmr” region to further differentiate the Bangkok Metropolitan Region for more fine-grained analysis later on.</li>
<li>Create a <code>time_period</code> to indicate pre-covid, covid, post-covid periods.</li>
<li>Factorize <code>date</code> into months and years</li>
<li>Create a <code>date_int</code> to facilitate space-time cube creation</li>
<li>Pivot the dataset to a wider format for analysis.</li>
<li>Check for discrepancies in region names as we will join both dataset with this field.</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Recap on the Covid-19 Pandemic Timeline for Thailand
</div>
</div>
<div class="callout-body-container callout-body">
<p>To better understand the impact of the pandemic on Thailand’s tourism industry, it’s essential to distinguish the key phases of the pandemic: <strong>pre-covid, covid and post-covid phases</strong>.</p>
<table class="caption-top table">
<thead><tr class="header">
<th>Event</th>
<th>Date(s)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>First COVID-19 Case in Thailand</td>
<td>January 13, 2020</td>
</tr>
<tr class="even">
<td>Start of Foreign Travel Ban</td>
<td>April 06, 2020</td>
</tr>
<tr class="odd">
<td>Nationwide Lockdown Begins</td>
<td>March 26, 2020</td>
</tr>
<tr class="even">
<td>Emergency Decree Enforced</td>
<td>March 26, 2020</td>
</tr>
<tr class="odd">
<td>Lockdown Lifted</td>
<td>August 31, 2021</td>
</tr>
<tr class="even">
<td>Final Foreign Travel Ban Lifted</td>
<td>November 1, 2021</td>
</tr>
<tr class="odd">
<td>End of Emergency Decree</td>
<td>September 30, 2022</td>
</tr>
</tbody>
</table>
<p>From this, we can define pandemic period as <strong>Jan 2020 to September 2022</strong>.</p>
<p><strong>Sources:</strong></p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Timeline_of_the_COVID-19_pandemic_in_Thailand">Timeline of the COVID-19 pandemic in Thailand - Wikipedia</a></li>
<li><a href="https://travelbans.org/en/asia/thailand/full-restrictions">Thailand - Full Restrictions, Travel regulations, Coronavirus regulations, travel bans - Travelbans</a></li>
<li><a href="https://www.tatnews.org/2022/09/thailand-ends-covid-19-emergency-decree-on-30-september-2022/">Thailand ends COVID-19 Emergency Decree on 30 September 2022 - TAT Newsroom</a></li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># remove th columns</span></span>
<span><span class="va">tourism_df</span> <span class="op">&lt;-</span> <span class="va">tourism_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">province_thai</span>, <span class="op">-</span><span class="va">region_thai</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># examine unique values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">tourism_df</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">value</span><span class="op">)</span>, <span class="va">unique</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$date
 [1] "2019-01-01" "2020-01-01" "2021-01-01" "2022-01-01" "2023-01-01"
 [6] "2019-02-01" "2020-02-01" "2021-02-01" "2022-02-01" "2023-02-01"
[11] "2019-03-01" "2020-03-01" "2021-03-01" "2022-03-01" "2019-04-01"
[16] "2020-04-01" "2021-04-01" "2022-04-01" "2019-05-01" "2020-05-01"
[21] "2021-05-01" "2022-05-01" "2019-06-01" "2020-06-01" "2021-06-01"
[26] "2022-06-01" "2019-07-01" "2020-07-01" "2021-07-01" "2022-07-01"
[31] "2019-08-01" "2020-08-01" "2021-08-01" "2022-08-01" "2019-09-01"
[36] "2020-09-01" "2021-09-01" "2022-09-01" "2019-10-01" "2020-10-01"
[41] "2021-10-01" "2022-10-01" "2019-11-01" "2020-11-01" "2021-11-01"
[46] "2022-11-01" "2019-12-01" "2020-12-01" "2021-12-01" "2022-12-01"

$province_eng
 [1] "Bangkok"                  "Lopburi"                 
 [3] "Phra Nakhon Si Ayutthaya" "Saraburi"                
 [5] "Chainat"                  "Nakhon Pathom"           
 [7] "Sing Buri"                "Ang Thong"               
 [9] "Nonthaburi"               "Pathum Thani"            
[11] "Samut Prakan"             "Samut Sakhon"            
[13] "Chachoengsao"             "Ratchaburi"              
[15] "Kanchanaburi"             "Samut Songkhram"         
[17] "Suphan Buri"              "Phetchaburi"             
[19] "Prachuap Khiri Khan"      "Chonburi"                
[21] "Chanthaburi"              "Trat"                    
[23] "Nakhon Nayok"             "Prachinburi"             
[25] "Rayong"                   "Sa Kaeo"                 
[27] "Phuket"                   "Phatthalung"             
[29] "Trang"                    "Ranong"                  
[31] "Chumphon"                 "Pattani"                 
[33] "Yala"                     "Nakhon Si Thammarat"     
[35] "Narathiwat"               "Krabi"                   
[37] "Songkhla"                 "Phang Nga"               
[39] "Surat Thani"              "Satun"                   
[41] "Kamphaeng Phet"           "Chiang Rai"              
[43] "Chiang Mai"               "Phichit"                 
[45] "Nakhon Sawan"             "Tak"                     
[47] "Phitsanulok"              "Phayao"                  
[49] "Phetchabun"               "Phrae"                   
[51] "Lampang"                  "Lamphun"                 
[53] "Mae Hong Son"             "Uttaradit"               
[55] "Uthai Thani"              "Sukhothai"               
[57] "Nan"                      "Kalasin"                 
[59] "Khon Kaen"                "Chaiyaphum"              
[61] "Nakhon Phanom"            "Nakhon Ratchasima"       
[63] "Buriram"                  "Maha Sarakham"           
[65] "Mukdahan"                 "Roi Et"                  
[67] "Loei"                     "Sisaket"                 
[69] "Surin"                    "Nong Khai"               
[71] "Bueng Kan"                "Udon Thani"              
[73] "Ubon Ratchathani"         "Sakon Nakhon"            
[75] "Yasothon"                 "Amnat Charoen"           
[77] "Nong Bua Lamphu"         

$region_eng
[1] "central"        "east"           "south"          "north"         
[5] "east_northeast"

$variable
[1] "ratio_tourist_stay" "no_tourist_stay"    "no_tourist_all"    
[4] "no_tourist_thai"    "no_tourist_foreign" "revenue_all"       
[7] "revenue_thai"       "revenue_foreign"   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># examine sisaket's region</span></span>
<span><span class="va">check_sisaket</span> <span class="op">&lt;-</span> <span class="va">tourism_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">province_eng</span> <span class="op">==</span> <span class="st">"Sisaket"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">province_eng</span>, <span class="va">region_eng</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">check_sisaket</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  province_eng region_eng
  &lt;chr&gt;        &lt;chr&gt;     
1 Sisaket      south     
2 Sisaket      south     
3 Sisaket      south     
4 Sisaket      south     
5 Sisaket      south     </code></pre>
</div>
</div>
<p>From the check, we notice Sisaket is indeed incorrectly labeled.</p>
<p>We then correct region names and assign provinces in the Bangkok Metropolitan Region to <code>"bmr"</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bmr_list</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bangkok"</span>, <span class="st">"Nonthaburi"</span>, <span class="st">"Nakhon Pathom"</span>, <span class="st">"Pathum Thani"</span>, </span>
<span>           <span class="st">"Samut Prakan"</span>, <span class="st">"Samut Sakhon"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tourism_df_cleaned</span> <span class="op">&lt;-</span> <span class="va">tourism_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    <span class="co"># Rename the "east_northeast" region to "northeast"</span></span>
<span>    region_eng <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">region_eng</span> <span class="op">==</span> <span class="st">"east_northeast"</span>, <span class="st">"northeast"</span>, <span class="va">region_eng</span><span class="op">)</span>,</span>
<span>    <span class="co"># Correct the region for Sisaket</span></span>
<span>    region_eng <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">province_eng</span> <span class="op">==</span> <span class="st">"Sisaket"</span>, <span class="st">"northeast"</span>, <span class="va">region_eng</span><span class="op">)</span>,</span>
<span>    <span class="co"># Set the region to "bmr" for provinces in the metro list</span></span>
<span>    region_eng <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">province_eng</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">bmr_list</span>, <span class="st">"bmr"</span>, <span class="va">region_eng</span><span class="op">)</span>,</span>
<span>    <span class="co"># Create covid period column</span></span>
<span>    time_period <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>      <span class="va">date</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-01-01"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"pre-covid"</span>,</span>
<span>      <span class="va">date</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-01-01"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">date</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2022-10-01"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"covid"</span>,</span>
<span>      <span class="va">date</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2022-10-01"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"post-covid"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># Extract month number (1 = January, 12 = December)</span></span>
<span>    month_number <span class="op">=</span> <span class="fu">month</span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>    <span class="co"># Extract month as factor ("Jan", "Feb")</span></span>
<span>    month_factor <span class="op">=</span> <span class="fu">month</span><span class="op">(</span><span class="va">date</span>, label <span class="op">=</span> <span class="cn">TRUE</span>, abbr <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="co"># Extract year</span></span>
<span>    year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>    <span class="co"># Make single date column for spacetimecube</span></span>
<span>    date_int <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">date</span>, <span class="st">"%Y%m"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># Drop date column</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">date</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We check for unmatched region names between the spatial and aspatial datasets:</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Find and see all unmatched values between admin_boundary and tourism_df</span></span>
<span><span class="va">unmatched_region_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html">union</a></span><span class="op">(</span></span>
<span>  <span class="fu">anti_join</span><span class="op">(</span><span class="va">admin_boundary</span>, <span class="va">tourism_df_cleaned</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"province_eng"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">province_eng</span><span class="op">)</span>,</span>
<span>  <span class="fu">anti_join</span><span class="op">(</span><span class="va">tourism_df_cleaned</span>, <span class="va">admin_boundary</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"province_eng"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">province_eng</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">unmatched_region_names</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Buri Ram"         "Buriram"          "Chai Nat"         "Chainat"         
 [5] "Chon Buri"        "Chonburi"         "Lop Buri"         "Lopburi"         
 [9] "Nong Bua Lam Phu" "Nong Bua Lamphu"  "Phang Nga"        "Phangnga"        
[13] "Prachin Buri"     "Prachinburi"      "Si Sa Ket"        "Sisaket"         </code></pre>
</div>
</div>
<p>We notice some discrepancies, such as inconsistent spacing in names (e.g., <code>"Buri Ram"</code> vs.&nbsp;<code>"Buriram"</code>).</p>
<p>We also pivot the dataset and correct the inconsistent province names:</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tourism_df_pivot</span> <span class="op">&lt;-</span> <span class="va">tourism_df_cleaned</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">"variable"</span>, values_from <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>province_eng <span class="op">=</span> <span class="fu">recode</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/trimws.html">trimws</a></span><span class="op">(</span><span class="va">province_eng</span><span class="op">)</span>,</span>
<span>                               <span class="st">"Buriram"</span> <span class="op">=</span> <span class="st">"Buri Ram"</span>,</span>
<span>                               <span class="st">"Chainat"</span> <span class="op">=</span> <span class="st">"Chai Nat"</span>,</span>
<span>                               <span class="st">"Chonburi"</span> <span class="op">=</span> <span class="st">"Chon Buri"</span>,</span>
<span>                               <span class="st">"Lopburi"</span> <span class="op">=</span> <span class="st">"Lop Buri"</span>,</span>
<span>                               <span class="st">"Nong Bua Lamphu"</span> <span class="op">=</span> <span class="st">"Nong Bua Lam Phu"</span>,</span>
<span>                               <span class="st">"Phang Nga"</span> <span class="op">=</span> <span class="st">"Phangnga"</span>,</span>
<span>                               <span class="st">"Prachinburi"</span> <span class="op">=</span> <span class="st">"Prachin Buri"</span>,</span>
<span>                               <span class="st">"Sisaket"</span> <span class="op">=</span> <span class="st">"Si Sa Ket"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">tourism_df_pivot</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> province_eng        region_eng        time_period         month_number 
 Length:3850        Length:3850        Length:3850        Min.   : 1.0  
 Class :character   Class :character   Class :character   1st Qu.: 3.0  
 Mode  :character   Mode  :character   Mode  :character   Median : 6.0  
                                                          Mean   : 6.3  
                                                          3rd Qu.: 9.0  
                                                          Max.   :12.0  
                                                                        
  month_factor       year         date_int      ratio_tourist_stay
 Jan    : 385   Min.   :2019   Min.   :201901   Min.   : 0.00     
 Feb    : 385   1st Qu.:2020   1st Qu.:202001   1st Qu.:20.18     
 Mar    : 308   Median :2021   Median :202102   Median :41.81     
 Apr    : 308   Mean   :2021   Mean   :202066   Mean   :38.93     
 May    : 308   3rd Qu.:2022   3rd Qu.:202202   3rd Qu.:56.20     
 Jun    : 308   Max.   :2023   Max.   :202302   Max.   :95.86     
 (Other):1848                                                     
 no_tourist_stay   no_tourist_all    no_tourist_thai   no_tourist_foreign 
 Min.   :      0   Min.   :      0   Min.   :      0   Min.   :      0.0  
 1st Qu.:  16271   1st Qu.:  39092   1st Qu.:  37169   1st Qu.:     49.2  
 Median :  44579   Median :  92122   Median :  88782   Median :    553.0  
 Mean   : 105161   Mean   : 206328   Mean   : 173962   Mean   :  32366.1  
 3rd Qu.:  90902   3rd Qu.: 203646   3rd Qu.: 184256   3rd Qu.:   5189.5  
 Max.   :3335728   Max.   :6131044   Max.   :4087756   Max.   :2473725.0  
                                                                          
  revenue_all         revenue_thai       revenue_foreign     
 Min.   :0.000e+00   Min.   :0.000e+00   Min.   :-4.250e+03  
 1st Qu.:6.332e+07   1st Qu.:5.925e+07   1st Qu.: 1.100e+05  
 Median :1.955e+08   Median :1.773e+08   Median : 1.540e+06  
 Mean   :1.344e+09   Mean   :6.636e+08   Mean   : 6.802e+08  
 3rd Qu.:5.060e+08   3rd Qu.:4.600e+08   3rd Qu.: 1.742e+07  
 Max.   :1.103e+11   Max.   :4.506e+10   Max.   : 8.503e+10  
                                                             </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>From the outdated data dictionary in Kaggle and Piazza discussions, we can infer that this should be the intended data dictionary for dataset v2.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 77%">
</colgroup>
<thead><tr class="header">
<th>Variable</th>
<th>Definition</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>no_tourist_all</td>
<td>Total number of tourists who visited the province</td>
</tr>
<tr class="even">
<td>no_tourist_foreign</td>
<td>Number of Foreign tourists who visited the province</td>
</tr>
<tr class="odd">
<td>no_tourist_thai</td>
<td>Number of Thai tourists who visited the province</td>
</tr>
<tr class="even">
<td>no_tourist_stay</td>
<td>Number of Tourists who stayed overnight in the province**</td>
</tr>
<tr class="odd">
<td>ratio_tourist_stay</td>
<td>Ratio of Tourists who stayed overnight**</td>
</tr>
<tr class="even">
<td>revenue_all</td>
<td>Revenue generated by all tourists in the province (Thai Baht)</td>
</tr>
<tr class="odd">
<td>revenue_foreign</td>
<td>Revenue generated by Foreign tourists in the province (Thai Baht)</td>
</tr>
<tr class="even">
<td>revenue_thai</td>
<td>Revenue generated by Thai tourists in the province (Thai Baht)</td>
</tr>
</tbody>
</table>
<p>From this, we can notice that are several imposible values such as foreign revenue from the summary output above.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">negative_revenue</span> <span class="op">&lt;-</span> <span class="va">tourism_df_pivot</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">revenue_foreign</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">datatable</span><span class="op">(</span><span class="va">negative_revenue</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-1b4ff99564eb6e8884a5" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1b4ff99564eb6e8884a5">{"x":{"filter":"none","vertical":false,"data":[["1","2"],["Nakhon Pathom","Nakhon Pathom"],["bmr","bmr"],["covid","covid"],[7,8],["Jul","Aug"],[2021,2021],[202107,202108],[1.15,0.76],[1281,859],[4047,2714],[4047,2714],[0,0],[4015750,2625750],[4020000,2630000],[-4250,-4250]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>province_eng<\/th>\n      <th>region_eng<\/th>\n      <th>time_period<\/th>\n      <th>month_number<\/th>\n      <th>month_factor<\/th>\n      <th>year<\/th>\n      <th>date_int<\/th>\n      <th>ratio_tourist_stay<\/th>\n      <th>no_tourist_stay<\/th>\n      <th>no_tourist_all<\/th>\n      <th>no_tourist_thai<\/th>\n      <th>no_tourist_foreign<\/th>\n      <th>revenue_all<\/th>\n      <th>revenue_thai<\/th>\n      <th>revenue_foreign<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,6,7,8,9,10,11,12,13,14,15]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"province_eng","targets":1},{"name":"region_eng","targets":2},{"name":"time_period","targets":3},{"name":"month_number","targets":4},{"name":"month_factor","targets":5},{"name":"year","targets":6},{"name":"date_int","targets":7},{"name":"ratio_tourist_stay","targets":8},{"name":"no_tourist_stay","targets":9},{"name":"no_tourist_all","targets":10},{"name":"no_tourist_thai","targets":11},{"name":"no_tourist_foreign","targets":12},{"name":"revenue_all","targets":13},{"name":"revenue_thai","targets":14},{"name":"revenue_foreign","targets":15}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># check_revenue_computation&lt;- tourism_df_pivot %&gt;%</span></span>
<span><span class="co">#  filter(revenue_all != (revenue_foreign+ revenue_thai))</span></span>
<span></span>
<span><span class="co"># datatable(check_revenue_computation)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We noticed that <code>revenue_all</code> is indeed sum of <code>revenue_thai</code> and <code>revenue_foreign</code>. However, when <code>revenue_thai</code> is higher than <code>revenue_all</code>, the data records negative values for <code>revenue_foreign</code> to balance the equation. This is likely due to data entry error. Thus, we will take the conservative approach and cap <code>revenue_thai</code> at <code>revenue_all</code> if it exceeds the total, and set <code>revenue_foreign</code> to 0 if negative:</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tourism_df_pivot</span> <span class="op">&lt;-</span> <span class="va">tourism_df_pivot</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    <span class="co"># Cap revenue_thai to revenue_all if revenue_thai is greater</span></span>
<span>    revenue_thai <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">revenue_thai</span> <span class="op">&gt;</span> <span class="va">revenue_all</span>, <span class="va">revenue_all</span>, <span class="va">revenue_thai</span><span class="op">)</span>,</span>
<span>    </span>
<span>    <span class="co"># Set revenue_foreign to 0 if it's negative</span></span>
<span>    revenue_foreign <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">revenue_foreign</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">revenue_foreign</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Similarly, we also ensure that <code>no_tourist_stay</code> does not exceed <code>no_tourist_all</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#check_tourist_stay &lt;- tourism_df_pivot %&gt;%</span></span>
<span><span class="co">#  filter(no_tourist_stay != no_tourist_all)</span></span>
<span><span class="co">#check_tourist_stay &lt;- tourism_df_pivot %&gt;%</span></span>
<span><span class="co">#  filter(no_tourist_stay &lt;= no_tourist_all)</span></span>
<span></span>
<span><span class="va">check_tourist_stay</span> <span class="op">&lt;-</span> <span class="va">tourism_df_pivot</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">no_tourist_stay</span> <span class="op">&gt;</span> <span class="va">no_tourist_all</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">datatable</span><span class="op">(</span><span class="va">check_tourist_stay</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-8f836166d559454ecd73" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8f836166d559454ecd73">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6"],["Trat","Chiang Mai","Chon Buri","Yala","Chanthaburi","Samut Sakhon"],["east","north","east","south","east","bmr"],["covid","covid","covid","covid","covid","covid"],[3,5,6,8,8,12],["Mar","May","Jun","Aug","Aug","Dec"],[2020,2020,2020,2020,2021,2020],[202003,202005,202006,202008,202108,202012],[25.13,1.73,23.67,18.63,10.81,6.76],[77163,16125,295090,20592,18148,8509],[72217,12212,211505,13742,17881,5132],[51632,11629,194406,13742,17815,5071],[20585,583,17099,0,66,61],[589320000,98880000,1291300000,42860000,49440000,8960000],[289690000,83390000,895640000,42860000,49290000,8880000],[299630000,15490000,395660000,0,150000,80000]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>province_eng<\/th>\n      <th>region_eng<\/th>\n      <th>time_period<\/th>\n      <th>month_number<\/th>\n      <th>month_factor<\/th>\n      <th>year<\/th>\n      <th>date_int<\/th>\n      <th>ratio_tourist_stay<\/th>\n      <th>no_tourist_stay<\/th>\n      <th>no_tourist_all<\/th>\n      <th>no_tourist_thai<\/th>\n      <th>no_tourist_foreign<\/th>\n      <th>revenue_all<\/th>\n      <th>revenue_thai<\/th>\n      <th>revenue_foreign<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,6,7,8,9,10,11,12,13,14,15]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"province_eng","targets":1},{"name":"region_eng","targets":2},{"name":"time_period","targets":3},{"name":"month_number","targets":4},{"name":"month_factor","targets":5},{"name":"year","targets":6},{"name":"date_int","targets":7},{"name":"ratio_tourist_stay","targets":8},{"name":"no_tourist_stay","targets":9},{"name":"no_tourist_all","targets":10},{"name":"no_tourist_thai","targets":11},{"name":"no_tourist_foreign","targets":12},{"name":"revenue_all","targets":13},{"name":"revenue_thai","targets":14},{"name":"revenue_foreign","targets":15}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Finally, we executed the remaining steps mentioned earlier in this section.</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tourism_df_pivot</span> <span class="op">&lt;-</span> <span class="va">tourism_df_pivot</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    <span class="co"># Cap revenue_thai to revenue_all if revenue_thai is greater</span></span>
<span>    revenue_thai <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">revenue_thai</span> <span class="op">&gt;</span> <span class="va">revenue_all</span>, <span class="va">revenue_all</span>, <span class="va">revenue_thai</span><span class="op">)</span>,</span>
<span>    <span class="co"># Set revenue_foreign to 0 if it's negative</span></span>
<span>    revenue_foreign <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">revenue_foreign</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">revenue_foreign</span><span class="op">)</span>,</span>
<span>    <span class="co"># Cap no_tourist_stay to no_tourist_all if no_tourist_stay is greater</span></span>
<span>    no_tourist_stay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">no_tourist_stay</span> <span class="op">&gt;</span> <span class="va">no_tourist_all</span>, <span class="va">no_tourist_all</span>, <span class="va">no_tourist_stay</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">tourism_df_pivot</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> province_eng        region_eng        time_period         month_number 
 Length:3850        Length:3850        Length:3850        Min.   : 1.0  
 Class :character   Class :character   Class :character   1st Qu.: 3.0  
 Mode  :character   Mode  :character   Mode  :character   Median : 6.0  
                                                          Mean   : 6.3  
                                                          3rd Qu.: 9.0  
                                                          Max.   :12.0  
                                                                        
  month_factor       year         date_int      ratio_tourist_stay
 Jan    : 385   Min.   :2019   Min.   :201901   Min.   : 0.00     
 Feb    : 385   1st Qu.:2020   1st Qu.:202001   1st Qu.:20.18     
 Mar    : 308   Median :2021   Median :202102   Median :41.81     
 Apr    : 308   Mean   :2021   Mean   :202066   Mean   :38.93     
 May    : 308   3rd Qu.:2022   3rd Qu.:202202   3rd Qu.:56.20     
 Jun    : 308   Max.   :2023   Max.   :202302   Max.   :95.86     
 (Other):1848                                                     
 no_tourist_stay   no_tourist_all    no_tourist_thai   no_tourist_foreign 
 Min.   :      0   Min.   :      0   Min.   :      0   Min.   :      0.0  
 1st Qu.:  16259   1st Qu.:  39092   1st Qu.:  37169   1st Qu.:     49.2  
 Median :  44579   Median :  92122   Median :  88782   Median :    553.0  
 Mean   : 105134   Mean   : 206328   Mean   : 173962   Mean   :  32366.1  
 3rd Qu.:  90902   3rd Qu.: 203646   3rd Qu.: 184256   3rd Qu.:   5189.5  
 Max.   :3335728   Max.   :6131044   Max.   :4087756   Max.   :2473725.0  
                                                                          
  revenue_all         revenue_thai       revenue_foreign    
 Min.   :0.000e+00   Min.   :0.000e+00   Min.   :0.000e+00  
 1st Qu.:6.332e+07   1st Qu.:5.925e+07   1st Qu.:1.100e+05  
 Median :1.955e+08   Median :1.773e+08   Median :1.540e+06  
 Mean   :1.344e+09   Mean   :6.636e+08   Mean   :6.802e+08  
 3rd Qu.:5.060e+08   3rd Qu.:4.600e+08   3rd Qu.:1.742e+07  
 Max.   :1.103e+11   Max.   :4.506e+10   Max.   :8.503e+10  
                                                            </code></pre>
</div>
</div>
</section><section id="feature-engineering" class="level3" data-number="8.2"><h3 data-number="8.2" class="anchored" data-anchor-id="feature-engineering">
<span class="header-section-number">8.2</span> Feature Engineering</h3>
<p>From the data dictionary above, we observe that some are related. For example, <code>revenue_all</code> is the sum of <code>revenue_foreign</code> and <code>revenue_thai</code>.</p>
<p>Let’s create some additional features to aid our analysis:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 18%">
<col style="width: 30%">
<col style="width: 51%">
</colgroup>
<thead><tr class="header">
<th>Variable</th>
<th>Formula</th>
<th>Definition</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>ratio_tourist_foreign</code></td>
<td><code>no_tourist_foreign / no_tourist_all</code></td>
<td>Ratio of foreign tourists to total tourists</td>
</tr>
<tr class="even">
<td><code>ratio_tourist_thai</code></td>
<td><code>no_tourist_thai / no_tourist_all</code></td>
<td>Ratio of Thai tourists to total tourists</td>
</tr>
<tr class="odd">
<td><code>ratio_revenue_foreign</code></td>
<td><code>revenue_foreign / revenue_all</code></td>
<td>Ratio of revenue generated by foreign tourists to total revenue</td>
</tr>
<tr class="even">
<td><code>ratio_revenue_thai</code></td>
<td><code>revenue_thai / revenue_all</code></td>
<td>Ratio of revenue generated by Thai tourists to total revenue</td>
</tr>
<tr class="odd">
<td><code>avg_revenue_all</code></td>
<td><code>revenue_all / no_tourist_all</code></td>
<td>Average revenue generated per tourist (both Thai and foreign)</td>
</tr>
<tr class="even">
<td><code>avg_revenue_foreign</code></td>
<td><code>revenue_foreign / no_tourist_foreign</code></td>
<td>Average revenue generated per foreign tourist</td>
</tr>
<tr class="odd">
<td><code>avg_revenue_thai</code></td>
<td><code>revenue_thai / no_tourist_thai</code></td>
<td>Average revenue generated per Thai tourist</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tourism_df_ft</span> <span class="op">&lt;-</span> <span class="va">tourism_df_pivot</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    <span class="co"># ratio tourist</span></span>
<span>    ratio_tourist_foreign <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">no_tourist_all</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">no_tourist_foreign</span> <span class="op">/</span> <span class="va">no_tourist_all</span><span class="op">)</span>,    </span>
<span>    ratio_tourist_thai <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">no_tourist_all</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">no_tourist_thai</span> <span class="op">/</span> <span class="va">no_tourist_all</span><span class="op">)</span>,</span>
<span></span>
<span>    <span class="co"># ratio revenue</span></span>
<span>    ratio_revenue_thai <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">revenue_all</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">revenue_thai</span> <span class="op">/</span> <span class="va">revenue_all</span><span class="op">)</span>,</span>
<span>    ratio_revenue_foreign <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">revenue_all</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">revenue_foreign</span> <span class="op">/</span> <span class="va">revenue_all</span><span class="op">)</span>,</span>
<span>    </span>
<span>    <span class="co"># average revenue per tourist</span></span>
<span>    avg_revenue_all <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">no_tourist_all</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">revenue_all</span> <span class="op">/</span> <span class="va">no_tourist_all</span><span class="op">)</span>,</span>
<span>    avg_revenue_thai <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">no_tourist_thai</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">revenue_thai</span> <span class="op">/</span> <span class="va">no_tourist_thai</span><span class="op">)</span>,</span>
<span>    avg_revenue_foreign <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">no_tourist_foreign</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">revenue_foreign</span> <span class="op">/</span> <span class="va">no_tourist_foreign</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">tourism_df_ft</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> province_eng        region_eng        time_period         month_number 
 Length:3850        Length:3850        Length:3850        Min.   : 1.0  
 Class :character   Class :character   Class :character   1st Qu.: 3.0  
 Mode  :character   Mode  :character   Mode  :character   Median : 6.0  
                                                          Mean   : 6.3  
                                                          3rd Qu.: 9.0  
                                                          Max.   :12.0  
                                                                        
  month_factor       year         date_int      ratio_tourist_stay
 Jan    : 385   Min.   :2019   Min.   :201901   Min.   : 0.00     
 Feb    : 385   1st Qu.:2020   1st Qu.:202001   1st Qu.:20.18     
 Mar    : 308   Median :2021   Median :202102   Median :41.81     
 Apr    : 308   Mean   :2021   Mean   :202066   Mean   :38.93     
 May    : 308   3rd Qu.:2022   3rd Qu.:202202   3rd Qu.:56.20     
 Jun    : 308   Max.   :2023   Max.   :202302   Max.   :95.86     
 (Other):1848                                                     
 no_tourist_stay   no_tourist_all    no_tourist_thai   no_tourist_foreign 
 Min.   :      0   Min.   :      0   Min.   :      0   Min.   :      0.0  
 1st Qu.:  16259   1st Qu.:  39092   1st Qu.:  37169   1st Qu.:     49.2  
 Median :  44579   Median :  92122   Median :  88782   Median :    553.0  
 Mean   : 105134   Mean   : 206328   Mean   : 173962   Mean   :  32366.1  
 3rd Qu.:  90902   3rd Qu.: 203646   3rd Qu.: 184256   3rd Qu.:   5189.5  
 Max.   :3335728   Max.   :6131044   Max.   :4087756   Max.   :2473725.0  
                                                                          
  revenue_all         revenue_thai       revenue_foreign    
 Min.   :0.000e+00   Min.   :0.000e+00   Min.   :0.000e+00  
 1st Qu.:6.332e+07   1st Qu.:5.925e+07   1st Qu.:1.100e+05  
 Median :1.955e+08   Median :1.773e+08   Median :1.540e+06  
 Mean   :1.344e+09   Mean   :6.636e+08   Mean   :6.802e+08  
 3rd Qu.:5.060e+08   3rd Qu.:4.600e+08   3rd Qu.:1.742e+07  
 Max.   :1.103e+11   Max.   :4.506e+10   Max.   :8.503e+10  
                                                            
 ratio_tourist_foreign ratio_tourist_thai ratio_revenue_thai
 Min.   :0.0000000     Min.   :0.0000     Min.   :0.0000    
 1st Qu.:0.0008535     1st Qu.:0.9627     1st Qu.:0.9511    
 Median :0.0066240     Median :0.9932     Median :0.9911    
 Mean   :0.0637772     Mean   :0.9297     Mean   :0.9090    
 3rd Qu.:0.0346323     3rd Qu.:0.9990     3rd Qu.:0.9988    
 Max.   :1.0000000     Max.   :1.0000     Max.   :1.0000    
                                                            
 ratio_revenue_foreign avg_revenue_all  avg_revenue_thai avg_revenue_foreign
 Min.   :0.000000      Min.   :     0   Min.   :    0    Min.   :    0      
 1st Qu.:0.001126      1st Qu.:  1366   1st Qu.: 1345    1st Qu.: 1294      
 Median :0.008700      Median :  1932   Median : 1880    Median : 2372      
 Mean   :0.084802      Mean   :  3513   Mean   : 2614    Mean   : 4504      
 3rd Qu.:0.045997      3rd Qu.:  3199   3rd Qu.: 3082    3rd Qu.: 4137      
 Max.   :1.000000      Max.   :300000   Max.   :17325    Max.   :65000      
                                                                            </code></pre>
</div>
</div>
</section><section id="combining-datasets" class="level3" data-number="8.3"><h3 data-number="8.3" class="anchored" data-anchor-id="combining-datasets">
<span class="header-section-number">8.3</span> Combining Datasets</h3>
<p>After all the data cleaning and feature engineering steps, we can merge the aspatial dataset with the geospatial dataset.</p>
<p>We will select the relevant columns from the admin boundary and combine the two dataset with the common column which is <code>province_eng</code> for their respective datasets.</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">admin_boundary</span> <span class="op">&lt;-</span> <span class="va">admin_boundary</span><span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">17</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tourism</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">admin_boundary</span>, <span class="va">tourism_df_ft</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"province_eng"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The combined dataset is saved for future analysis.</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">write_rds</span><span class="op">(</span><span class="va">tourism</span>, <span class="st">"data/rds/tourism.rds"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>This <code>tourism</code> object forms the tourism economy indicators layer within the study area in sf polygon features.</p>
</blockquote>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tourism</span> <span class="op">&lt;-</span> <span class="fu">read_rds</span><span class="op">(</span><span class="st">"data/rds/tourism.rds"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="exploratory-data-analysis-eda" class="level2" data-number="9"><h2 data-number="9" class="anchored" data-anchor-id="exploratory-data-analysis-eda">
<span class="header-section-number">9</span> Exploratory Data Analysis (EDA)</h2>
<p>In this section, we will perform Exploratory Data Analysis to understand data better and <strong>derive the important indictators of tourism economy of Thailand</strong> for further geospatial analysis.</p>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a mapping of the number of months per year</span></span>
<span><span class="va">months_per_year</span> <span class="op">&lt;-</span> <span class="va">tourism_df_ft</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>months_count <span class="op">=</span> <span class="fu">n_distinct</span><span class="op">(</span><span class="va">month_number</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Normalize tourist data by dividing by months_count for each year</span></span>
<span><span class="va">tourists_by_year_type</span> <span class="op">&lt;-</span> <span class="va">tourism_df_ft</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    total_thai <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">no_tourist_thai</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    total_foreign <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">no_tourist_foreign</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    total_all <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">no_tourist_all</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">months_per_year</span>, by <span class="op">=</span> <span class="st">"year"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    total_thai <span class="op">=</span> <span class="va">total_thai</span> <span class="op">/</span> <span class="va">months_count</span>,</span>
<span>    total_foreign <span class="op">=</span> <span class="va">total_foreign</span> <span class="op">/</span> <span class="va">months_count</span>,</span>
<span>    total_all <span class="op">=</span> <span class="va">total_all</span> <span class="op">/</span> <span class="va">months_count</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">months_count</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tourists_by_year_long</span> <span class="op">&lt;-</span> <span class="va">tourists_by_year_type</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">total_thai</span>, <span class="va">total_foreign</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">"tourist_type"</span>, values_to <span class="op">=</span> <span class="st">"total_tourists"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create stacked bar chart with trendline</span></span>
<span><span class="va">fig_tourists_by_year</span> <span class="op">&lt;-</span> <span class="fu">plot_ly</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">add_trace</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">tourists_by_year_long</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">tourist_type</span> <span class="op">==</span> <span class="st">"total_thai"</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="op">~</span><span class="va">year</span>,</span>
<span>    y <span class="op">=</span> <span class="op">~</span><span class="va">total_tourists</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"Thai Tourists"</span>,</span>
<span>    type <span class="op">=</span> <span class="st">'bar'</span>,</span>
<span>    hoverinfo <span class="op">=</span> <span class="st">'text'</span>,</span>
<span>    marker <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'dodgerblue2'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">add_trace</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">tourists_by_year_long</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">tourist_type</span> <span class="op">==</span> <span class="st">"total_foreign"</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="op">~</span><span class="va">year</span>,</span>
<span>    y <span class="op">=</span> <span class="op">~</span><span class="va">total_tourists</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"Foreign Tourists"</span>,</span>
<span>    type <span class="op">=</span> <span class="st">'bar'</span>,</span>
<span>    hoverinfo <span class="op">=</span> <span class="st">'text'</span>,</span>
<span>    marker <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'sienna3'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># Add trendline for total tourists</span></span>
<span>  <span class="fu">add_trace</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">tourists_by_year_type</span>,</span>
<span>    x <span class="op">=</span> <span class="op">~</span><span class="va">year</span>,</span>
<span>    y <span class="op">=</span> <span class="op">~</span><span class="va">total_all</span>,</span>
<span>    type <span class="op">=</span> <span class="st">'scatter'</span>,</span>
<span>    mode <span class="op">=</span> <span class="st">'lines+markers'</span>,</span>
<span>    line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span>, dash <span class="op">=</span> <span class="st">'dash'</span><span class="op">)</span>,</span>
<span>    marker <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span>, size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'Total Tourists Trend'</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span><span class="op">(</span></span>
<span>    barmode <span class="op">=</span> <span class="st">'stack'</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Normalized Distribution of Local and Foreign Tourists Over Time"</span>,</span>
<span>    xaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Year"</span><span class="op">)</span>,</span>
<span>    yaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Number of Tourists (Monthly Average)"</span><span class="op">)</span>,</span>
<span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"Tourist Type"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">fig_tourists_by_year</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-0d7db73d03839427d3b7" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-0d7db73d03839427d3b7">{"x":{"visdat":{"13d0e76784c74":["function () ","plotlyVisDat"],"13d0e53e3906f":["function () ","data"],"13d0e11f9270":["function () ","data"],"13d0e3fc6f7a3":["function () ","data"]},"cur_data":"13d0e3fc6f7a3","attrs":{"13d0e53e3906f":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"name":"Thai Tourists","type":"bar","hoverinfo":"text","marker":{"color":"dodgerblue2"},"inherit":true},"13d0e11f9270":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"name":"Foreign Tourists","type":"bar","hoverinfo":"text","marker":{"color":"sienna3"},"inherit":true},"13d0e3fc6f7a3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines+markers","line":{"color":"black","dash":"dash"},"marker":{"color":"black","size":6},"name":"Total Tourists Trend","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"barmode":"stack","title":"Normalized Distribution of Local and Foreign Tourists Over Time","xaxis":{"domain":[0,1],"automargin":true,"title":"Year"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Number of Tourists (Monthly Average)"},"legend":{"title":{"text":"Tourist Type"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[2019,2020,2021,2022,2023],"y":[19145746.666666668,10267901.75,5990190.083333333,16914376.75,20968266.5],"name":"Thai Tourists","type":"bar","hoverinfo":["text","text","text","text","text"],"marker":{"color":"dodgerblue2","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[6449419.166666667,1151274.25,96190.75,1822437.25,5188862.5],"name":"Foreign Tourists","type":"bar","hoverinfo":["text","text","text","text","text"],"marker":{"color":"sienna3","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[25595165.833333332,11419176,6086380.833333333,18736814,26157129],"type":"scatter","mode":"lines+markers","line":{"color":"black","dash":"dash"},"marker":{"color":"black","size":6,"line":{"color":"rgba(44,160,44,1)"}},"name":"Total Tourists Trend","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Observations:</strong></p>
<ul>
<li><p>The plot above shows the distribution of local and foreign tourists over time, normalized by month. Normalization is done to ensure that the plot is still representative as there is partial yearly data for 2023.</p></li>
<li><p>Tourism peaked in 2023 (normalized by months), indicating that tourist numbers have rebounded strongly, even surpassing pre-pandemic levels from 2019.</p></li>
<li><p>The sharp decline from 2020 to 2021 due to the global impact of the COVID-19 pandemic and related restrictions is clearly visible.</p></li>
<li><p>The ratio of foreign tourists remains relatively low in comparison to local tourists, consistent across all the years, suggesting that local tourism has been a key driver in the recovery.</p></li>
</ul>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">months_per_year</span> <span class="op">&lt;-</span> <span class="va">tourism_df_ft</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>months_count <span class="op">=</span> <span class="fu">n_distinct</span><span class="op">(</span><span class="va">month_number</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Group data by year and summarize revenue for Thai, foreign, and all tourists, normalized by months</span></span>
<span><span class="va">revenue_by_year_type</span> <span class="op">&lt;-</span> <span class="va">tourism_df_ft</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">st_drop_geometry</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    total_revenue_thai <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">revenue_thai</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    total_revenue_foreign <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">revenue_foreign</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    total_revenue_all <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">revenue_all</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># Join with the months per year to normalize</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">months_per_year</span>, by <span class="op">=</span> <span class="st">"year"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    monthly_avg_revenue_thai <span class="op">=</span> <span class="va">total_revenue_thai</span> <span class="op">/</span> <span class="va">months_count</span>,</span>
<span>    monthly_avg_revenue_foreign <span class="op">=</span> <span class="va">total_revenue_foreign</span> <span class="op">/</span> <span class="va">months_count</span>,</span>
<span>    monthly_avg_revenue_all <span class="op">=</span> <span class="va">total_revenue_all</span> <span class="op">/</span> <span class="va">months_count</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Reshape data for stacked bar chart</span></span>
<span><span class="va">revenue_by_year_long</span> <span class="op">&lt;-</span> <span class="va">revenue_by_year_type</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">monthly_avg_revenue_thai</span>, <span class="va">monthly_avg_revenue_foreign</span><span class="op">)</span>, </span>
<span>               names_to <span class="op">=</span> <span class="st">"revenue_type"</span>, </span>
<span>               values_to <span class="op">=</span> <span class="st">"monthly_avg_revenue"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create stacked bar chart with trendline for total revenue (monthly average)</span></span>
<span><span class="va">fig_revenue_by_year</span> <span class="op">&lt;-</span> <span class="fu">plot_ly</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># Add trace for Thai tourist revenue (blue)</span></span>
<span>  <span class="fu">add_trace</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">revenue_by_year_long</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">revenue_type</span> <span class="op">==</span> <span class="st">"monthly_avg_revenue_thai"</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="op">~</span><span class="va">year</span>,</span>
<span>    y <span class="op">=</span> <span class="op">~</span><span class="va">monthly_avg_revenue</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"Thai Tourist Revenue"</span>,</span>
<span>    type <span class="op">=</span> <span class="st">'bar'</span>,</span>
<span>    hoverinfo <span class="op">=</span> <span class="st">'text'</span>,</span>
<span>    marker <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'dodgerblue2'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># Add trace for Foreign tourist revenue (orange)</span></span>
<span>  <span class="fu">add_trace</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">revenue_by_year_long</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">revenue_type</span> <span class="op">==</span> <span class="st">"monthly_avg_revenue_foreign"</span><span class="op">)</span>,</span>
<span>    x <span class="op">=</span> <span class="op">~</span><span class="va">year</span>,</span>
<span>    y <span class="op">=</span> <span class="op">~</span><span class="va">monthly_avg_revenue</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"Foreign Tourist Revenue"</span>,</span>
<span>    type <span class="op">=</span> <span class="st">'bar'</span>,</span>
<span>    hoverinfo <span class="op">=</span> <span class="st">'text'</span>,</span>
<span>    marker <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'sienna3'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># Add trendline for total revenue (monthly average)</span></span>
<span>  <span class="fu">add_trace</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">revenue_by_year_type</span>,</span>
<span>    x <span class="op">=</span> <span class="op">~</span><span class="va">year</span>,</span>
<span>    y <span class="op">=</span> <span class="op">~</span><span class="va">monthly_avg_revenue_all</span>,</span>
<span>    type <span class="op">=</span> <span class="st">'scatter'</span>,</span>
<span>    mode <span class="op">=</span> <span class="st">'lines+markers'</span>,</span>
<span>    line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span>, dash <span class="op">=</span> <span class="st">'dash'</span><span class="op">)</span>,</span>
<span>    marker <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'black'</span>, size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>    name <span class="op">=</span> <span class="st">'Total Revenue Trend'</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span><span class="op">(</span></span>
<span>    barmode <span class="op">=</span> <span class="st">'stack'</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Normalized Distribution of Revenue by Tourist Type Over Time"</span>,</span>
<span>    xaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Year"</span><span class="op">)</span>,</span>
<span>    yaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Revenue (Monthly Average, Thai Baht)"</span><span class="op">)</span>,</span>
<span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"Revenue Type"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">fig_revenue_by_year</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-c2e3fede5c798441fdae" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-c2e3fede5c798441fdae">{"x":{"visdat":{"13d0e590fab6b":["function () ","plotlyVisDat"],"13d0e13bf2b7b":["function () ","data"],"13d0e6bbfa25d":["function () ","data"],"13d0e723cbeee":["function () ","data"]},"cur_data":"13d0e723cbeee","attrs":{"13d0e13bf2b7b":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"name":"Thai Tourist Revenue","type":"bar","hoverinfo":"text","marker":{"color":"dodgerblue2"},"inherit":true},"13d0e6bbfa25d":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"name":"Foreign Tourist Revenue","type":"bar","hoverinfo":"text","marker":{"color":"sienna3"},"inherit":true},"13d0e723cbeee":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"lines+markers","line":{"color":"black","dash":"dash"},"marker":{"color":"black","size":6},"name":"Total Revenue Trend","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"barmode":"stack","title":"Normalized Distribution of Revenue by Tourist Type Over Time","xaxis":{"domain":[0,1],"automargin":true,"title":"Year"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Revenue (Monthly Average, Thai Baht)"},"legend":{"title":{"text":"Revenue Type"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[2019,2020,2021,2022,2023],"y":[90146590833.333328,40205674166.666664,18031325958.333332,53462849166.666664,66435310000],"name":"Thai Tourist Revenue","type":"bar","hoverinfo":["text","text","text","text","text"],"marker":{"color":"dodgerblue2","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[137178729166.66667,25838843333.333332,2081192891.6666667,36918423333.333336,97343835000],"name":"Foreign Tourist Revenue","type":"bar","hoverinfo":["text","text","text","text","text"],"marker":{"color":"sienna3","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[227325320000,66044517500,20112518850,90381272500,163779145000],"type":"scatter","mode":"lines+markers","line":{"color":"black","dash":"dash"},"marker":{"color":"black","size":6,"line":{"color":"rgba(44,160,44,1)"}},"name":"Total Revenue Trend","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Observations (Comparing with revenue distribution with earlier tourist count plot):</strong></p>
<ul>
<li><p>The plot shows the <strong>normalized distribution of revenue</strong> from local and foreign tourists over time, adjusting for partial data in 2023 by normalizing the values per month.</p></li>
<li><p>When comparing the <strong>revenue plot</strong> with the <strong>tourist count plot</strong>, it becomes clear that <strong>foreign tourists, though fewer in number</strong>, contribute significantly more to revenue than local tourists. This suggests that <strong>foreign tourists spend more per visit</strong> than local tourists, highlighting their economic importance on the tourism industry.</p></li>
<li><p>Total revenue peaked in 2019, but while <strong>tourist numbers have rebounded strongly</strong> in 2023, the revenue is <strong>still recovering and has not yet surpassed 2019 levels</strong>. This indicates that although tourism has picked up in terms of volume, the overall spending per tourist might be lower than pre-pandemic levels, or the higher-spending foreign tourists have not fully returned in their pre-2019 numbers.</p></li>
</ul>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Summarize total revenue by year and province</span></span>
<span><span class="va">revenue_by_year_province</span> <span class="op">&lt;-</span> <span class="va">tourism_df_ft</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">year</span>, <span class="va">province_eng</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    total_revenue_all <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">revenue_all</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate the proportion (percent) of revenue by province for each year and reorder provinces by contribution</span></span>
<span><span class="va">revenue_by_year_province</span> <span class="op">&lt;-</span> <span class="va">revenue_by_year_province</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    total_revenue_year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">total_revenue_all</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    percent_revenue <span class="op">=</span> <span class="op">(</span><span class="va">total_revenue_all</span> <span class="op">/</span> <span class="va">total_revenue_year</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>    <span class="co"># Reorder provinces based on their revenue contribution for each year</span></span>
<span>    province_eng <span class="op">=</span> <span class="fu">fct_reorder</span><span class="op">(</span><span class="va">province_eng</span>, <span class="va">percent_revenue</span>, .desc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create stacked bar chart with percentages</span></span>
<span><span class="va">fig_revenue_by_year_province</span> <span class="op">&lt;-</span> <span class="fu">plot_ly</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">add_trace</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">revenue_by_year_province</span>,</span>
<span>    x <span class="op">=</span> <span class="op">~</span><span class="va">year</span>,</span>
<span>    y <span class="op">=</span> <span class="op">~</span><span class="va">percent_revenue</span>,</span>
<span>    color <span class="op">=</span> <span class="op">~</span><span class="va">province_eng</span>,</span>
<span>    colors <span class="op">=</span> <span class="fu">brewer.pal</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">12</span>, <span class="st">"Set3"</span><span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="st">'bar'</span>,</span>
<span>    text <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">province_eng</span>, <span class="st">": "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">percent_revenue</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"%"</span><span class="op">)</span>,</span>
<span>    hoverinfo <span class="op">=</span> <span class="st">'text'</span>,</span>
<span>    name <span class="op">=</span> <span class="op">~</span><span class="va">province_eng</span>,</span>
<span>    marker <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">'grey'</span>, width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">layout</a></span><span class="op">(</span></span>
<span>    barmode <span class="op">=</span> <span class="st">'stack'</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Percentage Distribution of Revenue Over Time by Province"</span>,</span>
<span>    xaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Year"</span><span class="op">)</span>,</span>
<span>    yaxis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Revenue (%)"</span><span class="op">)</span>,</span>
<span>    legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">"Province"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Show the plot</span></span>
<span><span class="va">fig_revenue_by_year_province</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-a77ad32f6b82562872f5" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a77ad32f6b82562872f5">{"x":{"visdat":{"13d0e586c7415":["function () ","plotlyVisDat"],"13d0e38393c0d":["function () ","data"]},"cur_data":"13d0e38393c0d","attrs":{"13d0e38393c0d":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"color":{},"colors":["#8DD3C7","#FFFFB3","#BEBADA","#FB8072","#80B1D3","#FDB462","#B3DE69","#FCCDE5","#D9D9D9","#BC80BD","#CCEBC5","#FFED6F"],"type":"bar","text":{},"hoverinfo":"text","name":{},"marker":{"line":{"color":"grey","width":0.5}},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"barmode":"stack","title":"Percentage Distribution of Revenue Over Time by Province","xaxis":{"domain":[0,1],"automargin":true,"title":"Year"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Revenue (%)"},"legend":{"title":{"text":"Province"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[2019,2020,2021,2022,2023],"y":[39.144112939112986,32.142481269042001,25.978807224337292,31.438120472726617,36.861689563710939],"type":"bar","text":["Bangkok :  39.14 %","Bangkok :  32.14 %","Bangkok :  25.98 %","Bangkok :  31.44 %","Bangkok :  36.86 %"],"hoverinfo":["text","text","text","text","text"],"name":"Bangkok","marker":{"color":"rgba(141,211,199,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(141,211,199,1)"},"error_y":{"color":"rgba(141,211,199,1)"},"error_x":{"color":"rgba(141,211,199,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[16.235567526456503,13.685659070792667,8.8336772397854091,17.853696774775255,19.682008353383456],"type":"bar","text":["Phuket :  16.24 %","Phuket :  13.69 %","Phuket :  8.83 %","Phuket :  17.85 %","Phuket :  19.68 %"],"hoverinfo":["text","text","text","text","text"],"name":"Phuket","marker":{"color":"rgba(160,217,196,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(160,217,196,1)"},"error_y":{"color":"rgba(160,217,196,1)"},"error_x":{"color":"rgba(160,217,196,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[10.129695040863316,7.8860229894681773,4.9423902300863061,9.1713837436105283,10.20654369639065],"type":"bar","text":["Chon Buri :  10.13 %","Chon Buri :  7.89 %","Chon Buri :  4.94 %","Chon Buri :  9.17 %","Chon Buri :  10.21 %"],"hoverinfo":["text","text","text","text","text"],"name":"Chon Buri","marker":{"color":"rgba(178,224,194,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(178,224,194,1)"},"error_y":{"color":"rgba(178,224,194,1)"},"error_x":{"color":"rgba(178,224,194,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[4.1077511002000717,3.6631428187812864,1.8621113685121544,1.4693807281812723,1.3084877198498013],"type":"bar","text":["Krabi :  4.11 %","Krabi :  3.66 %","Krabi :  1.86 %","Krabi :  1.47 %","Krabi :  1.31 %"],"hoverinfo":["text","text","text","text","text"],"name":"Krabi","marker":{"color":"rgba(195,230,191,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(195,230,191,1)"},"error_y":{"color":"rgba(195,230,191,1)"},"error_x":{"color":"rgba(195,230,191,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[4.0569732839263128,6.2888174883958632,9.650394933004625,5.5027273487436235,5.0561596227651568],"type":"bar","text":["Chiang Mai :  4.06 %","Chiang Mai :  6.29 %","Chiang Mai :  9.65 %","Chiang Mai :  5.5 %","Chiang Mai :  5.06 %"],"hoverinfo":["text","text","text","text","text"],"name":"Chiang Mai","marker":{"color":"rgba(211,236,188,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(211,236,188,1)"},"error_y":{"color":"rgba(211,236,188,1)"},"error_x":{"color":"rgba(211,236,188,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[3.4563945626470471,3.058872373471424,1.1324497362331454,2.550385461029367,2.1279785042228667],"type":"bar","text":["Surat Thani :  3.46 %","Surat Thani :  3.06 %","Surat Thani :  1.13 %","Surat Thani :  2.55 %","Surat Thani :  2.13 %"],"hoverinfo":["text","text","text","text","text"],"name":"Surat Thani","marker":{"color":"rgba(226,243,185,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(226,243,185,1)"},"error_y":{"color":"rgba(226,243,185,1)"},"error_x":{"color":"rgba(226,243,185,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[2.4328394214951508,2.8857505091168241,1.3483766107197459,1.4511818990672727,1.2620410248203457],"type":"bar","text":["Songkhla :  2.43 %","Songkhla :  2.89 %","Songkhla :  1.35 %","Songkhla :  1.45 %","Songkhla :  1.26 %"],"hoverinfo":["text","text","text","text","text"],"name":"Songkhla","marker":{"color":"rgba(241,249,182,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(241,249,182,1)"},"error_y":{"color":"rgba(241,249,182,1)"},"error_x":{"color":"rgba(241,249,182,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[1.8954047881687794,1.4798805972047566,1.1394644385877106,0.56199511169012728,0.53361494835010892],"type":"bar","text":["Phangnga :  1.9 %","Phangnga :  1.48 %","Phangnga :  1.14 %","Phangnga :  0.56 %","Phangnga :  0.53 %"],"hoverinfo":["text","text","text","text","text"],"name":"Phangnga","marker":{"color":"rgba(254,254,180,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(254,254,180,1)"},"error_y":{"color":"rgba(254,254,180,1)"},"error_x":{"color":"rgba(254,254,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[1.5540368167816354,2.273821088429735,4.363265021874672,3.0277400663948386,2.2606510737371357],"type":"bar","text":["Prachuap Khiri Khan :  1.55 %","Prachuap Khiri Khan :  2.27 %","Prachuap Khiri Khan :  4.36 %","Prachuap Khiri Khan :  3.03 %","Prachuap Khiri Khan :  2.26 %"],"hoverinfo":["text","text","text","text","text"],"name":"Prachuap Khiri Khan","marker":{"color":"rgba(246,244,186,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(246,244,186,1)"},"error_y":{"color":"rgba(246,244,186,1)"},"error_x":{"color":"rgba(246,244,186,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[1.3593290737110439,1.5852047572810768,1.6259069078925108,0.89264067398475722,0.87033364351731102],"type":"bar","text":["Rayong :  1.36 %","Rayong :  1.59 %","Rayong :  1.63 %","Rayong :  0.89 %","Rayong :  0.87 %"],"hoverinfo":["text","text","text","text","text"],"name":"Rayong","marker":{"color":"rgba(237,234,192,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(237,234,192,1)"},"error_y":{"color":"rgba(237,234,192,1)"},"error_x":{"color":"rgba(237,234,192,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[1.137664368697102,1.819961815906975,3.7160147480317547,2.2492353158670122,1.5120453828233138],"type":"bar","text":["Phetchaburi :  1.14 %","Phetchaburi :  1.82 %","Phetchaburi :  3.72 %","Phetchaburi :  2.25 %","Phetchaburi :  1.51 %"],"hoverinfo":["text","text","text","text","text"],"name":"Phetchaburi","marker":{"color":"rgba(228,224,198,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(228,224,198,1)"},"error_y":{"color":"rgba(228,224,198,1)"},"error_x":{"color":"rgba(228,224,198,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[1.0737808851795891,1.8862971227450231,3.2932100893966343,3.172972033559275,2.7338859291273012],"type":"bar","text":["Chiang Rai :  1.07 %","Chiang Rai :  1.89 %","Chiang Rai :  3.29 %","Chiang Rai :  3.17 %","Chiang Rai :  2.73 %"],"hoverinfo":["text","text","text","text","text"],"name":"Chiang Rai","marker":{"color":"rgba(219,214,203,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(219,214,203,1)"},"error_y":{"color":"rgba(219,214,203,1)"},"error_x":{"color":"rgba(219,214,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[1.0221738607912221,1.9200433000866928,3.5150288166583041,1.9804886386539127,1.4668259502759036],"type":"bar","text":["Kanchanaburi :  1.02 %","Kanchanaburi :  1.92 %","Kanchanaburi :  3.52 %","Kanchanaburi :  1.98 %","Kanchanaburi :  1.47 %"],"hoverinfo":["text","text","text","text","text"],"name":"Kanchanaburi","marker":{"color":"rgba(209,204,209,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(209,204,209,1)"},"error_y":{"color":"rgba(209,204,209,1)"},"error_x":{"color":"rgba(209,204,209,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.90707376254142458,1.5992735506016831,2.4059849006265401,0.92613765755510913,0.66903817332786786],"type":"bar","text":["Nakhon Ratchasima :  0.91 %","Nakhon Ratchasima :  1.6 %","Nakhon Ratchasima :  2.41 %","Nakhon Ratchasima :  0.93 %","Nakhon Ratchasima :  0.67 %"],"hoverinfo":["text","text","text","text","text"],"name":"Nakhon Ratchasima","marker":{"color":"rgba(199,194,214,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(199,194,214,1)"},"error_y":{"color":"rgba(199,194,214,1)"},"error_x":{"color":"rgba(199,194,214,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.72266953515487553,1.0252882332991027,1.4922629477941629,0.81178966951735865,0.61383578476978862],"type":"bar","text":["Trat :  0.72 %","Trat :  1.03 %","Trat :  1.49 %","Trat :  0.81 %","Trat :  0.61 %"],"hoverinfo":["text","text","text","text","text"],"name":"Trat","marker":{"color":"rgba(193,185,215,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(193,185,215,1)"},"error_y":{"color":"rgba(193,185,215,1)"},"error_x":{"color":"rgba(193,185,215,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.7021479173547408,0.77649771105779775,1.5477010561840527,1.1032752019138332,0.84772087435185961],"type":"bar","text":["Phra Nakhon Si Ayutthaya :  0.7 %","Phra Nakhon Si Ayutthaya :  0.78 %","Phra Nakhon Si Ayutthaya :  1.55 %","Phra Nakhon Si Ayutthaya :  1.1 %","Phra Nakhon Si Ayutthaya :  0.85 %"],"hoverinfo":["text","text","text","text","text"],"name":"Phra Nakhon Si Ayutthaya","marker":{"color":"rgba(205,177,200,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(205,177,200,1)"},"error_y":{"color":"rgba(205,177,200,1)"},"error_x":{"color":"rgba(205,177,200,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.66392662873336472,1.096439736020985,1.3057166134116514,0.87253602970312982,0.55728707095155494],"type":"bar","text":["Khon Kaen :  0.66 %","Khon Kaen :  1.1 %","Khon Kaen :  1.31 %","Khon Kaen :  0.87 %","Khon Kaen :  0.56 %"],"hoverinfo":["text","text","text","text","text"],"name":"Khon Kaen","marker":{"color":"rgba(216,169,184,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(216,169,184,1)"},"error_y":{"color":"rgba(216,169,184,1)"},"error_x":{"color":"rgba(216,169,184,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.58638430598052171,1.0368927796820278,1.1480370429418723,0.51644732780971492,0.39033358001716273],"type":"bar","text":["Nakhon Si Thammarat :  0.59 %","Nakhon Si Thammarat :  1.04 %","Nakhon Si Thammarat :  1.15 %","Nakhon Si Thammarat :  0.52 %","Nakhon Si Thammarat :  0.39 %"],"hoverinfo":["text","text","text","text","text"],"name":"Nakhon Si Thammarat","marker":{"color":"rgba(225,161,169,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(225,161,169,1)"},"error_y":{"color":"rgba(225,161,169,1)"},"error_x":{"color":"rgba(225,161,169,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.41883661119081095,0.71821883878047366,0.87723969988970329,0.55811525188104272,0.44464147129355208],"type":"bar","text":["Udon Thani :  0.42 %","Udon Thani :  0.72 %","Udon Thani :  0.88 %","Udon Thani :  0.56 %","Udon Thani :  0.44 %"],"hoverinfo":["text","text","text","text","text"],"name":"Udon Thani","marker":{"color":"rgba(233,152,154,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(233,152,154,1)"},"error_y":{"color":"rgba(233,152,154,1)"},"error_x":{"color":"rgba(233,152,154,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.35050172443028638,0.50560593466369097,0.557136415892864,0.33526303803700042,0.21517086317674938],"type":"bar","text":["Trang :  0.35 %","Trang :  0.51 %","Trang :  0.56 %","Trang :  0.34 %","Trang :  0.22 %"],"hoverinfo":["text","text","text","text","text"],"name":"Trang","marker":{"color":"rgba(241,144,139,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(241,144,139,1)"},"error_y":{"color":"rgba(241,144,139,1)"},"error_x":{"color":"rgba(241,144,139,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.33868899132456226,0.61138938090760775,0.77602993354890837,0.55064689055652172,0.34444556417729499],"type":"bar","text":["Satun :  0.34 %","Satun :  0.61 %","Satun :  0.78 %","Satun :  0.55 %","Satun :  0.34 %"],"hoverinfo":["text","text","text","text","text"],"name":"Satun","marker":{"color":"rgba(247,135,125,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(247,135,125,1)"},"error_y":{"color":"rgba(247,135,125,1)"},"error_x":{"color":"rgba(247,135,125,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.31943354718837891,0.55652739583317168,0.84759398497717253,0.4217521942944541,0.53868274864910304],"type":"bar","text":["Chanthaburi :  0.32 %","Chanthaburi :  0.56 %","Chanthaburi :  0.85 %","Chanthaburi :  0.42 %","Chanthaburi :  0.54 %"],"hoverinfo":["text","text","text","text","text"],"name":"Chanthaburi","marker":{"color":"rgba(248,130,118,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(248,130,118,1)"},"error_y":{"color":"rgba(248,130,118,1)"},"error_x":{"color":"rgba(248,130,118,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.31361149445795716,0.57965825853750841,0.93334488865707965,0.56938971142131978,0.44583209907464105],"type":"bar","text":["Phitsanulok :  0.31 %","Phitsanulok :  0.58 %","Phitsanulok :  0.93 %","Phitsanulok :  0.57 %","Phitsanulok :  0.45 %"],"hoverinfo":["text","text","text","text","text"],"name":"Phitsanulok","marker":{"color":"rgba(235,139,132,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(235,139,132,1)"},"error_y":{"color":"rgba(235,139,132,1)"},"error_x":{"color":"rgba(235,139,132,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.29317638997128287,0.43100347680890644,0.6207949433444534,0.26563301595471561,0.27851836691417575],"type":"bar","text":["Ubon Ratchathani :  0.29 %","Ubon Ratchathani :  0.43 %","Ubon Ratchathani :  0.62 %","Ubon Ratchathani :  0.27 %","Ubon Ratchathani :  0.28 %"],"hoverinfo":["text","text","text","text","text"],"name":"Ubon Ratchathani","marker":{"color":"rgba(222,147,145,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(222,147,145,1)"},"error_y":{"color":"rgba(222,147,145,1)"},"error_x":{"color":"rgba(222,147,145,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.28156601003941545,0.54107191158347601,0.89468737361390549,0.60810348367983713,0.52638264780292998],"type":"bar","text":["Phetchabun :  0.28 %","Phetchabun :  0.54 %","Phetchabun :  0.89 %","Phetchabun :  0.61 %","Phetchabun :  0.53 %"],"hoverinfo":["text","text","text","text","text"],"name":"Phetchabun","marker":{"color":"rgba(206,154,159,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(206,154,159,1)"},"error_y":{"color":"rgba(206,154,159,1)"},"error_x":{"color":"rgba(206,154,159,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.28076392898072244,0.51286492730704969,0.4973809301530292,0.31642524912079179,0.18857101739052307],"type":"bar","text":["Nakhon Nayok :  0.28 %","Nakhon Nayok :  0.51 %","Nakhon Nayok :  0.5 %","Nakhon Nayok :  0.32 %","Nakhon Nayok :  0.19 %"],"hoverinfo":["text","text","text","text","text"],"name":"Nakhon Nayok","marker":{"color":"rgba(190,161,173,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(190,161,173,1)"},"error_y":{"color":"rgba(190,161,173,1)"},"error_x":{"color":"rgba(190,161,173,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.27624177544322825,0.33885729677208509,0.40003691531655167,0.2922498869073421,0.1832620386435648],"type":"bar","text":["Chumphon :  0.28 %","Chumphon :  0.34 %","Chumphon :  0.4 %","Chumphon :  0.29 %","Chumphon :  0.18 %"],"hoverinfo":["text","text","text","text","text"],"name":"Chumphon","marker":{"color":"rgba(170,167,188,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(170,167,188,1)"},"error_y":{"color":"rgba(170,167,188,1)"},"error_x":{"color":"rgba(170,167,188,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.26736536284944706,0.47254237769748764,0.49329558076047081,0.4488061026875525,0.3983138390422053],"type":"bar","text":["Tak :  0.27 %","Tak :  0.47 %","Tak :  0.49 %","Tak :  0.45 %","Tak :  0.4 %"],"hoverinfo":["text","text","text","text","text"],"name":"Tak","marker":{"color":"rgba(146,173,202,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(146,173,202,1)"},"error_y":{"color":"rgba(146,173,202,1)"},"error_x":{"color":"rgba(146,173,202,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.25697496727010727,0.267033267876222,0.28568856588873581,0.31466972319957104,0.24344979942348582],"type":"bar","text":["Samut Prakan :  0.26 %","Samut Prakan :  0.27 %","Samut Prakan :  0.29 %","Samut Prakan :  0.31 %","Samut Prakan :  0.24 %"],"hoverinfo":["text","text","text","text","text"],"name":"Samut Prakan","marker":{"color":"rgba(139,177,205,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(139,177,205,1)"},"error_y":{"color":"rgba(139,177,205,1)"},"error_x":{"color":"rgba(139,177,205,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.24967448999228653,0.29558093145278863,0.63390535160807737,0.57011165301602351,0.37908672682349148],"type":"bar","text":["Saraburi :  0.25 %","Saraburi :  0.3 %","Saraburi :  0.63 %","Saraburi :  0.57 %","Saraburi :  0.38 %"],"hoverinfo":["text","text","text","text","text"],"name":"Saraburi","marker":{"color":"rgba(163,178,190,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(163,178,190,1)"},"error_y":{"color":"rgba(163,178,190,1)"},"error_x":{"color":"rgba(163,178,190,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.24785111193655565,0.37951421680585873,0.35339100916906452,0.32905323389864866,0.20342944152016423],"type":"bar","text":["Sa Kaeo :  0.25 %","Sa Kaeo :  0.38 %","Sa Kaeo :  0.35 %","Sa Kaeo :  0.33 %","Sa Kaeo :  0.2 %"],"hoverinfo":["text","text","text","text","text"],"name":"Sa Kaeo","marker":{"color":"rgba(184,178,174,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(184,178,174,1)"},"error_y":{"color":"rgba(184,178,174,1)"},"error_x":{"color":"rgba(184,178,174,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.22734965613743921,0.28318777557879804,0.51188329899315421,0.34473310460047646,0.21597377370604787],"type":"bar","text":["Nakhon Pathom :  0.23 %","Nakhon Pathom :  0.28 %","Nakhon Pathom :  0.51 %","Nakhon Pathom :  0.34 %","Nakhon Pathom :  0.22 %"],"hoverinfo":["text","text","text","text","text"],"name":"Nakhon Pathom","marker":{"color":"rgba(202,179,158,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(202,179,158,1)"},"error_y":{"color":"rgba(202,179,158,1)"},"error_x":{"color":"rgba(202,179,158,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.21081828162975128,0.29359994441123238,0.46024817025839609,0.42921963359905857,0.23855601395403547],"type":"bar","text":["Lop Buri :  0.21 %","Lop Buri :  0.29 %","Lop Buri :  0.46 %","Lop Buri :  0.43 %","Lop Buri :  0.24 %"],"hoverinfo":["text","text","text","text","text"],"name":"Lop Buri","marker":{"color":"rgba(218,179,142,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(218,179,142,1)"},"error_y":{"color":"rgba(218,179,142,1)"},"error_x":{"color":"rgba(218,179,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.20958400058559251,0.32647171154920873,0.6421166552857368,0.41982148458907786,0.42657445793846344],"type":"bar","text":["Suphan Buri :  0.21 %","Suphan Buri :  0.33 %","Suphan Buri :  0.64 %","Suphan Buri :  0.42 %","Suphan Buri :  0.43 %"],"hoverinfo":["text","text","text","text","text"],"name":"Suphan Buri","marker":{"color":"rgba(232,179,125,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(232,179,125,1)"},"error_y":{"color":"rgba(232,179,125,1)"},"error_x":{"color":"rgba(232,179,125,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.20805645407207607,0.32294378812997865,0.36624784402211591,0.30887943812327567,0.25323431747064012],"type":"bar","text":["Nong Khai :  0.21 %","Nong Khai :  0.32 %","Nong Khai :  0.37 %","Nong Khai :  0.31 %","Nong Khai :  0.25 %"],"hoverinfo":["text","text","text","text","text"],"name":"Nong Khai","marker":{"color":"rgba(246,180,108,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(246,180,108,1)"},"error_y":{"color":"rgba(246,180,108,1)"},"error_x":{"color":"rgba(246,180,108,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.19442987403837519,0.31744749542104939,0.55530919572844384,0.38814456833410926,0.30567078610649723],"type":"bar","text":["Mae Hong Son :  0.19 %","Mae Hong Son :  0.32 %","Mae Hong Son :  0.56 %","Mae Hong Son :  0.39 %","Mae Hong Son :  0.31 %"],"hoverinfo":["text","text","text","text","text"],"name":"Mae Hong Son","marker":{"color":"rgba(249,183,98,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(249,183,98,1)"},"error_y":{"color":"rgba(249,183,98,1)"},"error_x":{"color":"rgba(249,183,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.19426087981165788,0.32389390484481417,0.47265752262220173,0.25778293838471905,0.17043073463352126],"type":"bar","text":["Prachin Buri :  0.19 %","Prachin Buri :  0.32 %","Prachin Buri :  0.47 %","Prachin Buri :  0.26 %","Prachin Buri :  0.17 %"],"hoverinfo":["text","text","text","text","text"],"name":"Prachin Buri","marker":{"color":"rgba(239,190,99,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(239,190,99,1)"},"error_y":{"color":"rgba(239,190,99,1)"},"error_x":{"color":"rgba(239,190,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.18643545734368702,0.3472279133540494,0.55468769227115811,0.47333367650914626,0.30307582812207257],"type":"bar","text":["Chachoengsao :  0.19 %","Chachoengsao :  0.35 %","Chachoengsao :  0.55 %","Chachoengsao :  0.47 %","Chachoengsao :  0.3 %"],"hoverinfo":["text","text","text","text","text"],"name":"Chachoengsao","marker":{"color":"rgba(230,196,100,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(230,196,100,1)"},"error_y":{"color":"rgba(230,196,100,1)"},"error_x":{"color":"rgba(230,196,100,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.17243826307308543,0.2307029749542294,0.60335969968939684,0.54422133375768378,0.35986572038827047],"type":"bar","text":["Buri Ram :  0.17 %","Buri Ram :  0.23 %","Buri Ram :  0.6 %","Buri Ram :  0.54 %","Buri Ram :  0.36 %"],"hoverinfo":["text","text","text","text","text"],"name":"Buri Ram","marker":{"color":"rgba(219,202,101,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(219,202,101,1)"},"error_y":{"color":"rgba(219,202,101,1)"},"error_x":{"color":"rgba(219,202,101,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.17084106601059662,0.3164330281717429,0.401507806832128,0.30363406681769539,0.22349915186087949],"type":"bar","text":["Loei :  0.17 %","Loei :  0.32 %","Loei :  0.4 %","Loei :  0.3 %","Loei :  0.22 %"],"hoverinfo":["text","text","text","text","text"],"name":"Loei","marker":{"color":"rgba(209,208,102,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(209,208,102,1)"},"error_y":{"color":"rgba(209,208,102,1)"},"error_x":{"color":"rgba(209,208,102,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.17069589960326462,0.23318867207006749,0.29834846701295531,0.29194930841452804,0.2486213980418569],"type":"bar","text":["Nonthaburi :  0.17 %","Nonthaburi :  0.23 %","Nonthaburi :  0.3 %","Nonthaburi :  0.29 %","Nonthaburi :  0.25 %"],"hoverinfo":["text","text","text","text","text"],"name":"Nonthaburi","marker":{"color":"rgba(197,214,103,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(197,214,103,1)"},"error_y":{"color":"rgba(197,214,103,1)"},"error_x":{"color":"rgba(197,214,103,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.16364873037460148,0.17582584857756489,0.17098803116845804,0.10910907087158644,0.074191375220575242],"type":"bar","text":["Ranong :  0.16 %","Ranong :  0.18 %","Ranong :  0.17 %","Ranong :  0.11 %","Ranong :  0.07 %"],"hoverinfo":["text","text","text","text","text"],"name":"Ranong","marker":{"color":"rgba(185,220,105,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(185,220,105,1)"},"error_y":{"color":"rgba(185,220,105,1)"},"error_x":{"color":"rgba(185,220,105,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.16155041594134786,0.29577776838175857,0.4074203763891065,0.17583657425639071,0.1406833574567751],"type":"bar","text":["Ratchaburi :  0.16 %","Ratchaburi :  0.3 %","Ratchaburi :  0.41 %","Ratchaburi :  0.18 %","Ratchaburi :  0.14 %"],"hoverinfo":["text","text","text","text","text"],"name":"Ratchaburi","marker":{"color":"rgba(186,221,116,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(186,221,116,1)"},"error_y":{"color":"rgba(186,221,116,1)"},"error_x":{"color":"rgba(186,221,116,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.15952065231155654,0.29095400184680986,0.65453429436230626,0.38853089467916779,0.29638694230574963],"type":"bar","text":["Lampang :  0.16 %","Lampang :  0.29 %","Lampang :  0.65 %","Lampang :  0.39 %","Lampang :  0.3 %"],"hoverinfo":["text","text","text","text","text"],"name":"Lampang","marker":{"color":"rgba(198,219,134,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(198,219,134,1)"},"error_y":{"color":"rgba(198,219,134,1)"},"error_x":{"color":"rgba(198,219,134,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.14594356082580975,0.25302377798934383,0.50979856922959865,0.38186008058251225,0.29957110839722606],"type":"bar","text":["Nakhon Sawan :  0.15 %","Nakhon Sawan :  0.25 %","Nakhon Sawan :  0.51 %","Nakhon Sawan :  0.38 %","Nakhon Sawan :  0.3 %"],"hoverinfo":["text","text","text","text","text"],"name":"Nakhon Sawan","marker":{"color":"rgba(209,217,153,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(209,217,153,1)"},"error_y":{"color":"rgba(209,217,153,1)"},"error_x":{"color":"rgba(209,217,153,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.14248779385126714,0.23101841875065557,0.29229721931787439,0.18875591732789554,0.15822222053973967],"type":"bar","text":["Sukhothai :  0.14 %","Sukhothai :  0.23 %","Sukhothai :  0.29 %","Sukhothai :  0.19 %","Sukhothai :  0.16 %"],"hoverinfo":["text","text","text","text","text"],"name":"Sukhothai","marker":{"color":"rgba(220,215,170,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(220,215,170,1)"},"error_y":{"color":"rgba(220,215,170,1)"},"error_x":{"color":"rgba(220,215,170,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.13137339914445079,0.17543343649481075,0.30969102940911186,0.2102482015840173,0.14615108657454526],"type":"bar","text":["Mukdahan :  0.13 %","Mukdahan :  0.18 %","Mukdahan :  0.31 %","Mukdahan :  0.21 %","Mukdahan :  0.15 %"],"hoverinfo":["text","text","text","text","text"],"name":"Mukdahan","marker":{"color":"rgba(230,212,188,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(230,212,188,1)"},"error_y":{"color":"rgba(230,212,188,1)"},"error_x":{"color":"rgba(230,212,188,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.1272163611163068,0.13626288762979707,0.20884919311503011,0.18515081945396009,0.18361617408614508],"type":"bar","text":["Pathum Thani :  0.13 %","Pathum Thani :  0.14 %","Pathum Thani :  0.21 %","Pathum Thani :  0.19 %","Pathum Thani :  0.18 %"],"hoverinfo":["text","text","text","text","text"],"name":"Pathum Thani","marker":{"color":"rgba(240,209,205,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(240,209,205,1)"},"error_y":{"color":"rgba(240,209,205,1)"},"error_x":{"color":"rgba(240,209,205,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.12551065583015567,0.17156357200025474,0.19555399115677316,0.06778229416940329,0.054497170564664993],"type":"bar","text":["Phatthalung :  0.13 %","Phatthalung :  0.17 %","Phatthalung :  0.2 %","Phatthalung :  0.07 %","Phatthalung :  0.05 %"],"hoverinfo":["text","text","text","text","text"],"name":"Phatthalung","marker":{"color":"rgba(249,206,223,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(249,206,223,1)"},"error_y":{"color":"rgba(249,206,223,1)"},"error_x":{"color":"rgba(249,206,223,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.12245849545781642,0.16924064388337254,0.23494073692316267,0.19175893619628631,0.15359403665222454],"type":"bar","text":["Yala :  0.12 %","Yala :  0.17 %","Yala :  0.23 %","Yala :  0.19 %","Yala :  0.15 %"],"hoverinfo":["text","text","text","text","text"],"name":"Yala","marker":{"color":"rgba(249,206,228,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(249,206,228,1)"},"error_y":{"color":"rgba(249,206,228,1)"},"error_x":{"color":"rgba(249,206,228,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.11622697081580412,0.09843234401200171,0.078819068452979979,0.072527930680182304,0.077580085059059264],"type":"bar","text":["Narathiwat :  0.12 %","Narathiwat :  0.1 %","Narathiwat :  0.08 %","Narathiwat :  0.07 %","Narathiwat :  0.08 %"],"hoverinfo":["text","text","text","text","text"],"name":"Narathiwat","marker":{"color":"rgba(244,208,226,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(244,208,226,1)"},"error_y":{"color":"rgba(244,208,226,1)"},"error_x":{"color":"rgba(244,208,226,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.11612946004724273,0.18587588793170204,0.26470246581438672,0.14021525679817501,0.1086676817124671],"type":"bar","text":["Surin :  0.12 %","Surin :  0.19 %","Surin :  0.26 %","Surin :  0.14 %","Surin :  0.11 %"],"hoverinfo":["text","text","text","text","text"],"name":"Surin","marker":{"color":"rgba(239,210,224,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(239,210,224,1)"},"error_y":{"color":"rgba(239,210,224,1)"},"error_x":{"color":"rgba(239,210,224,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.11295889374165037,0.21758682189883005,0.38752397904319841,0.41561338568968109,0.32602441537962601],"type":"bar","text":["Samut Songkhram :  0.11 %","Samut Songkhram :  0.22 %","Samut Songkhram :  0.39 %","Samut Songkhram :  0.42 %","Samut Songkhram :  0.33 %"],"hoverinfo":["text","text","text","text","text"],"name":"Samut Songkhram","marker":{"color":"rgba(234,212,223,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(234,212,223,1)"},"error_y":{"color":"rgba(234,212,223,1)"},"error_x":{"color":"rgba(234,212,223,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.0998535930797326,0.19677888731137547,0.41924551550306355,0.28363084472689482,0.24965327545213406],"type":"bar","text":["Nan :  0.1 %","Nan :  0.2 %","Nan :  0.42 %","Nan :  0.28 %","Nan :  0.25 %"],"hoverinfo":["text","text","text","text","text"],"name":"Nan","marker":{"color":"rgba(229,213,221,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(229,213,221,1)"},"error_y":{"color":"rgba(229,213,221,1)"},"error_x":{"color":"rgba(229,213,221,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.091232688026129258,0.087408214214500596,0.058947531245363297,0.065824845886445479,0.074917963456214168],"type":"bar","text":["Samut Sakhon :  0.09 %","Samut Sakhon :  0.09 %","Samut Sakhon :  0.06 %","Samut Sakhon :  0.07 %","Samut Sakhon :  0.07 %"],"hoverinfo":["text","text","text","text","text"],"name":"Samut Sakhon","marker":{"color":"rgba(224,215,219,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(224,215,219,1)"},"error_y":{"color":"rgba(224,215,219,1)"},"error_x":{"color":"rgba(224,215,219,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.090799754876990102,0.16477017440042113,0.29046171244069047,0.1917082251008729,0.12461598819556666],"type":"bar","text":["Sakon Nakhon :  0.09 %","Sakon Nakhon :  0.16 %","Sakon Nakhon :  0.29 %","Sakon Nakhon :  0.19 %","Sakon Nakhon :  0.12 %"],"hoverinfo":["text","text","text","text","text"],"name":"Sakon Nakhon","marker":{"color":"rgba(218,217,217,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(218,217,217,1)"},"error_y":{"color":"rgba(218,217,217,1)"},"error_x":{"color":"rgba(218,217,217,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.082143657967063827,0.14781822478047982,0.19005575723798515,0.11644005122853299,0.086216715809573921],"type":"bar","text":["Uttaradit :  0.08 %","Uttaradit :  0.15 %","Uttaradit :  0.19 %","Uttaradit :  0.12 %","Uttaradit :  0.09 %"],"hoverinfo":["text","text","text","text","text"],"name":"Uttaradit","marker":{"color":"rgba(214,208,214,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(214,208,214,1)"},"error_y":{"color":"rgba(214,208,214,1)"},"error_x":{"color":"rgba(214,208,214,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.080762377606389532,0.11983078938636604,0.24161154069802979,0.13395566358432642,0.082553245713915535],"type":"bar","text":["Chaiyaphum :  0.08 %","Chaiyaphum :  0.12 %","Chaiyaphum :  0.24 %","Chaiyaphum :  0.13 %","Chaiyaphum :  0.08 %"],"hoverinfo":["text","text","text","text","text"],"name":"Chaiyaphum","marker":{"color":"rgba(211,195,210,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(211,195,210,1)"},"error_y":{"color":"rgba(211,195,210,1)"},"error_x":{"color":"rgba(211,195,210,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.079989256512795551,0.14923141298846898,0.22410171662809902,0.20312467570830747,0.16505764515988897],"type":"bar","text":["Nakhon Phanom :  0.08 %","Nakhon Phanom :  0.15 %","Nakhon Phanom :  0.22 %","Nakhon Phanom :  0.2 %","Nakhon Phanom :  0.17 %"],"hoverinfo":["text","text","text","text","text"],"name":"Nakhon Phanom","marker":{"color":"rgba(207,182,206,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(207,182,206,1)"},"error_y":{"color":"rgba(207,182,206,1)"},"error_x":{"color":"rgba(207,182,206,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.079415922520201451,0.13676507415370751,0.1756203036034279,0.096072631270672434,0.044413469126365263],"type":"bar","text":["Si Sa Ket :  0.08 %","Si Sa Ket :  0.14 %","Si Sa Ket :  0.18 %","Si Sa Ket :  0.1 %","Si Sa Ket :  0.04 %"],"hoverinfo":["text","text","text","text","text"],"name":"Si Sa Ket","marker":{"color":"rgba(203,169,202,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(203,169,202,1)"},"error_y":{"color":"rgba(203,169,202,1)"},"error_x":{"color":"rgba(203,169,202,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.064543697405404138,0.12423438478447511,0.27972213269879254,0.22078873327067472,0.16045999018983767],"type":"bar","text":["Phrae :  0.06 %","Phrae :  0.12 %","Phrae :  0.28 %","Phrae :  0.22 %","Phrae :  0.16 %"],"hoverinfo":["text","text","text","text","text"],"name":"Phrae","marker":{"color":"rgba(198,156,198,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(198,156,198,1)"},"error_y":{"color":"rgba(198,156,198,1)"},"error_x":{"color":"rgba(198,156,198,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.061681793006310659,0.11615776182077994,0.21523079061444031,0.12741208823616273,0.093482598165963063],"type":"bar","text":["Lamphun :  0.06 %","Lamphun :  0.12 %","Lamphun :  0.22 %","Lamphun :  0.13 %","Lamphun :  0.09 %"],"hoverinfo":["text","text","text","text","text"],"name":"Lamphun","marker":{"color":"rgba(194,143,194,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(194,143,194,1)"},"error_y":{"color":"rgba(194,143,194,1)"},"error_x":{"color":"rgba(194,143,194,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.060852951473538745,0.1096747609166297,0.17260394015740102,0.12173244554986026,0.084778803797028013],"type":"bar","text":["Kamphaeng Phet :  0.06 %","Kamphaeng Phet :  0.11 %","Kamphaeng Phet :  0.17 %","Kamphaeng Phet :  0.12 %","Kamphaeng Phet :  0.08 %"],"hoverinfo":["text","text","text","text","text"],"name":"Kamphaeng Phet","marker":{"color":"rgba(189,130,190,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(189,130,190,1)"},"error_y":{"color":"rgba(189,130,190,1)"},"error_x":{"color":"rgba(189,130,190,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.054953183393737219,0.098741478932499321,0.19709531973084185,0.10041718911772717,0.066803377194330812],"type":"bar","text":["Phichit :  0.05 %","Phichit :  0.1 %","Phichit :  0.2 %","Phichit :  0.1 %","Phichit :  0.07 %"],"hoverinfo":["text","text","text","text","text"],"name":"Phichit","marker":{"color":"rgba(191,141,190,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(191,141,190,1)"},"error_y":{"color":"rgba(191,141,190,1)"},"error_x":{"color":"rgba(191,141,190,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.05320532119636593,0.10058493247881377,0.16160747231982497,0.07199776922813296,0.070283673785206294],"type":"bar","text":["Roi Et :  0.05 %","Roi Et :  0.1 %","Roi Et :  0.16 %","Roi Et :  0.07 %","Roi Et :  0.07 %"],"hoverinfo":["text","text","text","text","text"],"name":"Roi Et","marker":{"color":"rgba(194,157,192,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(194,157,192,1)"},"error_y":{"color":"rgba(194,157,192,1)"},"error_x":{"color":"rgba(194,157,192,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.051437296997976285,0.10464406325122547,0.22773958353141166,0.16914547572156979,0.12875876229540703],"type":"bar","text":["Phayao :  0.05 %","Phayao :  0.1 %","Phayao :  0.23 %","Phayao :  0.17 %","Phayao :  0.13 %"],"hoverinfo":["text","text","text","text","text"],"name":"Phayao","marker":{"color":"rgba(197,172,193,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(197,172,193,1)"},"error_y":{"color":"rgba(197,172,193,1)"},"error_x":{"color":"rgba(197,172,193,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.049652410035098599,0.099190670898610167,0.17241334576383338,0.11758151188529312,0.081441993118232484],"type":"bar","text":["Uthai Thani :  0.05 %","Uthai Thani :  0.1 %","Uthai Thani :  0.17 %","Uthai Thani :  0.12 %","Uthai Thani :  0.08 %"],"hoverinfo":["text","text","text","text","text"],"name":"Uthai Thani","marker":{"color":"rgba(200,188,194,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(200,188,194,1)"},"error_y":{"color":"rgba(200,188,194,1)"},"error_x":{"color":"rgba(200,188,194,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.048995861965574268,0.065662780664067485,0.15944049693208864,0.094020214936304053,0.060083962460544045],"type":"bar","text":["Chai Nat :  0.05 %","Chai Nat :  0.07 %","Chai Nat :  0.16 %","Chai Nat :  0.09 %","Chai Nat :  0.06 %"],"hoverinfo":["text","text","text","text","text"],"name":"Chai Nat","marker":{"color":"rgba(202,203,195,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(202,203,195,1)"},"error_y":{"color":"rgba(202,203,195,1)"},"error_x":{"color":"rgba(202,203,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.04552543171756377,0.065637545160353389,0.11258742296550621,0.05939928908760754,0.044874455780068948],"type":"bar","text":["Kalasin :  0.05 %","Kalasin :  0.07 %","Kalasin :  0.11 %","Kalasin :  0.06 %","Kalasin :  0.04 %"],"hoverinfo":["text","text","text","text","text"],"name":"Kalasin","marker":{"color":"rgba(203,218,196,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(203,218,196,1)"},"error_y":{"color":"rgba(203,218,196,1)"},"error_x":{"color":"rgba(203,218,196,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.043902940508342848,0.076530450338541223,0.098748612649943321,0.053469779003904448,0.038503070705369721],"type":"bar","text":["Maha Sarakham :  0.04 %","Maha Sarakham :  0.08 %","Maha Sarakham :  0.1 %","Maha Sarakham :  0.05 %","Maha Sarakham :  0.04 %"],"hoverinfo":["text","text","text","text","text"],"name":"Maha Sarakham","marker":{"color":"rgba(204,234,197,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(204,234,197,1)"},"error_y":{"color":"rgba(204,234,197,1)"},"error_x":{"color":"rgba(204,234,197,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.039237453472700128,0.074475018561028422,0.090615204072263672,0.087256276828071147,0.050384925382288448],"type":"bar","text":["Bueng Kan :  0.04 %","Bueng Kan :  0.07 %","Bueng Kan :  0.09 %","Bueng Kan :  0.09 %","Bueng Kan :  0.05 %"],"hoverinfo":["text","text","text","text","text"],"name":"Bueng Kan","marker":{"color":"rgba(212,235,186,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(212,235,186,1)"},"error_y":{"color":"rgba(212,235,186,1)"},"error_x":{"color":"rgba(212,235,186,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.038348125936873201,0.052296796121898637,0.087254942046538664,0.052094125288326007,0.031435626312495399],"type":"bar","text":["Pattani :  0.04 %","Pattani :  0.05 %","Pattani :  0.09 %","Pattani :  0.05 %","Pattani :  0.03 %"],"hoverinfo":["text","text","text","text","text"],"name":"Pattani","marker":{"color":"rgba(221,235,174,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(221,235,174,1)"},"error_y":{"color":"rgba(221,235,174,1)"},"error_x":{"color":"rgba(221,235,174,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.037153802312914368,0.055230423428661843,0.10811674142943066,0.061257159219571727,0.054979527460593355],"type":"bar","text":["Ang Thong :  0.04 %","Ang Thong :  0.06 %","Ang Thong :  0.11 %","Ang Thong :  0.06 %","Ang Thong :  0.05 %"],"hoverinfo":["text","text","text","text","text"],"name":"Ang Thong","marker":{"color":"rgba(229,236,162,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(229,236,162,1)"},"error_y":{"color":"rgba(229,236,162,1)"},"error_x":{"color":"rgba(229,236,162,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.032171955152202142,0.048367628193614502,0.10672457368511055,0.070750276280962962,0.040988124586924662],"type":"bar","text":["Sing Buri :  0.03 %","Sing Buri :  0.05 %","Sing Buri :  0.11 %","Sing Buri :  0.07 %","Sing Buri :  0.04 %"],"hoverinfo":["text","text","text","text","text"],"name":"Sing Buri","marker":{"color":"rgba(236,236,150,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(236,236,150,1)"},"error_y":{"color":"rgba(236,236,150,1)"},"error_x":{"color":"rgba(236,236,150,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.030516471577678488,0.04100643176021386,0.075172914836903512,0.039144355559573102,0.022362432042248116],"type":"bar","text":["Yasothon :  0.03 %","Yasothon :  0.04 %","Yasothon :  0.08 %","Yasothon :  0.04 %","Yasothon :  0.02 %"],"hoverinfo":["text","text","text","text","text"],"name":"Yasothon","marker":{"color":"rgba(243,236,138,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(243,236,138,1)"},"error_y":{"color":"rgba(243,236,138,1)"},"error_x":{"color":"rgba(243,236,138,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.016103573504262527,0.026198238180784653,0.057841255091394643,0.022028899847587342,0.015160660412532988],"type":"bar","text":["Amnat Charoen :  0.02 %","Amnat Charoen :  0.03 %","Amnat Charoen :  0.06 %","Amnat Charoen :  0.02 %","Amnat Charoen :  0.02 %"],"hoverinfo":["text","text","text","text","text"],"name":"Amnat Charoen","marker":{"color":"rgba(249,237,125,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(249,237,125,1)"},"error_y":{"color":"rgba(249,237,125,1)"},"error_x":{"color":"rgba(249,237,125,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[2019,2020,2021,2022,2023],"y":[0.014973035119888976,0.0224558129799848,0.024230348121380797,0.019284968575763305,0.012834356901789907],"type":"bar","text":["Nong Bua Lam Phu :  0.01 %","Nong Bua Lam Phu :  0.02 %","Nong Bua Lam Phu :  0.02 %","Nong Bua Lam Phu :  0.02 %","Nong Bua Lam Phu :  0.01 %"],"hoverinfo":["text","text","text","text","text"],"name":"Nong Bua Lam Phu","marker":{"color":"rgba(255,237,111,1)","line":{"color":"grey","width":0.5}},"textfont":{"color":"rgba(255,237,111,1)"},"error_y":{"color":"rgba(255,237,111,1)"},"error_x":{"color":"rgba(255,237,111,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Observations:</strong></p>
<ul>
<li><p>The revenue distribution across provinces is highly skewed, with a few provinces such as Bangkok, Phucket consistently contributing a significant portion of the total revenue.</p></li>
<li><p>This pattern remains even during the COVID period, although the skewness slightly decreases.</p></li>
</ul>
</div>
</div>
<section id="determining-key-economic-indicators" class="level3" data-number="9.1"><h3 data-number="9.1" class="anchored" data-anchor-id="determining-key-economic-indicators">
<span class="header-section-number">9.1</span> Determining Key Economic Indicators</h3>
<p>In this section, we select four key economic indicators or Key Performance Indicators (KPI) for further geospatial analysis.</p>
<p>The selection is based on the following criteria:</p>
<ul>
<li><strong>Economic significance</strong></li>
<li>
<strong>Low to moderate correlation:</strong> To avoid redundancy and ensure each indicator captures distinct information.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">correlation_matrix</span> <span class="op">&lt;-</span> <span class="va">tourism_df_ft</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="fl">7</span><span class="op">:</span><span class="fl">21</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span>use <span class="op">=</span> <span class="st">"complete.obs"</span><span class="op">)</span>  <span class="co"># Use "complete.obs" to handle NA values</span></span>
<span><span class="fu">corrplot</span><span class="op">(</span><span class="va">correlation_matrix</span>, method <span class="op">=</span> <span class="st">"circle"</span>, type <span class="op">=</span> <span class="st">"lower"</span>, </span>
<span>         tl.col <span class="op">=</span> <span class="st">"black"</span>, tl.srt <span class="op">=</span> <span class="fl">45</span>, </span>
<span>         addCoef.col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>  <span class="co"># Add correlation coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/viz_feat_corrplot-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We will select the following economic indictators:</p>
<ul>
<li><p><strong>Total number of tourists (<code>no_tourist_all</code>)</strong>: This captures the overall tourism demand across provinces, providing a broad view of how tourism is distributed. Since it is highly correlated with both foreign and domestic tourist numbers, we don’t have to analyse <code>no_tourist_thai</code> and <code>no_tourist_foreign</code> separately.</p></li>
<li><p><strong>Revenue from foreign tourists (<code>revenue_foreign</code>)</strong>: This indicator is crucial for understanding the economic impact of international tourists, and it can indictate foreign revenue inflow to the Thai economy.</p></li>
<li><p><strong>Revenue from thai tourists (<code>revenue_thai</code>)</strong>: We will also analyse the revenue from Thai tourist to compare against <code>revenue_foreign</code></p></li>
<li><p><strong>Average revenue per tourist (<code>avg_revenue_all</code>)</strong>: This indicator reflects the quality of tourism by measuring spending per tourist. It also has a low correlation with other indicator, making it a distinct measure.</p></li>
</ul>
</div>
</div>
</section><section id="creating-the-derived-tourism-economy-indicators-layer-in-spacetime" class="level3" data-number="9.2"><h3 data-number="9.2" class="anchored" data-anchor-id="creating-the-derived-tourism-economy-indicators-layer-in-spacetime">
<span class="header-section-number">9.2</span> Creating the Derived Tourism Economy Indicators Layer in spacetime</h3>
<p>In this subsection, we will create a <strong>derived tourism economy indictator layer in spacetime s3 class of sfdep.</strong> This is in preparation of the creation of space time cubes for emerging hot spot analysis in later sections.</p>
<p>The code below create the spacetime object using <code>tourism_df_ft</code> and <code>admin_boundary</code>. Then we use <code>is_spacetime()</code> to verify that <code>tourism_st</code> is a valid spacetime cube object.</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tourism_st</span> <span class="op">&lt;-</span> <span class="fu">spacetime</span><span class="op">(</span></span>
<span>  .data <span class="op">=</span> <span class="va">tourism_df_ft</span>, </span>
<span>  .geometry <span class="op">=</span> <span class="va">admin_boundary</span>, </span>
<span>  .loc_col <span class="op">=</span> <span class="st">"province_eng"</span>, </span>
<span>  .time_col <span class="op">=</span> <span class="st">"date_int"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu">is_spacetime_cube</span><span class="op">(</span><span class="va">tourism_st</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we save <code>tourism_st</code> for future analysis.</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">write_rds</span><span class="op">(</span><span class="va">tourism_st</span>, file <span class="op">=</span> <span class="st">"data/rds/tourism_st.rds"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tourism_st</span> <span class="op">&lt;-</span> <span class="fu">read_rds</span><span class="op">(</span><span class="st">"data/rds/tourism_st.rds"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="spatial-independence-of-thailands-tourism-economy-indictators" class="level2" data-number="10"><h2 data-number="10" class="anchored" data-anchor-id="spatial-independence-of-thailands-tourism-economy-indictators">
<span class="header-section-number">10</span> Spatial Independence of Thailand’s Tourism Economy Indictators</h2>
<p>In this section, we explore whether key tourism economy indicators in Thailand exhibit spatial dependence or independence. This involves creating spatial weight matrices, computing global and local Moran’s I statistics, and analyzing patterns of spatial autocorrelation.</p>
<section id="creating-spatial-weight-matrix" class="level3" data-number="10.1"><h3 data-number="10.1" class="anchored" data-anchor-id="creating-spatial-weight-matrix">
<span class="header-section-number">10.1</span> Creating Spatial Weight Matrix</h3>
<p>To analyze spatial autocorrelation, we need to define how provinces in Thailand are related to each other spatially. The spatial relationships are captured using <strong>spatial weight matrices</strong>, which define the “neighborhood” structure for each province.</p>
<section id="choice-of-neighbors" class="level4" data-number="10.1.1"><h4 data-number="10.1.1" class="anchored" data-anchor-id="choice-of-neighbors">
<span class="header-section-number">10.1.1</span> Choice of Neighbors</h4>
<ul>
<li>
<strong><code>st_contiguity</code></strong>: This method defines neighbors based on <strong>shared boundaries</strong> (either Rook or Queen contiguity). Provinces are considered neighbors if they touch along a boundary or corner.</li>
<li>
<strong><code>st_dist_band</code></strong>: Defines neighbors based on a <strong>fixed distance band</strong>. Provinces within a certain distance are considered neighbors.</li>
<li>
<strong><code>st_knn</code></strong>: Defines neighbors based on the <strong>k-nearest neighbors</strong> approach, where each province has a fixed number of nearest neighbors. The distance band is adaptive.</li>
</ul>
<p>For this study, we will use the <strong><code>st_knn</code></strong> method for these reasons:</p>
<ol type="1">
<li><p>From general knowledge, we understand that Thailand has several islands such as Phuket; This makes <code>st_contiguity</code> the least ideal choice.</p></li>
<li><p>Using <code>st_knn</code>, it allows us to define a fixed number of neighbors for each province, ensuring that each province has the same number of neighbors, making the analysis more balanced and suitable for regions with varying geographic sizes and shapes.</p></li>
</ol></section><section id="choice-of-k" class="level4" data-number="10.1.2"><h4 data-number="10.1.2" class="anchored" data-anchor-id="choice-of-k">
<span class="header-section-number">10.1.2</span> Choice of K</h4>
<p>We choose the number of neighbors <code>k</code> as the square root of the total number of provinces (77), which is approximately 9 (since <span class="math inline">\(\sqrt{77} \approx 8.77\)</span>). This is a common rule of thumb in spatial analysis, providing a reasonable number of neighbors to capture both local and slightly broader spatial interactions.</p>
<p>It is also important to choose an <strong>odd value for <code>k</code> (e.g., 9)</strong> to avoid ties when calculating spatial statistics.</p>
<p><code>k</code> should also be reasonably small to ensure that the spatial relationships remain localized. If <code>k</code> is too large, spatial patterns may become diluted. For this reason, we will also try <code>k=5</code>.</p>
</section><section id="choice-of-weights" class="level4" data-number="10.1.3"><h4 data-number="10.1.3" class="anchored" data-anchor-id="choice-of-weights">
<span class="header-section-number">10.1.3</span> Choice of Weights</h4>
<ul>
<li>
<strong><code>st_weights</code> (binary)</strong>: Neighbors either exist or don’t, with a binary weight of 1 for neighbors and 0 for non-neighbors.</li>
<li>
<strong><code>st_kernel_weights</code></strong>: Assigns weights based on a <strong>kernel function</strong> (such as Gaussian), where closer neighbors have higher weights, and the influence decays with distance.</li>
<li>
<strong><code>st_inverse_distance</code></strong>: Assigns weights based on the <strong>inverse of distance</strong> between provinces. Closer provinces have higher weights, and farther provinces have smaller weights.</li>
</ul>
<p>According to Tobler’s First Law of Geography, <strong>“everything is related to everything else, but near things are more related than distant things.”</strong> Using <code>st_inverse_distance</code> allows us to capture this principle, with closer provinces being assigned greater weights.</p>
<p>In the step below, We use sum for the variables like <code>no_tourist_all, revenue_foreign, and revenue_thai</code> because these are cumulative metrics and we use take the mean for <code>avg_revenue_all</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tourism_agg</span> <span class="op">&lt;-</span> <span class="va">tourism</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">province_eng</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    no_tourist_all <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">no_tourist_all</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>    revenue_foreign <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">revenue_foreign</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>    revenue_thai <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">revenue_thai</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    avg_revenue_all <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">avg_revenue_all</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    geometry <span class="op">=</span> <span class="fu">st_union</span><span class="op">(</span><span class="va">geometry</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we compute centroids for each province, which will be used for plotting and spatial weighting.</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># compute centroid using st_centroid</span></span>
<span><span class="va">longitude</span> <span class="op">&lt;-</span> <span class="fu">map_dbl</span><span class="op">(</span><span class="va">tourism_agg</span><span class="op">$</span><span class="va">geometry</span>, <span class="op">~</span><span class="fu">st_centroid</span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">latitude</span> <span class="op">&lt;-</span> <span class="fu">map_dbl</span><span class="op">(</span><span class="va">tourism_agg</span><span class="op">$</span><span class="va">geometry</span>, <span class="op">~</span><span class="fu">st_centroid</span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">longitude</span>, <span class="va">latitude</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We compute K-nearest neighbors using <code>k = 9</code> and <code>k = 5</code>, and visually compare the results to determine the most appropriate value.</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nb_knn_9</span> <span class="op">&lt;-</span> <span class="fu">st_knn</span><span class="op">(</span><span class="va">tourism_agg</span><span class="op">$</span><span class="va">geometry</span>, k <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nb_knn_5</span> <span class="op">&lt;-</span> <span class="fu">st_knn</span><span class="op">(</span><span class="va">tourism_agg</span><span class="op">$</span><span class="va">geometry</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">tourism_agg</span><span class="op">$</span><span class="va">geometry</span>,</span>
<span>     main<span class="op">=</span><span class="st">"K = 5"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">nb_knn_5</span>,</span>
<span>     <span class="va">coords</span>,</span>
<span>     pch <span class="op">=</span> <span class="fl">19</span>,</span>
<span>     cex <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>     add <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>     col<span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">tourism_agg</span><span class="op">$</span><span class="va">geometry</span>,</span>
<span>     main<span class="op">=</span><span class="st">"K = 9"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">nb_knn_9</span>,</span>
<span>     <span class="va">coords</span>,</span>
<span>     pch <span class="op">=</span> <span class="fl">19</span>,</span>
<span>     cex <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>     add <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>     col<span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/compare_knn-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>From the plot above, <code>K = 9</code> results in a more congested view, whereas <code>K = 5</code> offers a clearer spatial relationship, making it a more appropriate choice.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">knn5_weights</span> <span class="op">&lt;-</span> <span class="fu">st_weights</span><span class="op">(</span><span class="va">nb_knn_5</span>, style <span class="op">=</span> <span class="st">"W"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using <code>st_weights</code>, each neighbour has the same weight of 0.2 (1/5), regardless of distance.</p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">knn5_weights_inv</span> <span class="op">&lt;-</span> <span class="fu">st_inverse_distance</span><span class="op">(</span><span class="va">nb_knn_5</span>,</span>
<span>                                    <span class="va">tourism_agg</span><span class="op">$</span><span class="va">geometry</span>,</span>
<span>                                    <span class="co"># default=100; lower more agressive</span></span>
<span>                                    scale<span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                    <span class="co"># default</span></span>
<span>                                    alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, we selected <code>st_inverse_distance</code> to assign weights based on distance, ensuring closer provinces are weighted more heavily. After experimenting with various parameters, setting <code>scale = 1 and alpha = 1</code> produces a reasonable range of weights, with <strong>values typically between 0 and 6</strong>, reflecting distance-based proximity effects.</p>
</section></section><section id="global-spatial-autocorrelation-analysis" class="level3" data-number="10.2"><h3 data-number="10.2" class="anchored" data-anchor-id="global-spatial-autocorrelation-analysis">
<span class="header-section-number">10.2</span> Global Spatial Autocorrelation Analysis</h3>
<p>In this section, we compute Global Moran’s I to determine whether Thailand’s tourism economy indicators exhibit overall spatial autocorrelation. Global Moran’s I is a statistical measure used to evaluate the degree to which similar values in a dataset are clustered together or dispersed across a geographic space.</p>
<p>In simpler terms, it measures whether similar values occur near each other (positive autocorrelation) or if dissimilar values are found near each other (negative autocorrelation).</p>
<ul>
<li>
<strong>Null Hypothesis (<span class="math inline">\(H_0\)</span>)</strong>: The tourism economy indicators are spatially independent, meaning they are randomly distributed across space.</li>
<li>
<strong>Alternative Hypothesis (<span class="math inline">\(H_1\)</span>)</strong>: The tourism economy indicators show spatial dependence, meaning similar values are either clustered together or systematically dispersed across space.</li>
</ul>
<p>We will use an <strong>alpha value (α) of 0.05 (95% confidence level)</strong> to determine the statistical significance.</p>
<p>We will also focus on <code>global_moran_perm</code> as it performs permutation testing which ensures a more robust and accurate p-value estimation as compared to <code>global_moran</code>. <code>global_moran</code> does not allow for formal hypothesis testing, as it only returns the Moran’s I value, not the associated p-value or significance level.</p>
<p>The code below shows a list of function that applies <code>global_moran_perm</code> on multiple tourism KPIs iteratively, formats the results with p-values, and interprets whether spatial dependence exists based on a 95% confidence level.</p>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">kpis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"no_tourist_all"</span>, <span class="st">"revenue_foreign"</span>, <span class="st">"revenue_thai"</span>, <span class="st">"avg_revenue_all"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Function to compute Global Moran's I for each KPI</span></span>
<span><span class="va">compute_global_moran_perm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">tourism_data</span>, <span class="va">kpi_column</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">global_moran_perm</span><span class="op">(</span><span class="va">tourism_data</span><span class="op">[[</span><span class="va">kpi_column</span><span class="op">]</span><span class="op">]</span>, </span>
<span>                    <span class="va">nb_knn_5</span>, </span>
<span>                    <span class="va">knn5_weights_inv</span>,</span>
<span>                    nsim <span class="op">=</span> <span class="fl">99</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">extract_moran_info</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">moran_result</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    moran_I <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">moran_result</span><span class="op">$</span><span class="va">statistic</span>,  scientific <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    p_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">moran_result</span><span class="op">$</span><span class="va">p.value</span>, scientific <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    interpretation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">moran_result</span><span class="op">$</span><span class="va">p.value</span> <span class="op">&lt;</span> <span class="fl">0.05</span>,</span>
<span>                            <span class="st">"Spatial dependence detected"</span>,</span>
<span>                            <span class="st">"No spatial dependence"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Apply the function to each KPI and store results</span></span>
<span><span class="va">gmp_results</span> <span class="op">&lt;-</span> <span class="fu">map</span><span class="op">(</span><span class="va">kpis</span>, <span class="op">~</span><span class="fu">compute_global_moran_perm</span><span class="op">(</span><span class="va">tourism_agg</span>, <span class="va">.x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Naming the results for easier interpretation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">gmp_results</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">kpis</span></span>
<span></span>
<span><span class="co"># Apply the extraction function to each KPI result</span></span>
<span><span class="va">moran_summary</span> <span class="op">&lt;-</span> <span class="fu">map_df</span><span class="op">(</span><span class="va">gmp_results</span>, <span class="va">extract_moran_info</span>, .id <span class="op">=</span> <span class="st">"kpi"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gmp_results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$no_tourist_all

    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = -0.020104, observed rank = 53, p-value = 0.94
alternative hypothesis: two.sided


$revenue_foreign

    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = -0.021885, observed rank = 52, p-value = 0.96
alternative hypothesis: two.sided


$revenue_thai

    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = -0.072233, observed rank = 11, p-value = 0.22
alternative hypothesis: two.sided


$avg_revenue_all

    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = 0.32153, observed rank = 100, p-value &lt; 2.2e-16
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">datatable</span><span class="op">(</span><span class="va">moran_summary</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-e3479f292a01744eb530" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e3479f292a01744eb530">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4"],["no_tourist_all","revenue_foreign","revenue_thai","avg_revenue_all"],["-2.010351e-02","-2.188518e-02","-7.223272e-02","3.21529e-01"],["9.4e-01","9.6e-01","2.2e-01","0e+00"],["No spatial dependence","No spatial dependence","No spatial dependence","Spatial dependence detected"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>kpi<\/th>\n      <th>moran_I<\/th>\n      <th>p_value<\/th>\n      <th>interpretation<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"kpi","targets":1},{"name":"moran_I","targets":2},{"name":"p_value","targets":3},{"name":"interpretation","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Observations:</strong></p>
<ul>
<li><p><code>no_tourist_all</code>, <code>revenue_foreign</code>, and <code>revenue_thai</code> has high p-values (&gt; 0.05). This means we <strong>fail to reject the null hypothesis</strong> indicating these indictators are spatially independent.</p></li>
<li><p>For <code>avg_revenue_all</code>, the p-value of 2.2e-16 means that we <strong>can reject the null hypothesis</strong>. From the conclude that positive Moran’s I value, we can conclude that there is significant <strong>spatial dependence</strong>. Provinces with similar values for average revenue per tourist tend to cluster together.</p></li>
</ul>
</div>
</div>
</section><section id="local-spatial-autocorrelation-analysis" class="level3" data-number="10.3"><h3 data-number="10.3" class="anchored" data-anchor-id="local-spatial-autocorrelation-analysis">
<span class="header-section-number">10.3</span> Local Spatial Autocorrelation Analysis</h3>
<p>While global indicators such asGlobal Moran’s I provides an overall measure of spatial autocorrelation for the entire study area, Local Indicators of Spatial Association (LISA) such as Local Moran’s I helps identify <strong>specific clusters</strong> or <strong>outliers</strong>.</p>
<p>In this section, we will compute the Local Moran’s I for the selected KPIs and visualize these clusters using LISA map.</p>
<p>In the code block below, we will use a custom function to compute the Local Moran’s I iteratively for the KPIs and save the results into <code>lmp_summary.rds</code>.</p>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">kpis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"no_tourist_all"</span>, <span class="st">"revenue_foreign"</span>, <span class="st">"revenue_thai"</span>, <span class="st">"avg_revenue_all"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Function to compute Local Moran's I for each KPI and add it to the data frame</span></span>
<span><span class="va">compute_local_moran_df</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">kpi_column</span>, <span class="va">nb</span>, <span class="va">wt</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>local_moran <span class="op">=</span> <span class="fu">local_moran</span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu">sym</span><span class="op">(</span><span class="va">kpi_column</span><span class="op">)</span>, <span class="va">nb</span>, <span class="va">wt</span>, nsim <span class="op">=</span> <span class="fl">99</span><span class="op">)</span>,</span>
<span>           kpi <span class="op">=</span> <span class="va">kpi_column</span>,  </span>
<span>           .before <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">unnest</span><span class="op">(</span><span class="va">local_moran</span><span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Apply the function to each KPI and combine into a single data frame</span></span>
<span><span class="va">lmp_summary</span> <span class="op">&lt;-</span> <span class="fu">map_df</span><span class="op">(</span><span class="va">kpis</span>, <span class="op">~</span><span class="fu">compute_local_moran_df</span><span class="op">(</span><span class="va">tourism_agg</span>, </span>
<span>                                                    <span class="va">.x</span>, </span>
<span>                                                    <span class="va">nb_knn_5</span>, </span>
<span>                                                    <span class="va">knn5_weights_inv</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">write_rds</span><span class="op">(</span><span class="va">lmp_summary</span>, file <span class="op">=</span> <span class="st">"data/rds/lmp_summary.rds"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here, we load and inspect the summary data for Local Moran’s I results:</p>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lmp_summary</span> <span class="op">&lt;-</span> <span class="fu">read_rds</span><span class="op">(</span><span class="st">"data/rds/lmp_summary.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">lmp_summary</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 6 features and 18 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 100.1913 ymin: 13.17847 xmax: 105.0603 ymax: 18.44898
Projected CRS: WGS 84 / UTM zone 47N
# A tibble: 6 × 19
       ii      eii  var_ii   z_ii  p_ii p_ii_sim p_folded_sim skewness kurtosis
    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1   1.19    0.0338   3.35   0.631 0.528     0.2          0.1    -3.69    15.4  
2  -0.351   0.490    4.83  -0.383 0.702     0.34         0.17   -3.19    12.1  
3 -21.7   -12.0    534.    -0.419 0.675     0.76         0.38    0.769    0.131
4   0.584  -0.0891   1.56   0.539 0.590     0.52         0.26   -2.73     8.19 
5   0.117  -0.0486   0.206  0.364 0.716     0.72         0.36   -4.02    21.2  
6   0.253  -0.0208   0.141  0.730 0.465     0.18         0.09    3.55    14.1  
# ℹ 10 more variables: mean &lt;fct&gt;, median &lt;fct&gt;, pysal &lt;fct&gt;, kpi &lt;chr&gt;,
#   province_eng &lt;chr&gt;, no_tourist_all &lt;dbl&gt;, revenue_foreign &lt;dbl&gt;,
#   revenue_thai &lt;dbl&gt;, avg_revenue_all &lt;dbl&gt;, geometry &lt;MULTIPOLYGON [m]&gt;</code></pre>
</div>
</div>
<section id="visualization-of-local-morans-i-maps" class="level4" data-number="10.3.1"><h4 data-number="10.3.1" class="anchored" data-anchor-id="visualization-of-local-morans-i-maps">
<span class="header-section-number">10.3.1</span> Visualization of Local Moran’s I Maps</h4>
<p>In this subsection, we will visualize the Local Moran’s I values on choropleth maps.</p>
<p>Similarly, we will implement a list of custom functions to process there KPIs iteratively.</p>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kpis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"no_tourist_all"</span>, <span class="st">"revenue_foreign"</span>, <span class="st">"revenue_thai"</span>, <span class="st">"avg_revenue_all"</span><span class="op">)</span></span>
<span><span class="co"># kpis &lt;- c("no_tourist_all")</span></span>
<span></span>
<span><span class="va">p_value_palette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"orange"</span>, <span class="st">"yellow"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Function to create maps for a given KPI</span></span>
<span><span class="va">plot_local_moran_kpi</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">kpi_name</span>, <span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Filter the data for the current KPI</span></span>
<span>  <span class="va">kpi_data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">kpi</span> <span class="op">==</span> <span class="va">kpi_name</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">tmap_mode</span><span class="op">(</span><span class="st">"plot"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Map 1: Moran's I</span></span>
<span>  <span class="va">map1</span> <span class="op">&lt;-</span> <span class="fu">tm_shape</span><span class="op">(</span><span class="va">kpi_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">tm_fill</span><span class="op">(</span><span class="st">"ii"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">tm_borders</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">tm_view</span><span class="op">(</span>set.zoom.limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">tm_layout</span><span class="op">(</span></span>
<span>      main.title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Local Moran's I of"</span>, <span class="va">kpi_name</span><span class="op">)</span>,</span>
<span>      main.title.size <span class="op">=</span> <span class="fl">0.8</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Map 2: p-value</span></span>
<span>  <span class="va">map2</span> <span class="op">&lt;-</span> <span class="fu">tm_shape</span><span class="op">(</span><span class="va">kpi_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">tm_fill</span><span class="op">(</span></span>
<span>      <span class="st">"p_ii_sim"</span>, </span>
<span>      breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"&lt;0.001"</span>, <span class="st">"0.001-0.01"</span>, <span class="st">"0.01-0.05"</span>, <span class="st">"Not sig"</span><span class="op">)</span>, </span>
<span>      palette <span class="op">=</span> <span class="va">p_value_palette</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">tm_borders</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">tm_view</span><span class="op">(</span>set.zoom.limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">tm_layout</span><span class="op">(</span></span>
<span>      main.title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"p-value of Local Moran's I for"</span>, <span class="va">kpi_name</span><span class="op">)</span>,</span>
<span>      main.title.size <span class="op">=</span> <span class="fl">0.8</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Return the arranged maps</span></span>
<span>  <span class="fu">tmap_arrange</span><span class="op">(</span><span class="va">map1</span>, <span class="va">map2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Function to plot LISA map for a given KPI</span></span>
<span><span class="va">plot_lisa_kpi</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">kpi_name</span>, <span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Filter the data for the selected KPI</span></span>
<span>  <span class="va">kpi_data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">kpi</span> <span class="op">==</span> <span class="va">kpi_name</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Filter significant LISA results (p_ii_sim &lt; 0.05)</span></span>
<span>  <span class="va">lisa_sig</span> <span class="op">&lt;-</span> <span class="va">kpi_data</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">p_ii_sim</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">tmap_mode</span><span class="op">(</span><span class="st">"plot"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">tm_shape</span><span class="op">(</span><span class="va">kpi_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">tm_polygons</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">tm_borders</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">tm_layout</span><span class="op">(</span></span>
<span>      main.title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"LISA Map for"</span>, <span class="va">kpi_name</span><span class="op">)</span>,</span>
<span>      main.title.size <span class="op">=</span> <span class="fl">0.8</span></span>
<span>    <span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">tm_shape</span><span class="op">(</span><span class="va">lisa_sig</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">tm_fill</span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Function to plot LISA maps for multiple KPIs side by side</span></span>
<span><span class="va">plot_lisa_multiple_kpis</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">kpi_list</span>, <span class="va">data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">tmap_mode</span><span class="op">(</span><span class="st">"plot"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">map_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Loop through each KPI and create a LISA map</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">kpi_name</span> <span class="kw">in</span> <span class="va">kpi_list</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Filter the data for the selected KPI</span></span>
<span>    <span class="va">kpi_data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">kpi</span> <span class="op">==</span> <span class="va">kpi_name</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Filter significant LISA results (p_ii_sim &lt; 0.05)</span></span>
<span>    <span class="va">lisa_sig</span> <span class="op">&lt;-</span> <span class="va">kpi_data</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">p_ii_sim</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">map</span> <span class="op">&lt;-</span> <span class="fu">tm_shape</span><span class="op">(</span><span class="va">kpi_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">tm_polygons</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu">tm_borders</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">tm_layout</span><span class="op">(</span></span>
<span>        main.title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"LISA Map for"</span>, <span class="va">kpi_name</span><span class="op">)</span>,</span>
<span>        main.title.size <span class="op">=</span> <span class="fl">0.8</span></span>
<span>      <span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu">tm_shape</span><span class="op">(</span><span class="va">lisa_sig</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">tm_fill</span><span class="op">(</span><span class="st">"mean"</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">map_list</span><span class="op">[[</span><span class="va">kpi_name</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">map</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="fu">tmap_arrange</span><span class="op">(</span><span class="va">map_list</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">kpi_list</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>For each KPI, the visualization has two maps:</p>
<ol type="1">
<li>
<strong>Local Moran’s I Map</strong>: Shows the Moran’s I values for each region to identify spatial clusters and outliers.</li>
<li>
<strong>P-value Map</strong>: Displays the statistical significance of the Local Moran’s I results specifically regions with <strong>p &lt; 0.05</strong> indicating significant spatial patterns.</li>
</ol>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Total no. of tourists</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Revenue</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Avg Revenue / Tourist</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_local_moran_kpi</span><span class="op">(</span><span class="st">"no_tourist_all"</span>,<span class="va">lmp_summary</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lm_no_tourist_all-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_lisa_kpi</span><span class="op">(</span><span class="st">"no_tourist_all"</span>, <span class="va">lmp_summary</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lisa_no_tourist_all-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Observations:</strong></p>
<p>This LISA map shows the local spatial autocorrelation for the <strong>total number of tourists</strong> across Thailand.</p>
<ul>
<li><p><strong>Light Green (Low-Low)</strong>: These areas, mostly in the northwest and northeast regions of Thailand, are clusters of provinces with <strong>low numbers of tourists</strong>, surrounded by other provinces with similarly low tourist numbers.</p></li>
<li><p><strong>Light Purple (Low-High)</strong>: Samut Prakan is shown as a <strong>Low-High outlier</strong>, meaning it has a <strong>low number of tourists</strong> compared to its neighboring provinces, which have higher tourist numbers.</p></li>
<li><p>Other areas shown in grey indicate no statistically significant local spatial autocorrelation.</p></li>
</ul>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_local_moran_kpi</span><span class="op">(</span><span class="st">"revenue_foreign"</span>,<span class="va">lmp_summary</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lm_revenue_foreign-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_local_moran_kpi</span><span class="op">(</span><span class="st">"revenue_thai"</span>,<span class="va">lmp_summary</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lm_revenue_thai-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_lisa_multiple_kpis</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"revenue_foreign"</span>, <span class="st">"revenue_thai"</span><span class="op">)</span>, <span class="va">lmp_summary</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lisa_revenue-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Observations:</strong></p>
<p>This LISA map shows the local spatial autocorrelation for <strong>revenue from local and foreign tourists</strong> across Thailand.</p>
<p>Interestingly, the map reveals only <strong>Low-Low</strong> and <strong>Low-High clusters</strong>. The <strong>Northwest</strong> and <strong>Northeast regions</strong>, particularly areas like <strong>Nakhon Sawan</strong> and <strong>Kalasin</strong>, consistently exhibit <strong>Low-Low clusters</strong> for both local and foreign tourism revenue.</p>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_local_moran_kpi</span><span class="op">(</span><span class="st">"avg_revenue_all"</span>,<span class="va">lmp_summary</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/avg_revenue-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_lisa_kpi</span><span class="op">(</span><span class="st">"avg_revenue_all"</span>, <span class="va">lmp_summary</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lisa_avg_revenue-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Observations:</strong></p>
<p>This LISA map shows the local spatial autocorrelation for <strong>average revenue per tourist</strong> across Thailand.</p>
<ul>
<li><p><strong>Light Green (Low-Low)</strong>: Northwestern regions such as Kanchanaburi and Northeastern regions such as Ubon-Ratchathani are <strong>Low-Low clusters</strong>, where provinces with <strong>low average revenue</strong> are surrounded by other provinces with similarly low average revenue per tourist.</p></li>
<li><p><strong>Light Purple (Low-High)</strong>: Southern regions such as Nakhon Si Thammarat shows a <strong>Low-High outlier</strong>, indicating it has <strong>low average revenue</strong> but is surrounded by provinces with <strong>high average revenue</strong>.</p></li>
<li><p><strong>Red (High-High)</strong>: Right beside the Low-High cluster, in provinces such as Surat Thani and Phuket are <strong>High-High clusters</strong>. This means they have <strong>high average revenue per tourist</strong> and are surrounded by other provinces with similarly high revenues. This suggests the region around Phuket, is a hotspot for tourism revenue.</p></li>
</ul>
</div>
</div>
</div>
</div>
</div>
</section></section></section><section id="spatio-temporal-independence-of-thailands-tourism-economy-indictators" class="level2" data-number="11"><h2 data-number="11" class="anchored" data-anchor-id="spatio-temporal-independence-of-thailands-tourism-economy-indictators">
<span class="header-section-number">11</span> Spatio-Temporal Independence of Thailand’s Tourism Economy Indictators</h2>
<p>In this section, we will form spatio-temporal analysis to understand the <strong>spatio-temporal patterns</strong> of Thailand’s tourism economy across different time periods—<strong>pre-COVID, during COVID, and post-COVID</strong> to uncover how the pandemic has impacted the tourism indicators.</p>
<p>By analyzing <strong>Global Moran’s I</strong> across these periods, we aim to assess whether these indicators exhibited spatial dependence (clustering or dispersion) during each phase.</p>
<section id="global-spatial-autocorrelation-analysis-across-time-periods" class="level3" data-number="11.1"><h3 data-number="11.1" class="anchored" data-anchor-id="global-spatial-autocorrelation-analysis-across-time-periods">
<span class="header-section-number">11.1</span> Global Spatial Autocorrelation Analysis Across Time Periods</h3>
<p>To recap, the three distinct periods for this analysis:</p>
<ul>
<li>Pre-COVID (before January 2020)</li>
<li>COVID (January 2020 to September 2022)</li>
<li>Post-COVID (after September 2022)</li>
</ul>
<p>To conduct the spatio-temporal analysis, we first aggregate the tourism data at the provincial level and for each time period (pre-COVID, COVID, post-COVID).</p>
<div class="cell">
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tourism_agg_tp</span> <span class="op">&lt;-</span> <span class="va">tourism</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">province_eng</span>, <span class="va">time_period</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    no_tourist_all <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">no_tourist_all</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>    revenue_foreign <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">revenue_foreign</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>    revenue_thai <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">revenue_thai</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    avg_revenue_all <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">avg_revenue_all</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    geometry <span class="op">=</span> <span class="fu">st_union</span><span class="op">(</span><span class="va">geometry</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we create subsets for each time period by filtering the aggregated data:</p>
<div class="cell">
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pre_covid_agg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">tourism_agg_tp</span>, <span class="va">time_period</span> <span class="op">==</span><span class="st">"pre-covid"</span><span class="op">)</span></span>
<span><span class="va">covid_agg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">tourism_agg_tp</span>, <span class="va">time_period</span> <span class="op">==</span><span class="st">"covid"</span><span class="op">)</span></span>
<span><span class="va">post_covid_agg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">tourism_agg_tp</span>, <span class="va">time_period</span> <span class="op">==</span><span class="st">"post-covid"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will reuse the Global Moran’s I functions from the previous section and apply them to each time period (pre-COVID, COVID, post-COVID).</p>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">time_periods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pre_covid"</span>, <span class="st">"covid"</span>, <span class="st">"post_covid"</span><span class="op">)</span></span>
<span><span class="va">agg_datasets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">pre_covid_agg</span>, <span class="va">covid_agg</span>, <span class="va">post_covid_agg</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define a function to calculate Moran's I for a dataset and append the time period</span></span>
<span><span class="va">compute_moran_summary</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">tourism_data</span>, <span class="va">time_period</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">gmp_results</span> <span class="op">&lt;-</span> <span class="fu">map</span><span class="op">(</span><span class="va">kpis</span>, <span class="op">~</span><span class="fu">compute_global_moran_perm</span><span class="op">(</span><span class="va">tourism_data</span>, <span class="va">.x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">gmp_results</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">kpis</span></span>
<span>  </span>
<span>  <span class="co"># Extract Moran's I info and add a time_period column</span></span>
<span>  <span class="va">moran_summary</span> <span class="op">&lt;-</span> <span class="fu">map_df</span><span class="op">(</span><span class="va">gmp_results</span>, <span class="va">extract_moran_info</span>, .id <span class="op">=</span> <span class="st">"kpi"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>time_period <span class="op">=</span> <span class="va">time_period</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">moran_summary</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Apply the function to each dataset (pre_covid_agg, covid_agg, post_covid_agg)</span></span>
<span><span class="va">all_gmp_summaries</span> <span class="op">&lt;-</span> <span class="fu">map2_df</span><span class="op">(</span><span class="va">agg_datasets</span>, <span class="va">time_periods</span>, <span class="va">compute_moran_summary</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>After running the analysis, we combine all Moran’s I results into a single dataframe for easy interpretation.</p>
<div class="cell">
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">datatable</span><span class="op">(</span><span class="va">all_gmp_summaries</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-65b7328530dcdf303887" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-65b7328530dcdf303887">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12"],["no_tourist_all","revenue_foreign","revenue_thai","avg_revenue_all","no_tourist_all","revenue_foreign","revenue_thai","avg_revenue_all","no_tourist_all","revenue_foreign","revenue_thai","avg_revenue_all"],["2.093699e-03","-1.429908e-02","-7.450286e-02","3.064879e-01","-4.224657e-02","-2.310979e-02","-7.458954e-02","3.441867e-01","5.661329e-03","-5.044771e-02","-2.454802e-02","1.137785e-01"],["6.6e-01","7.4e-01","1.2e-01","0e+00","4.4e-01","7e-01","1.8e-01","0e+00","7e-01","2.4e-01","9.8e-01","6e-02"],["No spatial dependence","No spatial dependence","No spatial dependence","Spatial dependence detected","No spatial dependence","No spatial dependence","No spatial dependence","Spatial dependence detected","No spatial dependence","No spatial dependence","No spatial dependence","No spatial dependence"],["pre_covid","pre_covid","pre_covid","pre_covid","covid","covid","covid","covid","post_covid","post_covid","post_covid","post_covid"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>kpi<\/th>\n      <th>moran_I<\/th>\n      <th>p_value<\/th>\n      <th>interpretation<\/th>\n      <th>time_period<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"kpi","targets":1},{"name":"moran_I","targets":2},{"name":"p_value","targets":3},{"name":"interpretation","targets":4},{"name":"time_period","targets":5}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Observations:</strong></p>
<ul>
<li><p>For most KPIs, <strong>total tourists, revenues from foreign or Thai tourists</strong>, across all time periods, we <strong>do not reject the null hypothesis</strong>, as the p-values are significantly higher than the threshold of 0.05. This means there is <strong>no evidence of spatial dependence</strong> for these indicators.</p></li>
<li><p>However, for <strong>average revenue per tourist</strong>, the p-values are below the alpha value (&lt;0.05) for pre-covid and covid periods. Therefore, we reject the null hypothesis for this indicator. This suggests that average revenue per tourist tends to cluster spatially for these time periods.</p></li>
<li><p>Both of these observations is consistent with observations from previous sections. Notably, the spatial clustering for <strong>average revenue per tourist</strong> indicator weakens in the post-covid period, observed from the drop in Moran’s I value post-covid, suggesting that the pandemic may have disrupted tourism patterns but residual clustering persists.</p></li>
</ul>
</div>
</div>
</section><section id="local-spatial-autocorrelation-analysis-across-time-periods" class="level3" data-number="11.2"><h3 data-number="11.2" class="anchored" data-anchor-id="local-spatial-autocorrelation-analysis-across-time-periods">
<span class="header-section-number">11.2</span> Local Spatial Autocorrelation Analysis Across Time Periods</h3>
<p>In this subsection, we will perform local spatial autocorrelation analysis across time periods using Local Moran’s I.</p>
<p>Similar to previous sections, we will reuse existing local spatial custom functions to iterate through the three time periods to produce the results. The results for each time period are saved locally and read from the files for further analysis.</p>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">time_periods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pre_covid"</span>, <span class="st">"covid"</span>, <span class="st">"post_covid"</span><span class="op">)</span></span>
<span><span class="va">agg_datasets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">pre_covid_agg</span>, <span class="va">covid_agg</span>, <span class="va">post_covid_agg</span><span class="op">)</span></span>
<span><span class="va">kpis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"no_tourist_all"</span>, <span class="st">"revenue_foreign"</span>, <span class="st">"revenue_thai"</span>, <span class="st">"avg_revenue_all"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">agg_datasets</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># ungroup to avoid error in local moran computation</span></span>
<span>  <span class="va">current_dataset</span> <span class="op">&lt;-</span> <span class="va">agg_datasets</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="co"># Compute local Moran's I for each KPI in the current dataset</span></span>
<span>  <span class="va">lmp_summary_tp</span> <span class="op">&lt;-</span> <span class="fu">map_df</span><span class="op">(</span><span class="va">kpis</span>, <span class="op">~</span><span class="fu">compute_local_moran_df</span><span class="op">(</span><span class="va">current_dataset</span>, </span>
<span>                                                      <span class="va">.x</span>, </span>
<span>                                                      <span class="va">nb_knn_5</span>, </span>
<span>                                                      <span class="va">knn5_weights_inv</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Save the result with the corresponding time period in the filename</span></span>
<span>  <span class="fu">write_rds</span><span class="op">(</span><span class="va">lmp_summary_tp</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"data/rds/lmp_summary_"</span>, <span class="va">time_periods</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">".rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We save the results and read them one by one:</p>
<div class="cell">
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lmp_summary_pre_covid</span> <span class="op">&lt;-</span> <span class="fu">read_rds</span><span class="op">(</span><span class="st">"data/rds/lmp_summary_pre_covid.rds"</span><span class="op">)</span></span>
<span><span class="va">lmp_summary_covid</span> <span class="op">&lt;-</span> <span class="fu">read_rds</span><span class="op">(</span><span class="st">"data/rds/lmp_summary_covid.rds"</span><span class="op">)</span></span>
<span><span class="va">lmp_summary_post_covid</span> <span class="op">&lt;-</span> <span class="fu">read_rds</span><span class="op">(</span><span class="st">"data/rds/lmp_summary_post_covid.rds"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="total-no.-of-tourists-1" class="level4" data-number="11.2.1"><h4 data-number="11.2.1" class="anchored" data-anchor-id="total-no.-of-tourists-1">
<span class="header-section-number">11.2.1</span> Total no. of tourists</h4>
<p>This subsection presents the local spatial autocorrelation analysis (Local Moran’s I and LISA maps) for the <strong>total number of tourists</strong> across three different time periods: <strong>Pre-Covid</strong>, <strong>Covid</strong>, and <strong>Post-Covid</strong>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Pre-Covid</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Covid</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Post-Covid</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_local_moran_kpi</span><span class="op">(</span><span class="st">"no_tourist_all"</span>,<span class="va">lmp_summary_pre_covid</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lm_no_tourist_all_pre-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_lisa_kpi</span><span class="op">(</span><span class="st">"no_tourist_all"</span>, <span class="va">lmp_summary_pre_covid</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lisa_no_tourist_all_pre-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_local_moran_kpi</span><span class="op">(</span><span class="st">"no_tourist_all"</span>,<span class="va">lmp_summary_covid</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lm_no_tourist_all_covid-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_lisa_kpi</span><span class="op">(</span><span class="st">"no_tourist_all"</span>, <span class="va">lmp_summary_covid</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lisa_no_tourist_all_covid-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_local_moran_kpi</span><span class="op">(</span><span class="st">"no_tourist_all"</span>,<span class="va">lmp_summary_post_covid</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lm_no_tourist_all_post-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_lisa_kpi</span><span class="op">(</span><span class="st">"no_tourist_all"</span>, <span class="va">lmp_summary_post_covid</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lisa_no_tourist_all_post-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Observations:</strong></p>
<p>Across the three time periods, we can notice that there are persistent <strong>Low-Low</strong> clusters in the northeast provinces.</p>
<ul>
<li>Interestingly, a <strong>High-Low cluster</strong> emerges in the southern part of Thailand (Songkhla area) during the Covid period.</li>
</ul>
</div>
</div>
</section><section id="revenue-1" class="level4" data-number="11.2.2"><h4 data-number="11.2.2" class="anchored" data-anchor-id="revenue-1">
<span class="header-section-number">11.2.2</span> Revenue</h4>
<p>This subsection presents the local spatial autocorrelation analysis (Local Moran’s I and LISA maps) for the <strong>revenue</strong> across three different time periods: <strong>Pre-Covid</strong>, <strong>Covid</strong>, and <strong>Post-Covid</strong>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Pre-Covid</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Covid</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Post-Covid</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_local_moran_kpi</span><span class="op">(</span><span class="st">"revenue_foreign"</span>,<span class="va">lmp_summary_pre_covid</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lm_revenue_foreign_pre-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_local_moran_kpi</span><span class="op">(</span><span class="st">"revenue_thai"</span>,<span class="va">lmp_summary_pre_covid</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lm_revenue_thai_pre-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_lisa_multiple_kpis</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"revenue_foreign"</span>, <span class="st">"revenue_thai"</span><span class="op">)</span>, <span class="va">lmp_summary_pre_covid</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lisa_revenue_foreign_pre-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_local_moran_kpi</span><span class="op">(</span><span class="st">"revenue_foreign"</span>,<span class="va">lmp_summary_covid</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lm_revenue_foreign_covid-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_local_moran_kpi</span><span class="op">(</span><span class="st">"revenue_thai"</span>,<span class="va">lmp_summary_covid</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lm_revenue_thai_covid-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_lisa_multiple_kpis</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"revenue_foreign"</span>, <span class="st">"revenue_thai"</span><span class="op">)</span>, <span class="va">lmp_summary_covid</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lisa_revenue_foreign_covid-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_local_moran_kpi</span><span class="op">(</span><span class="st">"revenue_foreign"</span>,<span class="va">lmp_summary_post_covid</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lm_revenue_foreign_post-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_local_moran_kpi</span><span class="op">(</span><span class="st">"revenue_thai"</span>,<span class="va">lmp_summary_post_covid</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lm_revenue_thai_post-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_lisa_multiple_kpis</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"revenue_foreign"</span>, <span class="st">"revenue_thai"</span><span class="op">)</span>, <span class="va">lmp_summary_post_covid</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lisa_revenue_foreign_post-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Observations:</strong></p>
<ul>
<li><p>For Thai Revenue, we can notice that there are persistent <strong>Low-Low</strong> clusters in the northeast provinces such as Ubon-Ratchathani across all time periods.</p></li>
<li><p>For Foreign Revenue, we can notice that there are persistent <strong>Low-Low</strong> clusters in the northwest provinces such as Suphanburi across all time periods.</p></li>
<li><p>Khanaburi province form as <strong>Low-Low</strong> cluster for foreign revenue during Covid and post-Covid. This suggests potential challenges in attracting foreign tourists to the area even after the pandemic.</p></li>
</ul>
</div>
</div>
</section><section id="avg-revenuetourist" class="level4" data-number="11.2.3"><h4 data-number="11.2.3" class="anchored" data-anchor-id="avg-revenuetourist">
<span class="header-section-number">11.2.3</span> Avg Revenue/Tourist</h4>
<p>This subsection presents the local spatial autocorrelation analysis (Local Moran’s I and LISA maps) for the <strong>average revenue per tourist</strong> across three different time periods: <strong>Pre-Covid</strong>, <strong>Covid</strong>, and <strong>Post-Covid</strong>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Pre-Covid</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Covid</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Post-Covid</a></li>
</ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_local_moran_kpi</span><span class="op">(</span><span class="st">"avg_revenue_all"</span>,<span class="va">lmp_summary_pre_covid</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lm_avg_revenue_all_pre-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_lisa_kpi</span><span class="op">(</span><span class="st">"avg_revenue_all"</span>, <span class="va">lmp_summary_pre_covid</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lisa_avg_revenue_all_pre-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_local_moran_kpi</span><span class="op">(</span><span class="st">"avg_revenue_all"</span>,<span class="va">lmp_summary_covid</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lm_avg_revenue_all_covid-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_lisa_kpi</span><span class="op">(</span><span class="st">"avg_revenue_all"</span>, <span class="va">lmp_summary_covid</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lisa_avg_revenue_all_covid-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_local_moran_kpi</span><span class="op">(</span><span class="st">"avg_revenue_all"</span>,<span class="va">lmp_summary_post_covid</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lm_avg_revenue_all_post-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_lisa_kpi</span><span class="op">(</span><span class="st">"avg_revenue_all"</span>, <span class="va">lmp_summary_post_covid</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/lisa_avg_revenue_all_post-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Observations:</strong></p>
<ul>
<li><p>During Pre-Covid, Phuket and surrounding southern provinces formed a <strong>High-High</strong> cluster for average revenue per tourist indicator, indicating a strong concentration of high average revenues from tourists in this region.</p></li>
<li><p>During Covid, the <strong>High-High</strong> cluster around Phuket remains strong in the Phuket region but seems to extend less into nearby provinces, suggesting a hit on the tourist industry in the region.</p></li>
<li><p>During Post-Covid, the <strong>High-High</strong> cluster in Phuket remains but appears to be less pronounced compared to pre-Covid levels, possibly reflecting a slow recovery.</p></li>
</ul>
<p>In other areas, there is a persistence of <strong>Low-Low</strong> clustters in the northeastern provinces throughout the different phases of the pandemic.</p>
</div>
</div>
</section></section></section><section id="emerging-hotspot-analysis" class="level2" data-number="12"><h2 data-number="12" class="anchored" data-anchor-id="emerging-hotspot-analysis">
<span class="header-section-number">12</span> Emerging Hotspot Analysis</h2>
<p>The goal of Emerging Hotspot Analysis (EHSA) is to assess how hotspots (areas of high activity) and coldspots (areas of low activity) evolve over time. EHSA helps answer key questions such as: Are hotspots becoming increasingly pronounced? Are coldspots cooling down further? Or are these areas maintaining the same pattern over time? In the context of tourism, emerging hotspot analysis can reveal regions that are consistently experiencing high or low levels of tourist activity or revenue, helping policymakers and business owners make data-driven decisions.</p>
<p>To achieve this, we will first construct a <strong>space-time cube</strong> to capture the spatial and temporal dimensions of the data. Then, we will compute the <strong>Getis-Ord Gi* statistic</strong>, which identifies clusters of high or low values spatially. Following this, we will evaluate the trends of these hotspots and coldspots over time using the <strong>Mann-Kendall Test</strong>, which assesses the significance of these trends. After that, we can utilizing the <code>emerging_hotspot_analysis()</code> function from the <strong>sfdep</strong> to detect and visualize emerging patterns over time.</p>
<section id="computing-gi" class="level3" data-number="12.1"><h3 data-number="12.1" class="anchored" data-anchor-id="computing-gi">
<span class="header-section-number">12.1</span> Computing Gi*</h3>
<p>In this subsection, we will compute the Gi* statistics. We will use the <code>tourism_st</code> object from earlier section to identify neigbours and derive an inverse distance weights.</p>
<div class="cell">
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tourism_nb</span> <span class="op">&lt;-</span> <span class="va">tourism_st</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">activate</span><span class="op">(</span><span class="st">"geometry"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>nb <span class="op">=</span> <span class="fu">include_self</span><span class="op">(</span><span class="fu">st_knn</span><span class="op">(</span><span class="va">geometry</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         wt <span class="op">=</span> <span class="fu">st_inverse_distance</span><span class="op">(</span><span class="va">nb</span>, </span>
<span>                                       <span class="va">geometry</span>,</span>
<span>                                       scale <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                       alpha <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>         .before <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">set_nbs</span><span class="op">(</span><span class="st">"nb"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">set_wts</span><span class="op">(</span><span class="st">"wt"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>
<code>activate("geometry")</code>: Activates the geometry context for spatial operations.</li>
<li>
<code>mutate()</code>: Adds two columns:
<ul>
<li>
<code>nb</code>: Neighbors, including the observation itself (<code>include_self</code>), using spatial contiguity (<code>st_contiguity</code>).</li>
<li>
<code>wt</code>: Weights, calculated with inverse distance (<code>st_inverse_distance</code>).</li>
</ul>
</li>
<li>
<code>set_nbs()</code> and <code>set_wts()</code>: Copies neighbors and weights to all time-slices. Ensure row order consistency after using these functions.</li>
</ul>
</div>
</div>
<p>To calculate the local Gi* statistic for each location:</p>
<ol type="1">
<li>
<strong>Group by <code>date_int</code>:</strong> This ensures we calculate Gi* separately for each month, year in the dataset.</li>
<li>
<strong>Use <code>local_gstar_perm()</code>:</strong> This function computes the local Gi* statistic using the GDPPC values, neighbors (<code>nb</code>), and weights (<code>wt</code>).</li>
<li>
<strong>Unnest the Gi* results:</strong> The <code>gi_star</code> column is nested, so we use <code>unnest()</code> to extract the results into a clean format.</li>
</ol>
<p>We will do this iteratively for each KPI using a custom function that saves the computed result locally.</p>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">kpis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"no_tourist_all"</span>, <span class="st">"revenue_foreign"</span>, <span class="st">"revenue_thai"</span>, <span class="st">"avg_revenue_all"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Function to compute Gi* and save the results</span></span>
<span><span class="va">compute_and_save_gi_star</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">kpi</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">gi_stars</span> <span class="op">&lt;-</span> <span class="va">tourism_nb</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">date_int</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">mutate</span><span class="op">(</span>gi_star <span class="op">=</span> <span class="fu">local_gstar_perm</span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu">sym</span><span class="op">(</span><span class="va">kpi</span><span class="op">)</span>, <span class="va">nb</span>, <span class="va">wt</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span><span class="op">(</span><span class="va">gi_star</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">write_rds</span><span class="op">(</span><span class="va">gi_stars</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"data/rds/gi_stars_"</span>, <span class="va">kpi</span>, <span class="st">".rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">walk</a></span><span class="op">(</span><span class="va">kpis</span>, <span class="va">compute_and_save_gi_star</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We read the results for further analysis:</p>
<div class="cell">
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gi_stars_tourist</span> <span class="op">&lt;-</span> <span class="fu">read_rds</span><span class="op">(</span><span class="st">"data/rds/gi_stars_no_tourist_all.rds"</span><span class="op">)</span></span>
<span><span class="va">gi_stars_rev_fore</span> <span class="op">&lt;-</span> <span class="fu">read_rds</span><span class="op">(</span><span class="st">"data/rds/gi_stars_revenue_foreign.rds"</span><span class="op">)</span></span>
<span><span class="va">gi_stars_rev_thai</span> <span class="op">&lt;-</span> <span class="fu">read_rds</span><span class="op">(</span><span class="st">"data/rds/gi_stars_revenue_thai.rds"</span><span class="op">)</span></span>
<span><span class="va">gi_stars_avg_rev_all</span> <span class="op">&lt;-</span> <span class="fu">read_rds</span><span class="op">(</span><span class="st">"data/rds/gi_stars_avg_revenue_all.rds"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="mann-kendall-test" class="level3" data-number="12.2"><h3 data-number="12.2" class="anchored" data-anchor-id="mann-kendall-test">
<span class="header-section-number">12.2</span> Mann-Kendall Test</h3>
<p>The Mann-Kendall Test is used to determine whether a time series has a monotonic upward or downward trend.</p>
<p>We would like to test the following hypothesis for each KPI:</p>
<p><span class="math inline">\(H_0\)</span>: No monotonic trend</p>
<p><span class="math inline">\(H_1\)</span>: Monotonic trend is present (either positive, or negative)</p>
<p>Refer to <a href="https://vsp.pnnl.gov/help/vsample/design_trend_mann_kendall.htm">Mann-Kendall Test For Monotonic Trend</a></p>
<p>Similarly, we will do this iteratively for each KPI using a custom function that saves the computed result locally. In essence, this function performs the Mann-Kendall test for each province to assess trends in Gi* statistics, then filters by significance level and extracts the top k emerging hotspots by absolute tau values.</p>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">compute_emerging_hotspots</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gi_stars</span>, <span class="va">top_k</span>, <span class="va">sig_level</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Perform Mann-Kendall trend test</span></span>
<span>  <span class="va">ehsa</span> <span class="op">&lt;-</span> <span class="va">gi_stars</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">group_by</span><span class="op">(</span><span class="va">province_eng</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">summarise</span><span class="op">(</span>mk <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html">unclass</a></span><span class="op">(</span><span class="fu">Kendall</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Kendall/man/MannKendall.html">MannKendall</a></span><span class="op">(</span><span class="va">gi_star</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest_wider.html">unnest_wider</a></span><span class="op">(</span><span class="va">mk</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Filter by significance level (sl) and extract top k emerging hotspots</span></span>
<span>  <span class="va">emerging</span> <span class="op">&lt;-</span> <span class="va">ehsa</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">sl</span> <span class="op">&lt;</span> <span class="va">sig_level</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">arrange</span><span class="op">(</span><span class="va">sl</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">tau</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">slice</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">top_k</span><span class="op">)</span> </span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">emerging</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Total no. of tourists</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Revenue</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Avg Revenue / Tourist</a></li>
</ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">eh_tourist</span> <span class="op">&lt;-</span> <span class="fu">compute_emerging_hotspots</span><span class="op">(</span><span class="va">gi_stars_tourist</span>, <span class="fl">10</span>, <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="fu">datatable</span><span class="op">(</span><span class="va">eh_tourist</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-1990be7a07e95fee1522" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1990be7a07e95fee1522">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10"],["Phatthalung","Trang","Suphan Buri","Nakhon Si Thammarat","Phra Nakhon Si Ayutthaya","Ang Thong","Songkhla","Sing Buri","Uthai Thani","Lop Buri"],[-0.5248979330062866,-0.5167347192764282,0.508571445941925,-0.4987755119800568,0.5004081726074219,0.4791836738586426,-0.4710204005241394,0.4661224484443665,0.4628571569919586,0.4563265442848206],[7.863246764827636e-08,1.24617500318891e-07,2.384185791015625e-07,3.350833424065058e-07,3.576278686523438e-07,9.5367431640625e-07,1.4488956594505e-06,1.9073486328125e-06,2.145767211914062e-06,3.099441528320312e-06],[-643,-633,623,-611,613,587,-577,571,567,559],[1225,1225,1225,1225,1225,1225,1225,1225,1225,1225],[14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>province_eng<\/th>\n      <th>tau<\/th>\n      <th>sl<\/th>\n      <th>S<\/th>\n      <th>D<\/th>\n      <th>varS<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"province_eng","targets":1},{"name":"tau","targets":2},{"name":"sl","targets":3},{"name":"S","targets":4},{"name":"D","targets":5},{"name":"varS","targets":6}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Observations:</strong></p>
<p>The 10 provinces, including Phatthalung, Trang, Suphan Buri, Nakhon Si Thammarat, Phra Nakhon Si Ayutthaya, Ang Thong, Songkhla, Sing Buri, Uthai Thani, and Lop Buri, show significant trends with very small p-values (below alpha &lt;0.05), indicating strong statistical significance.</p>
<p>Negative tau values (e.g., Phatthalung, Trang, Nakhon Si Thammarat) suggest a decreasing trend, potentially indicating coldspots, while positive tau values (e.g., Suphan Buri, Phra Nakhon Si Ayutthaya, Sing Buri) reflect an increasing trend, implying emerging hotspots in terms of tourist inflow in these areas.</p>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">eh_rev_fore</span> <span class="op">&lt;-</span> <span class="fu">compute_emerging_hotspots</span><span class="op">(</span><span class="va">gi_stars_rev_fore</span>, <span class="fl">10</span>, <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="fu">datatable</span><span class="op">(</span><span class="va">eh_rev_fore</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-28cf82553809b695f76c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-28cf82553809b695f76c">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10"],["Phatthalung","Trang","Nakhon Si Thammarat","Ranong","Chumphon","Chon Buri","Trat","Chanthaburi","Rayong","Sa Kaeo"],[-0.6293877363204956,-0.6293877363204956,-0.6261224746704102,-0.6244897842407227,-0.5722448825836182,-0.5004081726074219,-0.4922448992729187,-0.4693877696990967,-0.4612244963645935,-0.4579591751098633],[1.187354520260087e-10,1.187354520260087e-10,1.479432271134229e-10,1.650727193824864e-10,4.758613947331014e-09,3.066834608489444e-07,4.762437129102182e-07,1.575378405505035e-06,2.384326080573373e-06,2.808903218465275e-06],[-771,-771,-767,-765,-701,-613,-603,-575,-565,-561],[1225,1225,1225,1225,1225,1225,1225,1225,1225,1225],[14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>province_eng<\/th>\n      <th>tau<\/th>\n      <th>sl<\/th>\n      <th>S<\/th>\n      <th>D<\/th>\n      <th>varS<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"province_eng","targets":1},{"name":"tau","targets":2},{"name":"sl","targets":3},{"name":"S","targets":4},{"name":"D","targets":5},{"name":"varS","targets":6}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Observations (Foreign Revenue):</strong></p>
<p>The 10 provinces, including Phatthalung, Trang, Nakhon Si Thammarat, Ranong, Chumphon, Chon Buri, Trat, Chanthaburi, Rayong, and Sa Kaeo, show significant trends in foreign revenue with very small p-values (all below alpha &lt;0.05), indicating strong statistical significance.</p>
<p>Negative tau values across all provinces (e.g., Phatthalung, Trang, Nakhon Si Thammarat) suggest a decreasing trend in foreign revenue, potentially indicating coldspots where foreign revenue are declining.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">eh_rev_thai</span> <span class="op">&lt;-</span> <span class="fu">compute_emerging_hotspots</span><span class="op">(</span><span class="va">gi_stars_rev_thai</span>, <span class="fl">10</span>, <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="fu">datatable</span><span class="op">(</span><span class="va">eh_rev_thai</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-988252b1f4f7d9d645fb" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-988252b1f4f7d9d645fb">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10"],["Trat","Chanthaburi","Prachuap Khiri Khan","Phayao","Nan","Pattani","Narathiwat","Satun","Songkhla","Si Sa Ket"],[0.5346938967704773,0.5461224317550659,0.5722448825836182,0.5771428346633911,0.5983673334121704,-0.5281632542610168,-0.5265306234359741,-0.5265306234359741,-0.5167347192764282,-0.5118367075920105],[0,0,0,0,0,6.528084384171962e-08,7.165611037862618e-08,7.165611037862618e-08,1.24617500318891e-07,1.637378659324895e-07],[655,669,701,707,733,-647,-645,-645,-633,-627],[1225,1225,1225,1225,1225,1225,1225,1225,1225,1225],[14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>province_eng<\/th>\n      <th>tau<\/th>\n      <th>sl<\/th>\n      <th>S<\/th>\n      <th>D<\/th>\n      <th>varS<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"province_eng","targets":1},{"name":"tau","targets":2},{"name":"sl","targets":3},{"name":"S","targets":4},{"name":"D","targets":5},{"name":"varS","targets":6}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Observations (Thai Revenue):</strong></p>
<p>The 10 provinces, including Trat, Chanthaburi, Prachuap Khiri Khan, Phayao, Nan, Pattani, Narathiwat, Satun, Songkhla, and Si Sa Ket, show significant trends in Thai revenue with very small p-values (all below alpha &lt;0.05), indicating strong statistical significance.</p>
<p>Positive tau values (e.g., Nan, Phayao, Trat) suggest an increasing trend in Thai revenue, potentially highlighting emerging hotspots, while negative tau values (e.g., Pattani, Narathiwat, Songkhla) indicate a decreasing trend, suggesting coldspots where Thai revenue may be declining.</p>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">eh_avg_rev_all</span> <span class="op">&lt;-</span> <span class="fu">compute_emerging_hotspots</span><span class="op">(</span><span class="va">gi_stars_avg_rev_all</span>, <span class="fl">10</span>, <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="fu">datatable</span><span class="op">(</span><span class="va">eh_avg_rev_all</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-13a8be463c5fb2457ee4" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-13a8be463c5fb2457ee4">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10"],["Tak","Sukhothai","Kamphaeng Phet","Prachin Buri","Phichit","Uttaradit","Phitsanulok","Phrae","Phetchabun","Chumphon"],[0.5673469305038452,0.5804081559181213,0.5885714292526245,0.5967347025871277,0.6097959280014038,0.6097959280014038,0.6310204267501831,0.6669387817382812,0.6734693646430969,-0.6342856884002686],[0,0,0,0,0,0,0,0,0,8.519521893513016e-11],[695,711,721,731,747,747,773,817,825,-777],[1225,1225,1225,1225,1225,1225,1225,1225,1225,1225],[14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875,14291.6669921875]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>province_eng<\/th>\n      <th>tau<\/th>\n      <th>sl<\/th>\n      <th>S<\/th>\n      <th>D<\/th>\n      <th>varS<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"province_eng","targets":1},{"name":"tau","targets":2},{"name":"sl","targets":3},{"name":"S","targets":4},{"name":"D","targets":5},{"name":"varS","targets":6}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Observations (Average Revenue per Tourist):</strong></p>
<p>The 10 provinces, including Tak, Sukhothai, Kamphaeng Phet, Prachin Buri, Phichit, Uttaradit, Phitsanulok, Phrae, Phetchabun, and Chumphon, show significant trends in average revenue per tourist with very small p-values (all below alpha &lt;0.05), indicating strong statistical significance.</p>
<p>Positive tau values (e.g., Phrae, Phitsanulok, Phichit) suggest an increasing trend in average revenue per tourist, potentially indicating growing tourist spending in these areas. Chumphon, with a negative tau value, shows a decreasing trend, suggesting a potential decline in average revenue per tourist.</p>
</div>
</div>
</div>
</div>
</div>
</section><section id="performing-emerging-hotspot-analysis" class="level3" data-number="12.3"><h3 data-number="12.3" class="anchored" data-anchor-id="performing-emerging-hotspot-analysis">
<span class="header-section-number">12.3</span> Performing Emerging Hotspot Analysis</h3>
<p>To perform Emerging Hotspot Analysis (EHSA), we can use the <code>emerging_hotspot_analysis()</code> function from the <code>sfdep</code> package. This function analyzes spatio-temporal trends by detecting areas that are hotspots over time. It takes the following parameters: - <code>x</code>: The spacetime object (e.g., <code>GDPPC_st</code>). - <code>.var</code>: The variable of interest (e.g., <code>"GDPPC"</code>). - <code>k</code>: Number of time lags (default is 1). - <code>nsim</code>: Number of simulations to run (e.g., 99).</p>
<p>We will use a for loop to iteratively compute for the selected KPIs.</p>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">kpis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"no_tourist_all"</span>, <span class="st">"revenue_foreign"</span>, <span class="st">"revenue_thai"</span>, <span class="st">"avg_revenue_all"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Loop through the KPIs</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">kpi</span> <span class="kw">in</span> <span class="va">kpis</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># Perform the Emerging Hotspot Analysis for the current KPI</span></span>
<span>  <span class="va">ehsa_result</span> <span class="op">&lt;-</span> <span class="fu">emerging_hotspot_analysis</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">tourism_st</span>, </span>
<span>    .var <span class="op">=</span> <span class="va">kpi</span>, </span>
<span>    k <span class="op">=</span> <span class="fl">1</span>, </span>
<span>    nsim <span class="op">=</span> <span class="fl">99</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Save the result with a file name based on the current KPI</span></span>
<span>  <span class="va">save_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"data/rds/ehsa_"</span>, <span class="va">kpi</span>, <span class="st">".rds"</span><span class="op">)</span></span>
<span>  <span class="fu">write_rds</span><span class="op">(</span><span class="va">ehsa_result</span>, file <span class="op">=</span> <span class="va">save_file</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ehsa_tourist</span> <span class="op">&lt;-</span> <span class="fu">read_rds</span><span class="op">(</span><span class="st">"data/rds/ehsa_no_tourist_all.rds"</span><span class="op">)</span></span>
<span><span class="va">ehsa_rev_fore</span> <span class="op">&lt;-</span> <span class="fu">read_rds</span><span class="op">(</span><span class="st">"data/rds/ehsa_revenue_foreign.rds"</span><span class="op">)</span></span>
<span><span class="va">ehsa_rev_thai</span> <span class="op">&lt;-</span> <span class="fu">read_rds</span><span class="op">(</span><span class="st">"data/rds/ehsa_revenue_thai.rds"</span><span class="op">)</span></span>
<span><span class="va">ehsa_avg_rev_all</span> <span class="op">&lt;-</span> <span class="fu">read_rds</span><span class="op">(</span><span class="st">"data/rds/ehsa_avg_revenue_all.rds"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="visualizing-distribution-of-ehsa-classes-and-maps" class="level3" data-number="12.4"><h3 data-number="12.4" class="anchored" data-anchor-id="visualizing-distribution-of-ehsa-classes-and-maps">
<span class="header-section-number">12.4</span> Visualizing Distribution of EHSA Classes and Maps</h3>
<p>To visualize the distribution of EHSA classifications, we will create an interactive bar chart using <code>ggplotly</code> based on the EHSA results.</p>
<p>For visualizing the geographic distribution of EHSA classes, we need to join the <em>admin_boundary</em> data with the corresponding <em>ehsa</em> object (e.g., <code>ehsa_tourist</code>) before plotting. Note that in this case, we have filtered the data to include only statistically significant results.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Total no. of tourists</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Revenue</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Avg Revenue / Tourist</a></li>
</ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ehsa_tourist_sig</span> <span class="op">&lt;-</span> <span class="va">ehsa_tourist</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplotly</span><span class="op">(</span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ehsa_tourist_sig</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">classification</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-9acb472f3bc023769b12" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9acb472f3bc023769b12">{"x":{"data":[{"orientation":"v","width":[0.89999999999999991,0.90000000000000013],"base":[0,0],"x":[1,2],"y":[41,1],"text":["count: 41<br />classification: no pattern detected","count:  1<br />classification: oscilating coldspot"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":37.260273972602747},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,2.6000000000000001],"tickmode":"array","ticktext":["no pattern detected","oscilating coldspot"],"tickvals":[1,2],"categoryorder":"array","categoryarray":["no pattern detected","oscilating coldspot"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"classification","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2.0500000000000003,43.049999999999997],"tickmode":"array","ticktext":["0","10","20","30","40"],"tickvals":[0,9.9999999999999982,20,29.999999999999996,40],"categoryorder":"array","categoryarray":["0","10","20","30","40"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"13d0e6c6de621":{"x":{},"type":"bar"}},"cur_data":"13d0e6c6de621","visdat":{"13d0e6c6de621":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tourist_ehsa</span> <span class="op">&lt;-</span> <span class="va">admin_boundary</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">ehsa_tourist</span>,</span>
<span>            by <span class="op">=</span> <span class="fu">join_by</span><span class="op">(</span><span class="va">province_eng</span> <span class="op">==</span> <span class="va">location</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sig_tourist_ehsa</span> <span class="op">&lt;-</span> <span class="va">tourist_ehsa</span>  <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="fu">tmap_mode</span><span class="op">(</span><span class="st">"plot"</span><span class="op">)</span></span>
<span><span class="fu">tm_shape</span><span class="op">(</span><span class="va">tourist_ehsa</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_polygons</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_borders</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">tm_shape</span><span class="op">(</span><span class="va">sig_tourist_ehsa</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_fill</span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">tm_borders</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_layout</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"EHSA Classification of Tourist Nums."</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/ehsa_tourist_viz-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Observations</strong>:</p>
<p>Both the bar chart and the choropleth map display the classification of statistically significant hotspots or coldspots for the total number of tourists (alpha &lt; 0.05).</p>
<p>From the bar chart we can notice most regions (over 40) are classified as “no pattern detected,” meaning no significant trends were found, while a few regions are classified as “oscillating coldspot,” indicating fluctuating coldspot patterns over time.</p>
<p>This is reflected on the choropleth map which provides a geographic representation of these classifications. Regions in green are marked as “no pattern detected,” spread across much of Thailand, while only a small region (in yellow) is classified as an “oscillating coldspot.” The remaining grey regions represent regions with no statistically significant patterns.</p>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p><strong>Foreign Revenue</strong></p>
<div class="cell">
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ehsa_rev_fore_sig</span> <span class="op">&lt;-</span> <span class="va">ehsa_rev_fore</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplotly</span><span class="op">(</span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ehsa_rev_fore_sig</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">classification</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-887d9d3e739065d53985" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-887d9d3e739065d53985">{"x":{"data":[{"orientation":"v","width":[0.89999999999999991,0.90000000000000013,0.90000000000000036],"base":[0,0,0],"x":[1,2,3],"y":[7,10,1],"text":["count:  7<br />classification: no pattern detected","count: 10<br />classification: sporadic coldspot","count:  1<br />classification: sporadic hotspot"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":48.949771689497723},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,3.6000000000000001],"tickmode":"array","ticktext":["no pattern detected","sporadic coldspot","sporadic hotspot"],"tickvals":[1,2,3],"categoryorder":"array","categoryarray":["no pattern detected","sporadic coldspot","sporadic hotspot"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"classification","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.5,10.5],"tickmode":"array","ticktext":["0.0","2.5","5.0","7.5","10.0"],"tickvals":[0,2.5,5,7.5,10],"categoryorder":"array","categoryarray":["0.0","2.5","5.0","7.5","10.0"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"13d0e2965f389":{"x":{},"type":"bar"}},"cur_data":"13d0e2965f389","visdat":{"13d0e2965f389":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>Thai Revenue</strong></p>
<div class="cell">
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ehsa_rev_thai_sig</span> <span class="op">&lt;-</span> <span class="va">ehsa_rev_thai</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplotly</span><span class="op">(</span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ehsa_rev_thai_sig</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">classification</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-54549f4c10c17d05b981" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-54549f4c10c17d05b981">{"x":{"data":[{"orientation":"v","width":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0,0,0,0],"x":[1,2,3,4],"y":[45,1,12,5],"text":["count: 45<br />classification: no pattern detected","count:  1<br />classification: oscilating coldspot","count: 12<br />classification: sporadic coldspot","count:  5<br />classification: sporadic hotspot"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":37.260273972602747},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,4.5999999999999996],"tickmode":"array","ticktext":["no pattern detected","oscilating coldspot","sporadic coldspot","sporadic hotspot"],"tickvals":[1,2,3,4],"categoryorder":"array","categoryarray":["no pattern detected","oscilating coldspot","sporadic coldspot","sporadic hotspot"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"classification","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2.25,47.25],"tickmode":"array","ticktext":["0","10","20","30","40"],"tickvals":[0,10,20,30,40],"categoryorder":"array","categoryarray":["0","10","20","30","40"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"13d0e5efe20ed":{"x":{},"type":"bar"}},"cur_data":"13d0e5efe20ed","visdat":{"13d0e5efe20ed":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>Combined Choropleth Map</strong></p>
<p>Note that as Foreign Revenue has 3 categories, while Thai Revenue has 4 categories, we have pegged the classification with fixed colors for comparison.</p>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Define the color palette</span></span>
<span><span class="va">classification_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"no pattern detected"</span> <span class="op">=</span> <span class="st">"turquoise3"</span>, </span>
<span>                           <span class="st">"oscillating coldspot"</span> <span class="op">=</span> <span class="st">"yellow2"</span>, </span>
<span>                           <span class="st">"sporadic coldspot"</span> <span class="op">=</span> <span class="st">"mediumpurple1"</span>, </span>
<span>                           <span class="st">"sporadic hotspot"</span> <span class="op">=</span> <span class="st">"tomato"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create first map (Foreign Revenue)</span></span>
<span><span class="va">rev_fore_ehsa</span> <span class="op">&lt;-</span> <span class="va">admin_boundary</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">ehsa_rev_fore</span>, by <span class="op">=</span> <span class="fu">join_by</span><span class="op">(</span><span class="va">province_eng</span> <span class="op">==</span> <span class="va">location</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sig_rev_fore_ehsa</span> <span class="op">&lt;-</span> <span class="va">rev_fore_ehsa</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="va">map_fore</span> <span class="op">&lt;-</span> <span class="fu">tm_shape</span><span class="op">(</span><span class="va">rev_fore_ehsa</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_polygons</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_borders</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_shape</span><span class="op">(</span><span class="va">sig_rev_fore_ehsa</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_fill</span><span class="op">(</span><span class="st">"classification"</span>, palette <span class="op">=</span> <span class="va">classification_colors</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">tm_borders</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_layout</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"EHSA Classification of Foreign Revenue"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create second map (Thai Revenue)</span></span>
<span><span class="va">rev_thai_ehsa</span> <span class="op">&lt;-</span> <span class="va">admin_boundary</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">ehsa_rev_thai</span>, by <span class="op">=</span> <span class="fu">join_by</span><span class="op">(</span><span class="va">province_eng</span> <span class="op">==</span> <span class="va">location</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sig_rev_thai_ehsa</span> <span class="op">&lt;-</span> <span class="va">rev_thai_ehsa</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="va">map_thai</span> <span class="op">&lt;-</span> <span class="fu">tm_shape</span><span class="op">(</span><span class="va">rev_thai_ehsa</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_polygons</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_borders</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_shape</span><span class="op">(</span><span class="va">sig_rev_thai_ehsa</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_fill</span><span class="op">(</span><span class="st">"classification"</span>, palette <span class="op">=</span> <span class="va">classification_colors</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">tm_borders</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_layout</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"EHSA Classification of Thai Revenue"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tmap_arrange</span><span class="op">(</span><span class="va">map_fore</span>, <span class="va">map_thai</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/ehsa_rev_viz-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Observations (Foreign &amp; Thai Revenue)</strong>:</p>
<p>Both the bar chart and the choropleth map show the classification of statistically significant (alpha &lt; 0.05). hotspots or coldspots for foreign and thai revenue respectively.</p>
<p>For <strong>foreign revenue</strong>, most regions are classified as “sporadic coldspot,” indicating inconsistent periods of lower foreign revenue. Some regions are marked as “no pattern detected,” meaning no significant trends were observed, while only a few regions are classified as “sporadic hotspot,” suggesting inconsistent periods of higher foreign revenue.</p>
<p>For <strong>thai revenue</strong>, the majority of regions are classified as “no pattern detected,” indicating no clear trends in Thai revenue. Some regions are marked as “sporadic coldspot,” meaning these areas experience inconsistent periods of lower Thai revenue, while a smaller number of regions are classified as “sporadic hotspot,” showing intermittent periods of higher Thai revenue.</p>
<p>From the choropleth map for these two categories, we can notice some salient differences in the geographic distribution of these revenue sources. Notably, the Thai revenue map has a more diverse classification, with a significant number of “sporadic hotspots” (red), particularly in northern Thailand, which are not present on the foreign revenue map. From the maps, we can also notice that both revenue sources share the same sporadic coldspots cluster if not, they appear side by side if we overlap the maps.</p>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ehsa_avg_rev_all_sig</span> <span class="op">&lt;-</span> <span class="va">ehsa_avg_rev_all</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplotly</span><span class="op">(</span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ehsa_avg_rev_all_sig</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">classification</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-b4cf0a3b63a2d9e314a9" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b4cf0a3b63a2d9e314a9">{"x":{"data":[{"orientation":"v","width":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036],"base":[0,0,0,0],"x":[1,2,3,4],"y":[16,1,35,16],"text":["count: 16<br />classification: no pattern detected","count:  1<br />classification: oscilating coldspot","count: 35<br />classification: sporadic coldspot","count: 16<br />classification: sporadic hotspot"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(89,89,89,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283108,"r":7.3059360730593621,"b":40.182648401826498,"l":37.260273972602747},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,4.5999999999999996],"tickmode":"array","ticktext":["no pattern detected","oscilating coldspot","sporadic coldspot","sporadic hotspot"],"tickvals":[1,2,3,4],"categoryorder":"array","categoryarray":["no pattern detected","oscilating coldspot","sporadic coldspot","sporadic hotspot"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"classification","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.75,36.75],"tickmode":"array","ticktext":["0","10","20","30"],"tickvals":[0,10,20,30],"categoryorder":"array","categoryarray":["0","10","20","30"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"count","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"13d0e5a8f0a50":{"x":{},"type":"bar"}},"cur_data":"13d0e5a8f0a50","visdat":{"13d0e5a8f0a50":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">avg_rev_all_ehsa</span> <span class="op">&lt;-</span> <span class="va">admin_boundary</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">ehsa_avg_rev_all</span>,</span>
<span>            by <span class="op">=</span> <span class="fu">join_by</span><span class="op">(</span><span class="va">province_eng</span> <span class="op">==</span> <span class="va">location</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sig_avg_rev_all_ehsa</span> <span class="op">&lt;-</span> <span class="va">avg_rev_all_ehsa</span>  <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">p_value</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="fu">tmap_mode</span><span class="op">(</span><span class="st">"plot"</span><span class="op">)</span></span>
<span><span class="fu">tm_shape</span><span class="op">(</span><span class="va">avg_rev_all_ehsa</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_polygons</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_borders</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu">tm_shape</span><span class="op">(</span><span class="va">sig_avg_rev_all_ehsa</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_fill</span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">tm_borders</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tm_layout</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"EHSA Classification of Avg Revenue/Tourist"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Take-home_Ex02_files/figure-html/ehsa_avg_rev_all_viz-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Observations</strong>:</p>
<p>Both the bar chart and the choropleth map show the classification of statistically significant hotspots or coldspots for average revenue per tourist (alpha &lt; 0.05).</p>
<p>From the bar chart, we can observe that most regions are classified as “sporadic coldspot,” indicating inconsistent periods of lower revenue, while a significant number of regions are marked as “sporadic hotspot,” showing intermittent periods of higher average revenue. Only a small number of regions show “oscilating coldspot”</p>
<p>The choropleth map provides a geographic representation of these classifications. Red regions indicate “sporadic hotspots,” while purple regions represent “sporadic coldspots.” Green areas show “no pattern detected,” and the few yellow areas represent “oscillating coldspot.” The remaining gray regions indicate areas with no statistically significant patterns. These regions with different are intermixed throughout Thailand.</p>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="conclusion" class="level2" data-number="13"><h2 data-number="13" class="anchored" data-anchor-id="conclusion">
<span class="header-section-number">13</span> Conclusion</h2>
<p>This report explored how COVID-19 impacted Thailand’s tourism economy through spatial and spatio-temporal analysis to identify whether key tourism indicators were spatially independent and, if dependent, to locate clusters, outliers, and emerging hotspot/coldspot areas. Our findings revealed the following:</p>
<ol type="1">
<li>
<strong>Spatial Independence:</strong>
<ul>
<li>For most indicators like <strong>total tourists, foreign and Thai revenues</strong>, the results indicated no significant spatial dependence across the country. This suggests that these economic factors were relatively independent in space.</li>
<li>However, engineered features such as <strong>average revenue per tourist</strong> has showed persistent spatial clustering, with higher average spending per tourist clustering in the southern regions, particularly in provinces like Phuket.</li>
</ul>
</li>
<li>
<strong>Local Spatial Clusters:</strong>
<ul>
<li>The LISA analysis revealed consistent <strong>low-low clusters</strong> in the northeastern provinces for indicators like tourist numbers and revenues, suggesting these regions consistently performed below the national average.</li>
<li>On the other hand, Phuket and nearby southern regions were frequently identified as <strong>high-high clusters</strong> for average revenue per tourist, further reinforcing the economic significance of tourism in these areas.</li>
</ul>
</li>
<li>
<strong>Spatio-Temporal Patterns Across Time Periods:</strong>
<ul>
<li>The spatial dependence in <strong>average revenue per tourist</strong> persisted across pre-COVID, COVID, and post-COVID periods, although the strength of clustering weakened in the post-pandemic phase, indicating some disruption caused by the pandemic.</li>
</ul>
</li>
<li>
<strong>Emerging Hotspots:</strong>
<ul>
<li>The EHSA identified several regions with evolving patterns over time. Notably, central and southern regions displayed sporadic hotspot patterns for both **Thai revenue and average revenue per tourist indictators.</li>
</ul>
</li>
</ol>
<p>In summary, while the pandemic significantly disrupted Thailand’s tourism economy, spatial analysis revealed persistent geographic trends, particularly in average tourist spending. We hope these insights can guide policymakers and tourism stakeholders in better decision making and strategy making to revitalize the tourism industry in Thailand with consideration to the different characteristics of each region.</p>
</section><section id="references" class="level2" data-number="14"><h2 data-number="14" class="anchored" data-anchor-id="references">
<span class="header-section-number">14</span> References</h2>
<ul>
<li><a href="https://www.kaggle.com/code/sarinkitchatr/thailand-tourism-eda">Thailand Tourism EDA</a></li>
<li><a href="https://en.wikipedia.org/wiki/Timeline_of_the_COVID-19_pandemic_in_Thailand">Timeline of the COVID-19 pandemic in Thailand - Wikipedia</a></li>
<li><a href="https://travelbans.org/en/asia/thailand/full-restrictions">Thailand - Full Restrictions, Travel regulations, Coronavirus regulations, travel bans - Travelbans</a></li>
<li><a href="https://www.tatnews.org/2022/09/thailand-ends-covid-19-emergency-decree-on-30-september-2022/">Thailand ends COVID-19 Emergency Decree on 30 September 2022 - TAT Newsroom</a></li>
<li><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5618106/">Hot spots, cluster detection and spatial outlier analysis of teen birth rates in the U.S., 2003–2012 - PMC</a></li>
<li><a href="https://www.programmingr.com/knn-hyperparameters-a-friendly-guide-to-optimization/">KNN Hyperparameters: A Friendly Guide to Optimization - ProgrammingR</a></li>
</ul>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/isss626-gaa\.netlify\.app\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>